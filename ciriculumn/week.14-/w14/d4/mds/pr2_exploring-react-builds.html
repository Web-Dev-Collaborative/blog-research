<hr />
<!-- @import "[TOC]" {cmd="toc" depthFrom=2 depthTo=6 orderedList=false} -->
<hr />
<h1 id="exploring-react-builds-project">Exploring React Builds Project</h1>
<p>In this project, you’ll use Create React App to create a simple React application. You’ll experiment with some of the features that Create React App provides and deploy a production build of your application to a standalone Express application.</p>
<h2 id="phase-0-setup">Phase 0: Setup</h2>
<p>Begin by using the <a href="https://github.com/facebook/create-react-app">create-react-app</a> package to create a React application:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npx</span> create-react-app exploring-react-builds --template @appacademy/simple</a></code></pre></div>
<blockquote>
<p>Remember that using the <code>create-react-app</code> command initializes your project as a Git repository. If you use the <code>ls -a</code> to view the hidden files in your project, you’ll see the <code>.git</code> file.</p>
</blockquote>
<p>Update the <code>App</code> component:</p>
<ul>
<li>Wrap the <code>&lt;h1&gt;</code> element with a <code>&lt;div&gt;</code> element; and</li>
<li>Change the <code>&lt;h1&gt;</code> element content to something like “Exploring React Builds”.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// ./src/App.js</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb2-8" title="8">      <span class="op">&lt;</span>h1<span class="op">&gt;</span>Exploring React Builds&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb2-9" title="9">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb2-10" title="10">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-12" title="12"></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div>
<h2 id="phase-1-using-css-modules">Phase 1: Using CSS modules</h2>
<p>You’ve already seen an example of using the <code>import</code> keyword to import a stylesheet into a module so that it’ll be included in your application build. That’s the technique being used to include the global <code>index.css</code> stylesheet:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="co">// ./src/index.js</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="im">import</span> <span class="st">&#39;./index.css&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="im">import</span> App <span class="im">from</span> <span class="st">&#39;./App&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb3-9" title="9">  <span class="op">&lt;</span><span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-10" title="10">    <span class="op">&lt;</span>App /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-11" title="11">  &lt;/<span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb3-12" title="12">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb3-13" title="13">)<span class="op">;</span></a></code></pre></div>
<p>You can also leverage <a href="https://github.com/css-modules/css-modules">CSS modules</a> in your Create React App projects. CSS Modules scope stylesheet class names so that they are unique to a specific React component. This allows you to create class names without having to worry if they might collide with class names used in another component.</p>
<p>Add a new <code>css-modules</code> folder to the <code>src</code> folder. Within that folder, add the following files:</p>
<ul>
<li><code>HeadingA.js</code></li>
<li><code>HeadingA.module.css</code></li>
<li><code>HeadingB.js</code></li>
<li><code>HeadingB.module.css</code></li>
</ul>
<p>Then update the contents of each file to the following:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="co">// ./src/css-modules/HeadingA.js</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="im">import</span> styles <span class="im">from</span> <span class="st">&#39;./HeadingA.module.css&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">function</span> <span class="at">HeadingA</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb4-8" title="8">    <span class="op">&lt;</span>h1 className<span class="op">={</span><span class="va">styles</span>.<span class="at">heading</span><span class="op">}&gt;</span>Heading A&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="op">}</span></a>
<a class="sourceLine" id="cb4-11" title="11"></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="im">export</span> <span class="im">default</span> HeadingA<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb5-1" title="1"><span class="co">/* ./src/css-modules/HeadingA.module.css */</span></a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="fu">.heading</span> {</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="kw">color</span>: <span class="cn">green</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5">}</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="co">// ./src/css-modules/HeadingB.js</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="im">import</span> styles <span class="im">from</span> <span class="st">&#39;./HeadingB.module.css&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw">function</span> <span class="at">HeadingB</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb6-8" title="8">    <span class="op">&lt;</span>h1 className<span class="op">={</span><span class="va">styles</span>.<span class="at">heading</span><span class="op">}&gt;</span>Heading B&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb6-9" title="9">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="op">}</span></a>
<a class="sourceLine" id="cb6-11" title="11"></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="im">export</span> <span class="im">default</span> HeadingB<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb7-1" title="1"><span class="co">/* ./src/css-modules/HeadingB.module.css */</span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="fu">.heading</span> {</a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="kw">color</span>: <span class="cn">red</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5">}</a></code></pre></div>
<p>Notice how the <code>.heading</code> CSS class name is being used within each component to set the color of the <code>&lt;h1&gt;</code> element. For the <code>HeadingA</code> component, the color is <code>green</code>, and for the <code>HeadingB</code> component, the color is <code>red</code>. Using the file naming convention <code>[name].module.css</code> let’s Create React App know that we want these stylesheets to be processed as CSS Modules. Using CSS Modules allows the <code>.heading</code> class name to be reused across components without any issue.</p>
<p>To see this feature in action, update your <code>App</code> component to render both of your new components:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="im">import</span> HeadingA <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingA&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="im">import</span> HeadingB <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingB&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-6" title="6">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-8" title="8">      <span class="op">&lt;</span>h1<span class="op">&gt;</span>Exploring React Builds&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-9" title="9">      <span class="op">&lt;</span>HeadingA /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-10" title="10">      <span class="op">&lt;</span>HeadingB /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-11" title="11">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-12" title="12">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="op">}</span></a>
<a class="sourceLine" id="cb8-14" title="14"></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div>
<p>Then run your application (<code>npm start</code>) to see “Heading A” and “Heading B” displayed respectively in green and red. If you use the browser’s developer tools to inspect “Heading A”, you’ll see that the <code>.heading</code> class name has been modified so that it’s unique to the <code>HeadingA</code> component:</p>
<figure>
<img src="images/react-builds-css-modules.png" alt="react builds css modules" /><figcaption>react builds css modules</figcaption>
</figure>
<p>CSS Modules is an example of how a front-end build process can be used to modify code to enable a feature that’s not natively supported by browsers.</p>
<h2 id="phase-2-using-an-image-in-a-component">Phase 2: Using an image in a component</h2>
<p>Create React App configures webpack with support for loading images (as well as CSS, fonts, and other file types). What this means, for you as the developer, is that you can add an image file to your project, import it directly into a module, and render it in a React component.</p>
<p>Download any image of off the Web or <a href="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/react-builds/assets/react-builds-cat.png">click here</a> to download the below image.</p>
<figure>
<img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/react-builds/assets/react-builds-cat.png" alt="react builds cat" /><figcaption>react builds cat</figcaption>
</figure>
<p>Then within the <code>src</code> folder add a new folder named <code>image</code>. Within that folder add a new component file named <code>Image.js</code>. Also add your downloaded image file to the <code>image</code> folder (so it’s a sibling to the <code>Image.js</code> file).</p>
<p>Update the contents of the <code>Image.js</code> file to this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="co">// ./src/image/Image.js</span></a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="im">import</span> cat <span class="im">from</span> <span class="st">&#39;./react-builds-cat.png&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb9-5" title="5"></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="va">console</span>.<span class="at">log</span>(cat)<span class="op">;</span> <span class="co">// /static/media/react-builds-cat.45f7f4d2.png</span></a>
<a class="sourceLine" id="cb9-7" title="7"></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="kw">function</span> <span class="at">Image</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb9-9" title="9">  <span class="co">// Import result is the URL of your image.</span></a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="cf">return</span> <span class="op">&lt;</span>img src<span class="op">={</span>cat<span class="op">}</span> alt<span class="op">=</span><span class="st">&quot;images/images/Cat&quot;</span> /&gt;<span class="op">;</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="op">}</span></a>
<a class="sourceLine" id="cb9-12" title="12"></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="im">export</span> <span class="im">default</span> Image<span class="op">;</span></a></code></pre></div>
<p>You can import an image into a component using the <code>import</code> keyword. This tells webpack to include the image in the build. Notice that when you import an image into a module, you’ll get a path to the image’s location within the build. You can use this path to set the <code>src</code> attribute on an <code>&lt;img&gt;</code> element.</p>
<blockquote>
<p>Be sure to update the image <code>import</code> statement to the correct file name if you’re using your own image!</p>
</blockquote>
<p>Now update the <code>App</code> component to import and render the <code>Image</code> component:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="co">// ./src/App.js</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="im">import</span> HeadingA <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingA&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="im">import</span> HeadingB <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingB&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="im">import</span> Image <span class="im">from</span> <span class="st">&#39;./image/Image&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb10-9" title="9">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb10-10" title="10">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-11" title="11">      <span class="op">&lt;</span>h1<span class="op">&gt;</span>Exploring React Builds&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-12" title="12">      <span class="op">&lt;</span>HeadingA /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-13" title="13">      <span class="op">&lt;</span>HeadingB /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-14" title="14">      <span class="op">&lt;</span>Image /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-15" title="15">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-16" title="16">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="op">}</span></a>
<a class="sourceLine" id="cb10-18" title="18"></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div>
<p>If you run your application (<code>npm start</code>) you’ll see your image displayed on the page! You can also open your browser’s developer tools and view the “Sources” for the current page. If you can expand the <code>localhost:3000</code> &gt; <code>static</code> &gt; <code>media</code> node on the left, you can see the image file that webpack copied to your build.</p>
<figure>
<img src="images/react-builds-dev-tools-image.png" alt="react builds dev tools image" /><figcaption>react builds dev tools image</figcaption>
</figure>
<h3 id="images-in-stylesheets">Images in stylesheets</h3>
<p>You can also reference images in your CSS files too. Add a CSS file named <code>Image.css</code> to the <code>./src/image</code> folder and update its contents to this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb11-1" title="1"><span class="co">/* ./src/image/Image.css */</span></a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="fu">.cat</span> {</a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="kw">background-image</span>: <span class="fu">url(</span><span class="st">./react-builds-cat.png</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="kw">width</span>: <span class="dv">400</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb11-6" title="6">  <span class="kw">height</span>: <span class="dv">400</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb11-7" title="7">}</a></code></pre></div>
<p>Then update the <code>Image</code> component to this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="co">// ./src/image/Image.js</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="im">import</span> <span class="st">&#39;./Image.css&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="im">import</span> cat <span class="im">from</span> <span class="st">&#39;./react-builds-cat.png&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="va">console</span>.<span class="at">log</span>(cat)<span class="op">;</span> <span class="co">// /static/media/react-builds-cat.45f7f4d2.png</span></a>
<a class="sourceLine" id="cb12-8" title="8"></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="kw">function</span> <span class="at">Image</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb12-10" title="10">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb12-11" title="11">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb12-12" title="12">      <span class="op">{</span><span class="co">/* Import result is the URL of your image. */</span><span class="op">}</span></a>
<a class="sourceLine" id="cb12-13" title="13">      <span class="op">&lt;</span>img src<span class="op">={</span>cat<span class="op">}</span> alt<span class="op">=</span><span class="st">&quot;Cat&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb12-14" title="14">      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&#39;cat&#39;</span><span class="op">&gt;</span>&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb12-15" title="15">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb12-16" title="16">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="op">}</span></a>
<a class="sourceLine" id="cb12-18" title="18"></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="im">export</span> <span class="im">default</span> Image<span class="op">;</span></a></code></pre></div>
<p>Now you’ll see the image displayed twice on the page!</p>
<h2 id="phase-3-updating-the-supported-browsers-and-its-affect-on-code-transpilation">Phase 3: Updating the supported browsers (and its affect on code transpilation)</h2>
<p>Earlier you learned about the <code>browerslist</code> setting in the <code>package.json</code> file and now adjusting these targets affect how your code will be transpiled:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb13-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">&quot;browserslist&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb13-3" title="3">    <span class="dt">&quot;production&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb13-4" title="4">      <span class="st">&quot;&gt;0.2%&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb13-5" title="5">      <span class="st">&quot;not dead&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb13-6" title="6">      <span class="st">&quot;not op_mini all&quot;</span></a>
<a class="sourceLine" id="cb13-7" title="7">    <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb13-8" title="8">    <span class="dt">&quot;development&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb13-9" title="9">      <span class="st">&quot;last 1 chrome version&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb13-10" title="10">      <span class="st">&quot;last 1 firefox version&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb13-11" title="11">      <span class="st">&quot;last 1 safari version&quot;</span></a>
<a class="sourceLine" id="cb13-12" title="12">    <span class="ot">]</span></a>
<a class="sourceLine" id="cb13-13" title="13">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="fu">}</span></a></code></pre></div>
<p>The <code>production</code> list specifies the browsers to target when creating a production build and the <code>development</code> list specifics the browsers to target when running the application using <code>npm start</code>. Currently, you’re targeting relatively recent versions of the major browsers when creating a development build. Targeting older browser versions results in your code being transpiled to an older version of JavaScript.</p>
<p>To experiment with this configuration option, let’s add a class component to the project. Add a new folder named <code>class-component</code> to the <code>src</code> folder. Within that folder, add a file named <code>ClassComponent.js</code> containing the following code:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="co">// ./src/class-component/ClassComponent.js</span></a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-4" title="4"></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw">class</span> ClassComponent <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb14-7" title="7">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb14-8" title="8">      <span class="op">&lt;</span>h1<span class="op">&gt;</span>Class Component&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb14-9" title="9">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb14-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="op">}</span></a>
<a class="sourceLine" id="cb14-12" title="12"></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="im">export</span> <span class="im">default</span> ClassComponent<span class="op">;</span></a></code></pre></div>
<p>Don’t forget to update your <code>App</code> component to render the new component:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="co">// ./src/App.js</span></a>
<a class="sourceLine" id="cb15-2" title="2"></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="im">import</span> HeadingA <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingA&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="im">import</span> HeadingB <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingB&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="im">import</span> Image <span class="im">from</span> <span class="st">&#39;./image/Image&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="im">import</span> ClassComponent <span class="im">from</span> <span class="st">&#39;./class-component/ClassComponent&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-8" title="8"></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb15-11" title="11">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-12" title="12">      <span class="op">&lt;</span>h1<span class="op">&gt;</span>Exploring React Builds&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-13" title="13">      <span class="op">&lt;</span>HeadingA /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-14" title="14">      <span class="op">&lt;</span>HeadingB /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-15" title="15">      <span class="op">&lt;</span>Image /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-16" title="16">      <span class="op">&lt;</span>ClassComponent /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-17" title="17">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-18" title="18">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="op">}</span></a>
<a class="sourceLine" id="cb15-20" title="20"></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div>
<p>Now run your application using <code>npm start</code>. Open your browser’s developer tools and view the “Sources” for the current page. Expand the <code>localhost:3000</code> &gt; <code>static</code> &gt; <code>js</code> node on the left and select the <code>main.chunk.js</code> file. Press <code>CMD+F</code> on macOS or <code>CTRL+F</code> on Windows to search the file for “Class Component”. Here’s what the transpiled code looks like for the <code>ClassComponent</code> class:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">class</span> ClassComponent <span class="kw">extends</span> <span class="va">react__WEBPACK_IMPORTED_MODULE_0___default</span>.<span class="va">a</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb16-3" title="3">    <span class="cf">return</span> <span class="co">/*#__PURE__*/</span><span class="va">react__WEBPACK_IMPORTED_MODULE_0___default</span>.<span class="va">a</span>.<span class="at">createElement</span>(<span class="st">&quot;h1&quot;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-4" title="4">      <span class="dt">__self</span><span class="op">:</span> <span class="kw">this</span><span class="op">,</span></a>
<a class="sourceLine" id="cb16-5" title="5">      <span class="dt">__source</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-6" title="6">        <span class="dt">fileName</span><span class="op">:</span> _jsxFileName<span class="op">,</span></a>
<a class="sourceLine" id="cb16-7" title="7">        <span class="dt">lineNumber</span><span class="op">:</span> <span class="dv">7</span><span class="op">,</span></a>
<a class="sourceLine" id="cb16-8" title="8">        <span class="dt">columnNumber</span><span class="op">:</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb16-9" title="9">      <span class="op">}</span></a>
<a class="sourceLine" id="cb16-10" title="10">    <span class="op">},</span> <span class="st">&quot;Class Component&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-11" title="11">  <span class="op">}</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="op">}</span></a></code></pre></div>
<blockquote>
<p>Have you wondered yet why you need to use the developer tools to view the bundles generated by Create React App? Remember that when you run <code>npm start</code>, Create React App builds your application using <a href="https://webpack.js.org/configuration/dev-server/"><code>webpack-dev-server</code></a>. To keep things as performant as possible, the bundles generated by <a href="https://webpack.js.org/configuration/dev-server/"><code>webpack-dev-server</code></a> are stored in memory instead of writing them to the file system.</p>
</blockquote>
<p>The JSX in the component’s <code>render</code> method has been converted to JavaScript but the <code>ClassComponent</code> ES2015 class is left alone. This makes sense though as JSX isn’t natively supported by any browser while ES2015 classes have been natively supported by browsers for awhile now.</p>
<p>But what if you need to target a version of a browser that doesn’t support ES2015 classes? You can use the <a href="https://caniuse.com/#feat=es6-class">“Can I use…”</a> website to see when browsers started supporting ES2105 (or ES6) classes. Starting with version 49, Chrome natively supported classes. But imagine that you need to support Chrome going back to version 30, a version of Chrome that doesn’t support classes.</p>
<p>Change the <code>browserslist.development</code> property in the <code>package.json</code> file to this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb17-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="dt">&quot;browserslist&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb17-3" title="3">    <span class="dt">&quot;production&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb17-4" title="4">      <span class="st">&quot;&gt;0.2%&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb17-5" title="5">      <span class="st">&quot;not dead&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb17-6" title="6">      <span class="st">&quot;not op_mini all&quot;</span></a>
<a class="sourceLine" id="cb17-7" title="7">    <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb17-8" title="8">    <span class="dt">&quot;development&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb17-9" title="9">      <span class="st">&quot;chrome &gt;= 30&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb17-10" title="10">      <span class="st">&quot;last 1 firefox version&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb17-11" title="11">      <span class="st">&quot;last 1 safari version&quot;</span></a>
<a class="sourceLine" id="cb17-12" title="12">    <span class="ot">]</span></a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="fu">}</span></a></code></pre></div>
<p>The query <code>chrome &gt;= 30</code> specifies that you want to target Chrome version 30 or newer.</p>
<blockquote>
<p>The <a href="https://browserl.ist">browserl.ist</a> website can be used to see the browsers supported by your configured <code>browserslist</code>.</p>
</blockquote>
<p>Stop your application if it’s currently running. Delete the <code>./node_modules/.cache</code> folder and run <code>npm start</code> again. Then view the <code>main.chunk.js</code> bundle again in the developer tools:</p>
<figure>
<img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/react-builds/assets/react-builds-transpilation.png" alt="react builds transpilation" /><figcaption>react builds transpilation</figcaption>
</figure>
<p>Now your ES2015 class component is being converted to a constructor function! Here’s the transpiled code for reference:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">var</span> ClassComponent <span class="op">=</span> <span class="co">/*#__PURE__*/</span><span class="kw">function</span> (_React$Component) <span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="at">Object</span>(_Users_jameschurchill_Documents_GitHub_Modular_Curriculum_content_react_redux_topics_react_builds_projects_exploring_react_builds_solution_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_2__[<span class="st">&quot;default&quot;</span>])(ClassComponent<span class="op">,</span> _React$Component)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4">  <span class="kw">var</span> _super <span class="op">=</span> <span class="at">Object</span>(_Users_jameschurchill_Documents_GitHub_Modular_Curriculum_content_react_redux_topics_react_builds_projects_exploring_react_builds_solution_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_3__[<span class="st">&quot;default&quot;</span>])(ClassComponent)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-5" title="5"></a>
<a class="sourceLine" id="cb18-6" title="6">  <span class="kw">function</span> <span class="at">ClassComponent</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb18-7" title="7">    <span class="at">Object</span>(_Users_jameschurchill_Documents_GitHub_Modular_Curriculum_content_react_redux_topics_react_builds_projects_exploring_react_builds_solution_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__[<span class="st">&quot;default&quot;</span>])(<span class="kw">this</span><span class="op">,</span> ClassComponent)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-8" title="8"></a>
<a class="sourceLine" id="cb18-9" title="9">    <span class="cf">return</span> <span class="va">_super</span>.<span class="at">apply</span>(<span class="kw">this</span><span class="op">,</span> <span class="kw">arguments</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb18-11" title="11"></a>
<a class="sourceLine" id="cb18-12" title="12">  <span class="at">Object</span>(_Users_jameschurchill_Documents_GitHub_Modular_Curriculum_content_react_redux_topics_react_builds_projects_exploring_react_builds_solution_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__[<span class="st">&quot;default&quot;</span>])(ClassComponent<span class="op">,</span> [<span class="op">{</span></a>
<a class="sourceLine" id="cb18-13" title="13">    <span class="dt">key</span><span class="op">:</span> <span class="st">&quot;render&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb18-14" title="14">    <span class="dt">value</span><span class="op">:</span> <span class="kw">function</span> <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb18-15" title="15">      <span class="cf">return</span> <span class="co">/*#__PURE__*/</span><span class="va">react__WEBPACK_IMPORTED_MODULE_4___default</span>.<span class="va">a</span>.<span class="at">createElement</span>(<span class="st">&quot;h1&quot;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-16" title="16">        <span class="dt">__self</span><span class="op">:</span> <span class="kw">this</span><span class="op">,</span></a>
<a class="sourceLine" id="cb18-17" title="17">        <span class="dt">__source</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-18" title="18">          <span class="dt">fileName</span><span class="op">:</span> _jsxFileName<span class="op">,</span></a>
<a class="sourceLine" id="cb18-19" title="19">          <span class="dt">lineNumber</span><span class="op">:</span> <span class="dv">7</span><span class="op">,</span></a>
<a class="sourceLine" id="cb18-20" title="20">          <span class="dt">columnNumber</span><span class="op">:</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb18-21" title="21">        <span class="op">}</span></a>
<a class="sourceLine" id="cb18-22" title="22">      <span class="op">},</span> <span class="st">&quot;Class Component&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-23" title="23">    <span class="op">}</span></a>
<a class="sourceLine" id="cb18-24" title="24">  <span class="op">}</span>])<span class="op">;</span></a>
<a class="sourceLine" id="cb18-25" title="25"></a>
<a class="sourceLine" id="cb18-26" title="26">  <span class="cf">return</span> ClassComponent<span class="op">;</span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="op">}</span>(<span class="va">react__WEBPACK_IMPORTED_MODULE_4___default</span>.<span class="va">a</span>.<span class="at">Component</span>)<span class="op">;</span></a></code></pre></div>
<p>Luckily it’s very rare that you’ll need to read the code in your generated bundles. webpack, by default, is configured to generate sourcemaps. Sourcemaps are a mapping of the code in a generated file, like a bundle file, to the original source code. This gives you access to your original source code in the browser’s developer tools:</p>
<figure>
<img src="images/react-builds-sourcemaps.png" alt="react builds sourcemaps" /><figcaption>react builds sourcemaps</figcaption>
</figure>
<p>You can even set a breakpoint in your source within the developer tools to stop execution on a specific line of code!</p>
<h2 id="phase-4-adding-environment-variables">Phase 4: Adding environment variables</h2>
<p>Earlier you learned that Create React App supports defining environment variables in an <code>.env</code> file. This gives you a convenient way to avoid hard coding values that vary across environments.</p>
<p>Let’s experiment with this feature so that you can see how the Create React App build process embeds environment variables into your HTML, CSS, and JavaScript bundles.</p>
<p>Add an <code>.env</code> file to the root of your Create React App project. Define an environment variable named <code>REACT_APP_TITLE</code>:</p>
<pre><code>REACT_APP_TITLE=Exploring React Builds</code></pre>
<p>Remember that environment variables need to be prefixed with <code>REACT_APP_</code> for Create React App to process them. After defining your environment variable, you can refer to it within JSX using an expression and <code>process.env</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="co">// ./src/App.js</span></a>
<a class="sourceLine" id="cb20-2" title="2"></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="im">import</span> HeadingA <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingA&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="im">import</span> HeadingB <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingB&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="im">import</span> Image <span class="im">from</span> <span class="st">&#39;./image/Image&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="im">import</span> ClassComponent <span class="im">from</span> <span class="st">&#39;./class-component/ClassComponent&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-8" title="8"></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb20-10" title="10">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb20-11" title="11">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-12" title="12">      <span class="op">&lt;</span>h1<span class="op">&gt;{</span><span class="va">process</span>.<span class="va">env</span>.<span class="at">REACT_APP_TITLE</span><span class="op">}</span>&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-13" title="13">      <span class="op">&lt;</span>HeadingA /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-14" title="14">      <span class="op">&lt;</span>HeadingB /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-15" title="15">      <span class="op">&lt;</span>Image /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-16" title="16">      <span class="op">&lt;</span>ClassComponent /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-17" title="17">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-18" title="18">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb20-19" title="19"><span class="op">}</span></a>
<a class="sourceLine" id="cb20-20" title="20"></a>
<a class="sourceLine" id="cb20-21" title="21"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div>
<p>Environment variables can also be referred to in regular JavaScript code:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="va">console</span>.<span class="at">log</span>(<span class="va">process</span>.<span class="va">env</span>.<span class="at">REACT_APP_TITLE</span>)<span class="op">;</span></a></code></pre></div>
<p>You can also reference environment variables in your <code>./public/index.html</code> file like this:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb22-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">&lt;html</span><span class="ot"> lang=</span><span class="st">&quot;en&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb22-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb22-4" title="4">    <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">&quot;utf-8&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb22-5" title="5">    <span class="kw">&lt;title&gt;</span>%REACT_APP_TITLE%<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb22-6" title="6">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb22-7" title="7">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb22-8" title="8">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;root&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb22-9" title="9">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>Run your application again using <code>npm start</code>. Open your browser’s developer tools and view the “Sources” for the current page. Expand the <code>localhost:3000</code> node on the left and select <code>(index)</code>. Notice that the text <code>%REACT_APP_TITLE%</code> within the <code>&lt;title&gt;</code> element has been converted to the text literal <code>Exploring React Builds</code>:</p>
<figure>
<img src="images/react-builds-index-html.png" alt="react builds index html" /><figcaption>react builds index html</figcaption>
</figure>
<p>If you expand the <code>localhost:3000</code> &gt; <code>static</code> &gt; <code>js</code> node on the left and select the <code>main.chunk.js</code> file, you can see how the <code>App</code> component’s JSX has been converted to JavaScript:</p>
<figure>
<img src="images/react-builds-component-env-var.png" alt="react builds component env var" /><figcaption>react builds component env var</figcaption>
</figure>
<p>Here’s a closer look at the relevant <code>React.createElement</code> method call:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="co">/*#__PURE__*/</span><span class="va">react__WEBPACK_IMPORTED_MODULE_0___default</span>.<span class="va">a</span>.<span class="at">createElement</span>(<span class="st">&quot;h1&quot;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-2" title="2">    <span class="dt">__self</span><span class="op">:</span> <span class="kw">this</span><span class="op">,</span></a>
<a class="sourceLine" id="cb23-3" title="3">    <span class="dt">__source</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-4" title="4">      <span class="dt">fileName</span><span class="op">:</span> _jsxFileName<span class="op">,</span></a>
<a class="sourceLine" id="cb23-5" title="5">      <span class="dt">lineNumber</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></a>
<a class="sourceLine" id="cb23-6" title="6">      <span class="dt">columnNumber</span><span class="op">:</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb23-7" title="7">    <span class="op">}</span></a>
<a class="sourceLine" id="cb23-8" title="8">  <span class="op">},</span> <span class="st">&quot;Exploring React Builds&quot;</span>)</a></code></pre></div>
<p>Again, notice how the environment variable has been replaced with a text literal. This has important security implications for you to consider. Because environment variables are embedded into your HTML, CSS, and JavaScript bundles during the build process, it’s <em>very important</em> to not store any secrets, like API keys, in your environment variables. Remember, anyone can view your bundled code in the browser by inspecting your files!</p>
<h2 id="phase-5-deploying-a-production-build">Phase 5: Deploying a production build</h2>
<p>In the last phase of this project, let’s add routing to the React application, create a production build, and deploy the build to an Express application!</p>
<h3 id="adding-routing">Adding routing</h3>
<p>To add React Router to the application, start by installing the <code>react-router-dom</code> npm package:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1"><span class="ex">npm</span> install react-router-dom@^5.0.0</a></code></pre></div>
<p>Then update the <code>App</code> component to this code:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="co">// ./src/App.js</span></a>
<a class="sourceLine" id="cb25-2" title="2"></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="im">import</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-5" title="5">  BrowserRouter<span class="op">,</span></a>
<a class="sourceLine" id="cb25-6" title="6">  Switch<span class="op">,</span></a>
<a class="sourceLine" id="cb25-7" title="7">  Route<span class="op">,</span></a>
<a class="sourceLine" id="cb25-8" title="8">  Link</a>
<a class="sourceLine" id="cb25-9" title="9"><span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="im">import</span> HeadingA <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingA&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="im">import</span> HeadingB <span class="im">from</span> <span class="st">&#39;./css-modules/HeadingB&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="im">import</span> Image <span class="im">from</span> <span class="st">&#39;./image/Image&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="im">import</span> ClassComponent <span class="im">from</span> <span class="st">&#39;./class-component/ClassComponent&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb25-14" title="14"></a>
<a class="sourceLine" id="cb25-15" title="15"><span class="kw">function</span> <span class="at">App</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb25-16" title="16">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb25-17" title="17">    <span class="op">&lt;</span>BrowserRouter<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-18" title="18">      <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-19" title="19">        <span class="op">&lt;</span>h1<span class="op">&gt;{</span><span class="va">process</span>.<span class="va">env</span>.<span class="at">REACT_APP_TITLE</span><span class="op">}</span>&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-20" title="20">        <span class="op">&lt;</span>nav<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-21" title="21">          <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-22" title="22">            <span class="op">&lt;</span>li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-23" title="23">              <span class="op">&lt;</span>Link to<span class="op">=</span><span class="st">&quot;/&quot;</span><span class="op">&gt;</span>Home&lt;/Link<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-24" title="24">            &lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-25" title="25">            <span class="op">&lt;</span>li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-26" title="26">              <span class="op">&lt;</span>Link to<span class="op">=</span><span class="st">&quot;/image&quot;</span><span class="op">&gt;</span>Image&lt;/Link<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-27" title="27">            &lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-28" title="28">            <span class="op">&lt;</span>li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-29" title="29">              <span class="op">&lt;</span>Link to<span class="op">=</span><span class="st">&quot;/class-component&quot;</span><span class="op">&gt;</span>Class Component&lt;/Link<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-30" title="30">            &lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-31" title="31">          &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-32" title="32">        &lt;/nav<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-33" title="33">        <span class="op">&lt;</span>Switch<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-34" title="34">          <span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/image&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-35" title="35">            <span class="op">&lt;</span>Image /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-36" title="36">          &lt;/Route<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-37" title="37">          <span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/class-component&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-38" title="38">            <span class="op">&lt;</span>ClassComponent /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-39" title="39">          &lt;/Route<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-40" title="40">          <span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-41" title="41">            <span class="op">&lt;</span>HeadingA /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-42" title="42">            <span class="op">&lt;</span>HeadingB /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-43" title="43">          &lt;/Route<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-44" title="44">        &lt;/Switch<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-45" title="45">      &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-46" title="46">    &lt;/BrowserRouter<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb25-47" title="47">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb25-48" title="48"><span class="op">}</span></a>
<a class="sourceLine" id="cb25-49" title="49"></a>
<a class="sourceLine" id="cb25-50" title="50"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div>
<p>Be sure to run and test your application to ensure that the defined routes work as expected:</p>
<ul>
<li><code>/</code> - Should display the <code>HeadingA</code> and <code>HeadingB</code> components;</li>
<li><code>/image</code> - Should display the <code>Image</code> component; and</li>
<li><code>/class-component</code> - Should display the <code>ClassComponent</code> component.</li>
</ul>
<h3 id="creating-a-production-build">Creating a production build</h3>
<p>To create a production build, run the command <code>npm run build</code> from the root of your project. The output in the terminal should look something like this:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb26-1" title="1"><span class="op">&gt;</span> <span class="ex">solution@0.1.0</span> build [absolute path to your project]</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="op">&gt;</span> <span class="ex">react-scripts</span> build</a>
<a class="sourceLine" id="cb26-3" title="3"></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="ex">Creating</span> an optimized production build...</a>
<a class="sourceLine" id="cb26-5" title="5"><span class="ex">Compiled</span> successfully.</a>
<a class="sourceLine" id="cb26-6" title="6"></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="ex">File</span> sizes after gzip:</a>
<a class="sourceLine" id="cb26-8" title="8"></a>
<a class="sourceLine" id="cb26-9" title="9">  <span class="ex">47.83</span> KB  build/static/js/2.722c16c4.chunk.js</a>
<a class="sourceLine" id="cb26-10" title="10">  <span class="ex">773</span> B     build/static/js/runtime-main.b7d1e5ee.js</a>
<a class="sourceLine" id="cb26-11" title="11">  <span class="ex">745</span> B     build/static/js/main.12299197.chunk.js</a>
<a class="sourceLine" id="cb26-12" title="12">  <span class="ex">197</span> B     build/static/css/main.e9a0d1f8.chunk.css</a>
<a class="sourceLine" id="cb26-13" title="13"></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="ex">The</span> project was built assuming it is hosted at /.</a>
<a class="sourceLine" id="cb26-15" title="15"><span class="ex">You</span> can control this with the homepage field in your package.json.</a>
<a class="sourceLine" id="cb26-16" title="16"></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="ex">The</span> build folder is ready to be deployed.</a>
<a class="sourceLine" id="cb26-18" title="18"><span class="ex">You</span> may serve it with a static server:</a>
<a class="sourceLine" id="cb26-19" title="19"></a>
<a class="sourceLine" id="cb26-20" title="20">  <span class="ex">npm</span> install -g serve</a>
<a class="sourceLine" id="cb26-21" title="21">  <span class="ex">serve</span> -s build</a>
<a class="sourceLine" id="cb26-22" title="22"></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="ex">Find</span> out more about deployment here:</a>
<a class="sourceLine" id="cb26-24" title="24"></a>
<a class="sourceLine" id="cb26-25" title="25">  <span class="ex">bit.ly/CRA-deploy</span></a></code></pre></div>
<p><strong>Ignore the comments about using <code>serve</code> to deploy your application (i.e. <code>npm install -g serve</code> and <code>serve -s build</code>).</strong> In the next step, you’ll create a simple Express application to server your React application.</p>
<h3 id="serving-a-react-application-using-express">Serving a React application using Express</h3>
<p>Create a new folder for your Express application outside of the Create React App project folder.</p>
<blockquote>
<p>For example, from the root of your project, use <code>cd ..</code> to go up a level and then create a new folder named <code>express-server</code> by running the command <code>mkdir express-server</code>. This makes the <code>express-server</code> folder a sibling to your Create React App project folder.</p>
</blockquote>
<p>Browse into the <code>express-server</code> folder and initialize it to use npm (i.e. <code>npm init -y</code>). Then install Express by running the command <code>npm install express@^4.0.0</code>.</p>
<p>App a file named <code>app.js</code> with the following contents:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="co">// ./app.js</span></a>
<a class="sourceLine" id="cb27-2" title="2"></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">const</span> express <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;express&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw">const</span> path <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;path&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-5" title="5"></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="kw">const</span> app <span class="op">=</span> <span class="at">express</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb27-7" title="7"></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="va">app</span>.<span class="at">use</span>(<span class="va">express</span>.<span class="at">static</span>(<span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;public&#39;</span>)))<span class="op">;</span></a>
<a class="sourceLine" id="cb27-9" title="9"></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="va">app</span>.<span class="at">get</span>(<span class="st">&#39;*&#39;</span><span class="op">,</span> <span class="kw">function</span>(req<span class="op">,</span> res) <span class="op">{</span></a>
<a class="sourceLine" id="cb27-11" title="11">  <span class="va">res</span>.<span class="at">sendFile</span>(<span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;public&#39;</span><span class="op">,</span> <span class="st">&#39;index.html&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-13" title="13"></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="kw">const</span> port <span class="op">=</span> <span class="dv">9000</span><span class="op">;</span></a>
<a class="sourceLine" id="cb27-15" title="15"></a>
<a class="sourceLine" id="cb27-16" title="16"><span class="va">app</span>.<span class="at">listen</span>(port<span class="op">,</span> () <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`Listening on port </span><span class="sc">${</span>port<span class="sc">}</span><span class="vs">...`</span>))<span class="op">;</span></a></code></pre></div>
<p>This simple Express application will:</p>
<ul>
<li>Attempt to match incoming requests to static files located in the <code>public</code> folder; and</li>
<li>If a matching static file isn’t found, then the <code>./public/index.html</code> file will be served for all other requests.</li>
</ul>
<p>Now add a folder named <code>public</code> to the root of your Express project. Copy the files from the <code>build</code> folder in your Create React App project to the <code>public</code> folder in the Express application project. Then run your application using the command <code>node app.js</code>.</p>
<p>Open a browser and browse to the URL <code>http://localhost:9000/</code>. You should see your React application served from your Express application! Be sure to click the navigation links to verify that all of your configured routes work as expected.</p>
<p>Also, because you configured Express to serve the <code>./public/index.html</code> file for any request that doesn’t match a static file, you can “deep link” to any of your React application’s routes:</p>
<ul>
<li><a href="http://localhost:9000/image">http://localhost:9000/image</a></li>
<li><a href="http://localhost:9000/class-component">http://localhost:9000/class-component</a></li>
</ul>
