<h1 id="pokedex-hooks-phase-2">Pokedex Hooks: Phase 2</h1>
<p>As you might remember from the Redux-based Pokedex project, implementing Redux results in a lot of boilerplate code. Using Redux hooks can help clean up and get rid of a lot of boilerplate code. In this phase you will refactor the Redux-based project to use React hooks and implement Redux hooks!</p>
<h2 id="using-redux-hooks-to-manage-application-state">Using Redux hooks to manage application state</h2>
<p>In this phase, you’ll be refactoring all your component files to use Redux hooks instead of the <code>mapStateToProps</code>, <code>mapDispatchToProps</code>, and Redux <code>connect</code> functions. Just like in phase 1, you might hit bugs and break your application while refactoring your application’s components. Make sure to test that your refactored code is working before moving on to refactor the next component. As a general overview, you’ll be refactoring the code for the following components:</p>
<ol type="1">
<li><code>LogoutButton</code></li>
<li><code>LoginPanel</code></li>
<li><code>PokemonDetail</code></li>
<li><code>PokemonForm</code></li>
<li><code>PokemonBrowser</code></li>
</ol>
<h3 id="refactoring-to-use-usedispatch-and-useselector">Refactoring to use <code>useDispatch</code> and <code>useSelector</code></h3>
<p>You’ll need to do some refactoring so that your component doesn’t receive any props. Instead of receiving slices of state and dispatchable action functions as props from the <code>connect</code> wrapper, you will use the <code>useSelector</code> hook to access a slice a state from within the component and the <code>useDispatch</code> hook to dispatch actions from within the component.</p>
<p>Take a look at the <code>LogoutButton</code> component as an example.</p>
<p>Based on the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions in the <code>LogoutButton.js</code> file, you can tell that the component is accessing Redux by receiving <code>loggedOut</code> and <code>logout</code> props.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// We&#39;ll convert this into a useSelector hook</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> mapStateToProps <span class="op">=</span> state <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="dt">loggedOut</span><span class="op">:</span> <span class="op">!</span><span class="va">state</span>.<span class="va">authentication</span>.<span class="at">token</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="op">};</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="op">};</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">// We&#39;ll convert this into a useDispatch hook</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="dt">logout</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">logout</span>())<span class="op">,</span></a>
<a class="sourceLine" id="cb1-12" title="12">  <span class="op">};</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="op">};</span></a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(LogoutButton)<span class="op">;</span></a></code></pre></div>
<p>Take a moment to import the <code>useSelector</code> and <code>useDispatch</code> from the Redux library into the file.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="im">import</span> <span class="op">{</span> useDispatch<span class="op">,</span> useSelector <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Now you’ll use Redux hooks within the <code>LoginButton</code> component so that you can remove the <code>mapStateToProps</code>, <code>mapDispatchToProps</code>, and <code>connect</code> functions!</p>
<h4 id="refactor-mapstatetoprops-to-useselector">Refactor <code>mapStateToProps</code> to <code>useSelector</code></h4>
<p>Instead of receiving a <code>loggedOut</code> prop, you’ll use the <code>useSelector</code> hook to access the state’s <code>authentication.token</code>.</p>
<p>Add the <code>useSelector</code> to the top of your component.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> LogoutButton <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">const</span> loggedOut <span class="op">=</span> <span class="at">useSelector</span>(state <span class="kw">=&gt;</span> <span class="op">!</span><span class="va">state</span>.<span class="va">authentication</span>.<span class="at">token</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="co">// CODE SHORTENED FOR BREVITY</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="op">};</span></a></code></pre></div>
<blockquote>
<p>Feel free to visit the Redux Hooks documentation to view <a href="https://react-redux.js.org/next/api/hooks#useselector-examples"><code>useSelector</code> examples</a>.</p>
</blockquote>
<p>Then inside the component you can convert the <code>props.loggedOut</code> to simply use the new variable <code>loggedOut</code></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">const</span> LogoutButton <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="kw">const</span> loggedOut <span class="op">=</span> <span class="at">useSelector</span>(state <span class="kw">=&gt;</span> <span class="op">!</span><span class="va">state</span>.<span class="va">authentication</span>.<span class="at">token</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="cf">if</span> (loggedOut) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="cf">return</span> <span class="op">&lt;</span>Redirect to<span class="op">=</span><span class="st">&quot;/login&quot;</span> /&gt;<span class="op">;</span></a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb4-8" title="8">    <span class="op">&lt;</span>div id<span class="op">=</span><span class="st">&quot;logout-button-holder&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9">      <span class="op">&lt;</span>button onClick<span class="op">={</span>handleClick<span class="op">}&gt;</span>Logout&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-10" title="10">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-11" title="11">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="op">};</span></a></code></pre></div>
<h4 id="refactor-mapdispatchtoprops-to-usedispatch">Refactor <code>mapDispatchToProps</code> to <code>useDispatch</code></h4>
<p>Notice how the <code>logout</code> thunk action creator function has already been imported into your <code>LogoutButton.js</code> file. You’ll use <code>useDispatch</code> hook to return a reference to the <code>dispatch</code> function from the Redux store:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> dispatch <span class="op">=</span> <span class="at">useDispatch</span>()<span class="op">;</span></a></code></pre></div>
<p>Then you can use the <code>dispatch</code> function to dispatch the <code>logout</code> function directly inside the <code>handleClick</code> function instead of doing it in <code>mapDispatchToProps</code>.</p>
<p>So much simpler!</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> LogoutButton <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="kw">const</span> loggedOut <span class="op">=</span> <span class="at">useSelector</span>(state <span class="kw">=&gt;</span> <span class="op">!</span><span class="va">state</span>.<span class="va">authentication</span>.<span class="at">token</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="kw">const</span> dispatch <span class="op">=</span> <span class="at">useDispatch</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="kw">const</span> handleClick <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">logout</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="co">// CODE SHORTENED FOR BREVITY</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="op">};</span></a></code></pre></div>
<blockquote>
<p>Feel free to visit the Redux Hooks documentation to view <a href="https://react-redux.js.org/next/api/hooks#examples"><code>useDispatch</code> examples</a>.</p>
</blockquote>
<h4 id="removing-mapstatetoprops-mapdispatchtoprops-and-connect">Removing <code>mapStateToProps</code>, <code>mapDispatchToProps</code>, and <code>connect</code></h4>
<p>Now that we aren’t referencing <code>props.logout</code> and <code>props.loggedOut</code>, you can remove all the old Redux boilerplate code.</p>
<p>Lastly, you’ll want to remove the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions from the file, and replace the <code>connect</code> function to an export statement that exports the <code>LoginButton</code> component by default:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="im">export</span> <span class="im">default</span> LoginButton<span class="op">;</span></a></code></pre></div>
<p>Now that you’ve gone over how to refactor your <code>LogoutButton</code> component, follow the same pattern to implement Redux hooks into your <code>LoginPanel</code>, <code>PokemonDetail</code>, <code>PokemonForm</code>, and <code>PokemonBrowser</code> components.</p>
<h3 id="router-hooks-useparams">Router hooks: <code>useParams</code></h3>
<p>Notice the references to the React Router <code>match</code> prop accessed in your <code>PokemonBrowser</code> and <code>PokemonDetail</code> components? Instead of having your component take in a <code>match</code> prop to access the route parameters, you’ll implement the <code>useParams</code> prop and use object destructuring to access the <code>pokemonId</code> parameter in the <code>PokemonBrowser</code> component and the <code>id</code> parameter in the <code>PokemonDetail</code> component. Feel free to visit React Router documentation to view examples of using the <a href="https://reactrouter.com/web/api/Hooks/useparams"><code>useParams</code> hook</a>.</p>
<p>Once you have finished refactoring, take a moment to commit your changes:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1"><span class="fu">git</span> add .</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="fu">git</span> commit -m <span class="st">&quot;Refactor app to implement redux and react router hooks&quot;</span></a></code></pre></div>
<p>As you can see, refactoring to Functional components with Hooks makes your code much smaller and easier to understand! Going forward with your coding career you’ll probably want to always use hooks instead of class based components, but it’s good that you know how to read class based components and you’ll be able to refactor class based component code to functional hooks components whereever you find them!</p>
<h3 id="next-phase-context">Next Phase… <code>Context</code></h3>
<p>Now that you have practiced refactoring your application to implement Redux hooks, it’s time to work on a Context-based project utilizing React’s <code>useContext</code> hook! However we can’t very well do this in our Redux project since it uses Redux to store all of the state instead of <code>Context</code>! So we’ll be starting with an alternative Pokedex project which uses <code>Context</code> instead.</p>
