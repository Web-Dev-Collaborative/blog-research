<hr />
<!-- @import "[TOC]" {cmd="toc" depthFrom=2 depthTo=6 orderedList=false} -->
<hr />
<h1 id="higher-order-components">Higher-Order Components</h1>
<p>In React, <a href="https://reactjs.org/docs/higher-order-components.html">higher-order components (HOCs)</a> are a pattern for reusing component logic. Ultimately, higher order components allow you to dynamically generate wrapper components.</p>
<p>Before React existed, developers leveraged JavaScript’s support for functions as first-class objects, meaning that functions can be treated just like any other data type (i.e. stored in a variable, object, or array, passed as an argument to a function, or returned from a function). Understanding what higher-order functions are and how they work will help you to understand and use higher-order components in React.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Describe what a higher-order component (HOC) is</li>
<li>Write a higher-order component (HOC) that accepts a component as an argument and returns a new component</li>
</ul>
<h2 id="reviewing-higher-order-functions">Reviewing higher-order functions</h2>
<p>Functions that operate on other functions, either by receiving them as arguments or returning them, are called <strong>higher-order functions</strong>. Said differently, higher-order functions are functions that:</p>
<ul>
<li>Define and return functions;</li>
<li>Accept callbacks as arguments;</li>
<li>Or do both.</li>
</ul>
<h3 id="using-closures-with-higher-order-functions">Using closures with higher-order functions</h3>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures"><strong>closure</strong></a>, also known as <em>lexical scoping</em>, is a function that uses <strong>free variables</strong>, variables defined outside of its scope. Closures come in handy when writing higher-order functions. Consider the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> calculator <span class="op">=</span> <span class="kw">function</span> (operationCb) <span class="op">{</span> <span class="co">// high-order function</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="cf">return</span> <span class="kw">function</span> (op1<span class="op">,</span> op2) <span class="op">{</span> <span class="co">// closure</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`calling with </span><span class="sc">${</span>op1<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>op2<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="kw">const</span> result <span class="op">=</span> <span class="at">operationCb</span>(op1<span class="op">,</span> op2)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`equals </span><span class="sc">${</span>result<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="op">};</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">const</span> addition <span class="op">=</span> <span class="kw">function</span> (n1<span class="op">,</span> n2) <span class="op">{</span> <span class="co">// callback</span></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span>n1<span class="sc">}</span><span class="vs"> + </span><span class="sc">${</span>n2<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-11" title="11">  <span class="cf">return</span> n1 <span class="op">+</span> n2<span class="op">;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="op">}</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">const</span> adder <span class="op">=</span> <span class="at">calculator</span>(addition)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="at">adder</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">// calling with 1 2</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">// 1 + 2</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">// equals 3</span></a></code></pre></div>
<p>The <code>calculator</code> function receives a callback as an argument (<code>operationCb</code>) which is called in the anonymous function <code>calculator</code> returns. This return value would not work if the inner function could not close over <code>operationCb</code>, a variable defined outside of its scope.</p>
<h3 id="defining-higher-order-functions-with-arrow-functions">Defining higher-order functions with arrow functions</h3>
<p>Arrow functions make it easy to write higher-order functions. The two examples below illustrate the same function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// Without arrow functions (ES5):</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">function</span> <span class="at">foo</span>(arg1) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="cf">return</span> <span class="kw">function</span>(arg2) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="cf">return</span> <span class="kw">function</span>(arg3) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-5" title="5">      <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span>arg1<span class="sc">}</span><span class="vs"> came before </span><span class="sc">${</span>arg2<span class="sc">}</span><span class="vs"> and </span><span class="sc">${</span>arg3<span class="sc">}</span><span class="vs"> came last`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="op">};</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="op">};</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">// With arrow functions (ES6):</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw">const</span> foo <span class="op">=</span> arg1 <span class="kw">=&gt;</span> arg2 <span class="kw">=&gt;</span> arg3 <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span>arg1<span class="sc">}</span><span class="vs"> came before </span><span class="sc">${</span>arg2<span class="sc">}</span><span class="vs"> and </span><span class="sc">${</span>arg3<span class="sc">}</span><span class="vs"> came last`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="op">};</span></a></code></pre></div>
<p>Here’s the earlier <code>calculator</code> function rewritten using arrow functions:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> calculator <span class="op">=</span> (operationCb) <span class="kw">=&gt;</span> (op1<span class="op">,</span> op2) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`calling with </span><span class="sc">${</span>op1<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>op2<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="kw">const</span> result <span class="op">=</span> <span class="at">operationCb</span>(op1<span class="op">,</span> op2)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`equals </span><span class="sc">${</span>result<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="op">};</span></a></code></pre></div>
<blockquote>
<p><strong>Note:</strong> Remember, ES6 arrow functions, unlike normal JavaScript functions, are automatically bound to the context (<code>this</code>) that existed when they were defined. In other words, <code>this</code> means the same thing inside an arrow function that it does outside of it.</p>
</blockquote>
<h2 id="leveraging-higher-order-components-hocs">Leveraging higher-order components (HOCs)</h2>
<p>In the same way that higher-order functions can receive a function as an argument and return a new function, <a href="https://reactjs.org/docs/higher-order-components.html"><strong>higher-order components</strong> or <strong>HOC</strong>s</a> receive a React component as an argument and return a new component.</p>
<h3 id="protectedroute-and-authroute"><code>ProtectedRoute</code> and <code>AuthRoute</code></h3>
<p>In the <strong>React Twitter Lite</strong> project, you created two HOCs to control what pages users could see based upon their authentication status. The <code>ProtectedRoute</code> HOC ensured that only logged users could view the Profile and Home pages while the <code>AuthRoute</code> HOC prevented logged in users from viewing the <code>Login</code> or <code>Registration</code> pages:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="im">export</span> <span class="kw">const</span> ProtectedRoute <span class="op">=</span> (<span class="op">{</span> <span class="dt">component</span><span class="op">:</span> Component<span class="op">,</span> path<span class="op">,</span> currentUserId<span class="op">,</span> exact <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="op">&lt;</span>Route</a>
<a class="sourceLine" id="cb4-4" title="4">      path<span class="op">={</span>path<span class="op">}</span></a>
<a class="sourceLine" id="cb4-5" title="5">      exact<span class="op">={</span>exact<span class="op">}</span></a>
<a class="sourceLine" id="cb4-6" title="6">      render<span class="op">={</span>(props) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb4-7" title="7">        currentUserId <span class="op">?</span> <span class="op">&lt;</span>Component <span class="op">{</span>...<span class="at">props</span><span class="op">}</span> /&gt; : <span class="op">&lt;</span>Redirect to<span class="op">=</span><span class="st">&quot;/login&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb4-8" title="8">      <span class="op">}</span></a>
<a class="sourceLine" id="cb4-9" title="9">    /&gt;</a>
<a class="sourceLine" id="cb4-10" title="10">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="op">};</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="im">export</span> <span class="kw">const</span> AuthRoute <span class="op">=</span> (<span class="op">{</span> <span class="dt">component</span><span class="op">:</span> Component<span class="op">,</span> path<span class="op">,</span> currentUserId<span class="op">,</span> exact <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="op">&lt;</span>Route</a>
<a class="sourceLine" id="cb5-4" title="4">      path<span class="op">={</span>path<span class="op">}</span></a>
<a class="sourceLine" id="cb5-5" title="5">      exact<span class="op">={</span>exact<span class="op">}</span></a>
<a class="sourceLine" id="cb5-6" title="6">      render<span class="op">={</span>(props) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb5-7" title="7">        currentUserId <span class="op">?</span> <span class="op">&lt;</span>Redirect to<span class="op">=</span><span class="st">&quot;/&quot;</span> /&gt; : <span class="op">&lt;</span>Component <span class="op">{</span>...<span class="at">props</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb5-8" title="8">      <span class="op">}</span></a>
<a class="sourceLine" id="cb5-9" title="9">    /&gt;</a>
<a class="sourceLine" id="cb5-10" title="10">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="op">};</span></a></code></pre></div>
<p>Notice how both components accept a component via the <code>component</code> parameter and return a <code>Route</code> component (that renders the passed component via a <code>render</code> prop).</p>
<h2 id="using-hocs-to-keep-code-dry">Using HOCs to keep code DRY</h2>
<p>HOCs give React developers a powerful way to reuse component logic so that they can keep their code DRY.</p>
<p>When learning about Redux container components, you might have noticed that the <code>FruitManagerContainer</code> and <code>FarmerManagerContainer</code> components in the Fruit Stand application contain the same <code>componentDidMount</code> and <code>componentWillUnmount</code> lifecycle method implementations:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="co">// ./src/components/FruitManagerContainer.js</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;../store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="im">import</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-6" title="6">  addFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb6-7" title="7">  addFruits<span class="op">,</span></a>
<a class="sourceLine" id="cb6-8" title="8">  sellFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb6-9" title="9">  sellOut<span class="op">,</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/fruitActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="im">import</span> FruitManager <span class="im">from</span> <span class="st">&#39;./FruitManager&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">class</span> FruitManagerContainer <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-15" title="15">    <span class="kw">this</span>.<span class="at">unsubscribe</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">subscribe</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-16" title="16">      <span class="kw">this</span>.<span class="at">forceUpdate</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-17" title="17">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-18" title="18">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-19" title="19"></a>
<a class="sourceLine" id="cb6-20" title="20">  <span class="at">componentWillUnmount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-21" title="21">    <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">unsubscribe</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-22" title="22">      <span class="kw">this</span>.<span class="at">unsubscribe</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-23" title="23">    <span class="op">}</span></a>
<a class="sourceLine" id="cb6-24" title="24">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-25" title="25"></a>
<a class="sourceLine" id="cb6-26" title="26">  add <span class="op">=</span> (fruit) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-27" title="27">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addFruit</span>(fruit))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-28" title="28">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-29" title="29"></a>
<a class="sourceLine" id="cb6-30" title="30">  addBulk <span class="op">=</span> (fruit) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-31" title="31">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addFruits</span>(fruit))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-32" title="32">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-33" title="33"></a>
<a class="sourceLine" id="cb6-34" title="34">  sell <span class="op">=</span> (fruit) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-35" title="35">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">sellFruit</span>(fruit))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-36" title="36">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-37" title="37"></a>
<a class="sourceLine" id="cb6-38" title="38">  sellAll <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-39" title="39">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">sellOut</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb6-40" title="40">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-41" title="41"></a>
<a class="sourceLine" id="cb6-42" title="42">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-43" title="43">    <span class="kw">const</span> <span class="op">{</span> fruit <span class="op">}</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-44" title="44">    <span class="kw">const</span> distinctFruit <span class="op">=</span> <span class="va">Array</span>.<span class="at">from</span>(<span class="kw">new</span> <span class="at">Set</span>(fruit)).<span class="at">sort</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-45" title="45"></a>
<a class="sourceLine" id="cb6-46" title="46">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb6-47" title="47">      <span class="op">&lt;</span>FruitManager</a>
<a class="sourceLine" id="cb6-48" title="48">        fruit<span class="op">={</span>fruit<span class="op">}</span></a>
<a class="sourceLine" id="cb6-49" title="49">        distinctFruit<span class="op">={</span>distinctFruit<span class="op">}</span></a>
<a class="sourceLine" id="cb6-50" title="50">        add<span class="op">={</span><span class="kw">this</span>.<span class="at">add</span><span class="op">}</span></a>
<a class="sourceLine" id="cb6-51" title="51">        addBulk<span class="op">={</span><span class="kw">this</span>.<span class="at">addBulk</span><span class="op">}</span></a>
<a class="sourceLine" id="cb6-52" title="52">        sell<span class="op">={</span><span class="kw">this</span>.<span class="at">sell</span><span class="op">}</span></a>
<a class="sourceLine" id="cb6-53" title="53">        sellAll<span class="op">={</span><span class="kw">this</span>.<span class="at">sellAll</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb6-54" title="54">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb6-55" title="55">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-56" title="56"><span class="op">}</span></a>
<a class="sourceLine" id="cb6-57" title="57"></a>
<a class="sourceLine" id="cb6-58" title="58"><span class="im">export</span> <span class="im">default</span> FruitManagerContainer<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="co">// ./src/components/FarmerManagerContainer.js</span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;../store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="im">import</span> <span class="op">{</span> hireFarmer<span class="op">,</span> payFarmer <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/farmersActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="im">import</span> FarmerManager <span class="im">from</span> <span class="st">&#39;./FarmerManager&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-7" title="7"></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="kw">class</span> FarmerManagerContainer <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="kw">this</span>.<span class="at">unsubscribe</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">subscribe</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-11" title="11">      <span class="kw">this</span>.<span class="at">forceUpdate</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-12" title="12">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-14" title="14"></a>
<a class="sourceLine" id="cb7-15" title="15">  <span class="at">componentWillUnmount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-16" title="16">    <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">unsubscribe</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-17" title="17">      <span class="kw">this</span>.<span class="at">unsubscribe</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-18" title="18">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-19" title="19">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-20" title="20"></a>
<a class="sourceLine" id="cb7-21" title="21">  pay <span class="op">=</span> (id) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-22" title="22">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">payFarmer</span>(id))<span class="op">;</span></a>
<a class="sourceLine" id="cb7-23" title="23">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-24" title="24"></a>
<a class="sourceLine" id="cb7-25" title="25">  hire <span class="op">=</span> (name) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-26" title="26">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">hireFarmer</span>(name))<span class="op">;</span></a>
<a class="sourceLine" id="cb7-27" title="27">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-28" title="28"></a>
<a class="sourceLine" id="cb7-29" title="29">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-30" title="30">    <span class="kw">const</span> <span class="op">{</span> <span class="dt">farmers</span><span class="op">:</span> farmersState <span class="op">}</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-31" title="31">    <span class="kw">const</span> farmers <span class="op">=</span> <span class="va">Object</span>.<span class="at">values</span>(farmersState)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-32" title="32"></a>
<a class="sourceLine" id="cb7-33" title="33">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb7-34" title="34">      <span class="op">&lt;</span>FarmerManager</a>
<a class="sourceLine" id="cb7-35" title="35">        farmers<span class="op">={</span>farmers<span class="op">}</span></a>
<a class="sourceLine" id="cb7-36" title="36">        pay<span class="op">={</span><span class="kw">this</span>.<span class="at">pay</span><span class="op">}</span></a>
<a class="sourceLine" id="cb7-37" title="37">        hire<span class="op">={</span><span class="kw">this</span>.<span class="at">hire</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb7-38" title="38">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb7-39" title="39">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="op">}</span></a>
<a class="sourceLine" id="cb7-41" title="41"></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="im">export</span> <span class="im">default</span> FarmerManagerContainer<span class="op">;</span></a></code></pre></div>
<p>While the amount of duplicated code is currently relatively small, keep in mind that <strong>the approach of using the <code>forceUpdate</code> method to render the component whenever state is updated in the store isn’t optimal</strong>. Calling <code>forceUpdate</code> causes <code>render</code> to be called without first calling <code>shouldComponentUpdate</code>.</p>
<p>Ideally, each container component should contain logic to determine if the state that it retrieves from the store has <em>actually changed</em> before continuing with rendering. Adding the code for this logic would increase the amount of code duplicated in each container component.</p>
<h3 id="react-redux-connect">React-Redux <code>connect</code></h3>
<p><a href="https://react-redux.js.org/">React-Redux</a>, a library from the creators of <a href="https://redux.js.org/">Redux</a>, includes a higher-order component named <code>connect</code> that you can use to create container components. Using <code>connect</code> frees you from having to manually create the <code>FruitManagerContainer</code> and <code>FarmerManagerContainer</code> container components. Using <code>connect</code> also eliminates boilerplate code so you can focus on what makes each container unique: selecting specific slices of state from the store and writing functions to dispatch specific actions. Even better, <code>connect</code> includes the logic that’s needed to optimize the rendering performance, only rendering when the state retrieved from the store has <em>actually changed</em>.</p>
<blockquote>
<p>Over the next couple of articles, you’ll learn how to use <code>connect</code> and the <a href="https://react-redux.js.org/">React-Redux</a> library.</p>
</blockquote>
<h3 id="writing-a-hoc-for-creating-container-components">Writing a HOC for creating container components</h3>
<p>Higher-order components like <a href="https://react-redux.js.org/">React-Redux</a> <code>connect</code>, while extremely useful, can be confusing to understand. To help give you some insight into the underlying implementation of the <code>connect</code> function, you can build a your own <em>custom version</em> of <code>connect</code> (albeit without the logic that’s needed to optimize rendering performance).</p>
<blockquote>
<p>Don’t worry if you struggle to fully understand the following custom version of <code>connect</code>. It takes time and practice to get comfortable with the techniques that are used to create higher-order components. And remember, <strong>you don’t have to build your <code>connect</code> function!</strong> Going forward, you’ll use the well-maintained, highly optimized <code>connect</code> function provided by the <a href="https://react-redux.js.org/">React-Redux</a> library.</p>
</blockquote>
<p>Consider the following <em>custom</em> <code>connect</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="co">// ./src/connect.js</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">const</span> connect <span class="op">=</span> (mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="kw">=&gt;</span> (WrappedComponent) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb8-7" title="7">  <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-9" title="9">      <span class="kw">let</span> stateProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb8-10" title="10">      <span class="cf">if</span> (mapStateToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-11" title="11">        stateProps <span class="op">=</span> <span class="at">mapStateToProps</span>(<span class="va">store</span>.<span class="at">getState</span>()<span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-12" title="12">      <span class="op">}</span></a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14">      <span class="kw">let</span> dispatchProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb8-15" title="15">      <span class="cf">if</span> (mapDispatchToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-16" title="16">        dispatchProps <span class="op">=</span> <span class="at">mapDispatchToProps</span>(<span class="va">store</span>.<span class="at">dispatch</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-17" title="17">      <span class="op">}</span></a>
<a class="sourceLine" id="cb8-18" title="18"></a>
<a class="sourceLine" id="cb8-19" title="19">      <span class="kw">const</span> propsToSpread <span class="op">=</span> <span class="va">Object</span>.<span class="at">assign</span>(<span class="op">{},</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">,</span> stateProps<span class="op">,</span> dispatchProps)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-20" title="20"></a>
<a class="sourceLine" id="cb8-21" title="21">      <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb8-22" title="22">        <span class="op">&lt;</span>WrappedComponent <span class="op">{</span>...<span class="at">propsToSpread</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb8-23" title="23">      )<span class="op">;</span></a>
<a class="sourceLine" id="cb8-24" title="24">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-25" title="25"></a>
<a class="sourceLine" id="cb8-26" title="26">    <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-27" title="27">      <span class="kw">this</span>.<span class="at">unsubscribe</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">subscribe</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-28" title="28">        <span class="kw">this</span>.<span class="at">forceUpdate</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-29" title="29">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-30" title="30">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-31" title="31">  </a>
<a class="sourceLine" id="cb8-32" title="32">    <span class="at">componentWillUnmount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-33" title="33">      <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">unsubscribe</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-34" title="34">        <span class="kw">this</span>.<span class="at">unsubscribe</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-35" title="35">      <span class="op">}</span></a>
<a class="sourceLine" id="cb8-36" title="36">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-37" title="37">  <span class="op">}</span></a>
<a class="sourceLine" id="cb8-38" title="38">)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-39" title="39"></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="im">export</span> <span class="im">default</span> connect<span class="op">;</span></a></code></pre></div>
<p>The <code>connect</code> function is a higher-order component that returns a function. That function returns an anonymous class component that wraps the component passed in via the <code>WrappedComponent</code> parameter.</p>
<p>The anonymous class component is a “generic” container component that <em>connects</em> <code>WrappedComponent</code> to the Redux store by:</p>
<ul>
<li>Defining the <code>componentDidMount</code> and <code>componentWillUnmount</code> lifecycle method implementations necessary for managing the subscription to the store to render <code>WrappedComponent</code> when state is updated; and</li>
<li>Passing slices of state and functions to dispatch actions down to <code>WrappedComponent</code> using props.</li>
</ul>
<h3 id="comparing-nested-arrow-functions-to-regular-functions">Comparing nested arrow functions to regular functions</h3>
<p>As you saw earlier in this article, higher-order functions can be written using arrow functions or regular functions. The <code>connect</code> higher-order function can be written using arrow functions and implicit return statements:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> connect <span class="op">=</span> (mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="kw">=&gt;</span> (WrappedComponent) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb9-5" title="5">)<span class="op">;</span></a></code></pre></div>
<p>Or can be rewritten using regular functions and explicit return statements:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">function</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="cf">return</span> <span class="kw">function</span>(WrappedComponent) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-3" title="3">    <span class="cf">return</span> <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-4" title="4">      <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb10-5" title="5">    <span class="op">};</span></a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="op">};</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="op">};</span></a></code></pre></div>
<p>The arrow function syntax, while concise, can be confusing to read.</p>
<h3 id="dynamically-setting-component-attributes">Dynamically setting component attributes</h3>
<p>The <code>connect</code> function’s <code>mapStateToProps</code> and <code>mapDispatchToProps</code> parameters are both functions that are called within the anonymous class’ <code>render</code> method:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">const</span> connect <span class="op">=</span> (mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="kw">=&gt;</span> (WrappedComponent) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb11-3" title="3">    <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb11-4" title="4">      <span class="kw">let</span> stateProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb11-5" title="5">      <span class="cf">if</span> (mapStateToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-6" title="6">        stateProps <span class="op">=</span> <span class="at">mapStateToProps</span>(<span class="va">store</span>.<span class="at">getState</span>()<span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-7" title="7">      <span class="op">}</span></a>
<a class="sourceLine" id="cb11-8" title="8"></a>
<a class="sourceLine" id="cb11-9" title="9">      <span class="kw">let</span> dispatchProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb11-10" title="10">      <span class="cf">if</span> (mapDispatchToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-11" title="11">        dispatchProps <span class="op">=</span> <span class="at">mapDispatchToProps</span>(<span class="va">store</span>.<span class="at">dispatch</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-12" title="12">      <span class="op">}</span></a>
<a class="sourceLine" id="cb11-13" title="13"></a>
<a class="sourceLine" id="cb11-14" title="14">      <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb11-15" title="15">    <span class="op">}</span></a>
<a class="sourceLine" id="cb11-16" title="16"></a>
<a class="sourceLine" id="cb11-17" title="17">    <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb11-18" title="18">  <span class="op">}</span></a>
<a class="sourceLine" id="cb11-19" title="19">)<span class="op">;</span></a></code></pre></div>
<p>The Redux store’s current state, retrieved using <code>store.getState</code>, is passed to the <code>mapStateToProps</code> function and the store’s <code>dispatch</code> method is passed to the <code>mapDispatchToProps</code> function. The <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions also receive the anonymous class component’s props (via <code>this.props</code>).</p>
<p>But what are the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions exactly? To answer that question, take a look at an example of using the <code>connect</code> function to define the <code>FruitManagerContainer</code> component:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="co">// ./src/components/FruitManagerContainer.js</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="im">import</span> connect <span class="im">from</span> <span class="st">&#39;../connect&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="im">import</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-5" title="5">  addFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb12-6" title="6">  addFruits<span class="op">,</span></a>
<a class="sourceLine" id="cb12-7" title="7">  sellFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb12-8" title="8">  sellOut<span class="op">,</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/fruitActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="im">import</span> FruitManager <span class="im">from</span> <span class="st">&#39;./FruitManager&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-11" title="11"></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb12-13" title="13">  <span class="dt">fruit</span><span class="op">:</span> <span class="va">state</span>.<span class="at">fruit</span><span class="op">,</span></a>
<a class="sourceLine" id="cb12-14" title="14">  <span class="dt">distinctFruit</span><span class="op">:</span> <span class="va">Array</span>.<span class="at">from</span>(<span class="kw">new</span> <span class="at">Set</span>(<span class="va">state</span>.<span class="at">fruit</span>)).<span class="at">sort</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-16" title="16"></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> (dispatch) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb12-18" title="18">  <span class="dt">add</span><span class="op">:</span> (fruit) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addFruit</span>(fruit))<span class="op">,</span></a>
<a class="sourceLine" id="cb12-19" title="19">  <span class="dt">addBulk</span><span class="op">:</span> (fruit) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addFruits</span>(fruit))<span class="op">,</span></a>
<a class="sourceLine" id="cb12-20" title="20">  <span class="dt">sell</span><span class="op">:</span> (fruit) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">sellFruit</span>(fruit))<span class="op">,</span></a>
<a class="sourceLine" id="cb12-21" title="21">  <span class="dt">sellAll</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">sellOut</span>())<span class="op">,</span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-23" title="23"></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb12-25" title="25">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb12-26" title="26">  mapDispatchToProps</a>
<a class="sourceLine" id="cb12-27" title="27">)(FruitManager)<span class="op">;</span></a></code></pre></div>
<p><code>mapStateToProps</code> is a function that accepts store’s current state and returns an object that maps state data to one or more properties. <code>mapDispatchToProps</code> is also a function, but it accepts the store’s <code>dispatch</code> method and returns an object whose properties are set to functions that can be called dispatch actions to the store.</p>
<p>In the <code>connect</code> function, <code>Object.assign</code> is then used to combine the <code>stateProps</code> and <code>dispatchProps</code> objects with <code>this.props</code> (the anonymous class component’s props):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">const</span> propsToSpread <span class="op">=</span> <span class="va">Object</span>.<span class="at">assign</span>(<span class="op">{},</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">,</span> stateProps<span class="op">,</span> dispatchProps)<span class="op">;</span></a></code></pre></div>
<p>Then the properties defined on the <code>propsToSpread</code> object become props on <code>WrappedComponent</code> using JSX spread attribute syntax (<code>...</code>):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="cf">return</span> (</a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="op">&lt;</span>WrappedComponent <span class="op">{</span>...<span class="at">propsToSpread</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb14-3" title="3">)<span class="op">;</span></a></code></pre></div>
<p>Within the <code>FruitManager</code> component (the component that the <code>connect</code> function’s <code>WrappedComponent</code> is wrapping), parameter destructuring is used to reference the props provided by the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions. These props are then passed as props to the appropriate child presentational component:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="co">// ./src/components/FruitManager.js</span></a>
<a class="sourceLine" id="cb15-2" title="2"></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="im">import</span> FruitList <span class="im">from</span> <span class="st">&#39;./FruitList&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="im">import</span> FruitSeller <span class="im">from</span> <span class="st">&#39;./FruitSeller&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="im">import</span> FruitQuickAdd <span class="im">from</span> <span class="st">&#39;./FruitQuickAdd&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="im">import</span> FruitBulkAdd <span class="im">from</span> <span class="st">&#39;./FruitBulkAdd&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-8" title="8"></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw">const</span> FruitManager <span class="op">=</span> (<span class="op">{</span> fruit<span class="op">,</span> distinctFruit<span class="op">,</span> add<span class="op">,</span> addBulk<span class="op">,</span> sell<span class="op">,</span> sellAll <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb15-11" title="11">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-12" title="12">      <span class="op">&lt;</span>h2<span class="op">&gt;</span>Available Fruit&lt;/h2<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-13" title="13">      <span class="op">&lt;</span>FruitList fruit<span class="op">={</span>fruit<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-14" title="14">      <span class="op">&lt;</span>h2<span class="op">&gt;</span>Fruit Inventory Manager&lt;/h2<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-15" title="15">      <span class="op">&lt;</span>FruitSeller distinctFruit<span class="op">={</span>distinctFruit<span class="op">}</span> sell<span class="op">={</span>sell<span class="op">}</span> sellAll<span class="op">={</span>sellAll<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-16" title="16">      <span class="op">&lt;</span>FruitQuickAdd add<span class="op">={</span>add<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-17" title="17">      <span class="op">&lt;</span>FruitBulkAdd addBulk<span class="op">={</span>addBulk<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-18" title="18">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-19" title="19">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-21" title="21"></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="im">export</span> <span class="im">default</span> FruitManager<span class="op">;</span></a></code></pre></div>
<p>Visualizing the flow of data all the from the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> function definitions within the <code>FruitManagerContainer.js</code> file through the <code>connect</code> higher-order component down to the <code>FruitManager</code> wrapped component is <strong>difficult to do</strong>. Understanding how to use React’s ability to dynamically set component attributes using JSX spread attribute syntax is <strong>one of the more challenging aspects of writing higher-order components</strong>.</p>
<p><strong>Just remember that you don’t need to fully understand the above example to use the <code>connect</code> function provided by the <a href="https://react-redux.js.org/">React-Redux</a> library.</strong></p>
<h2 id="reviewing-a-completed-fruit-stand-example">Reviewing a completed Fruit Stand example</h2>
<p>To review and run a completed Fruit Stand example application that utilizes the above <em>custom</em> <code>connect</code> higher-order component to create container components, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>fruit-stand-redux-with-react-generic-container</code> folder. Run the command <code>npm install</code> to install the project’s dependencies. Then use the command <code>npm start</code> to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the Create React App tooling. When running the application using <code>npm start</code>, the application should automatically open in your default browser. If it doesn’t, you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 id="what-you-learned">What you learned</h2>
<p>In this article, you learned about higher-order components (HOCs) including how to write a higher-order component that accepts a component as an argument and returns a new component.</p>
