<h1 id="week-15-day-3-react-redux" data-ignore="true">WEEK-15 DAY-3<br><em>React + Redux</em></h1>
<hr />
<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=2 orderedList=false} -->
<hr />
<hr />
<h1 id="redux-learning-objectives-part-3">Redux Learning Objectives: Part 3</h1>
<p>Just like Luke Skywalker returning to Dagobah to complete his Jedi training with Yoda, it’s time for you to return to learning Redux one more time. In this final section on Redux, you’ll learn how to use the React-Redux library to connect components to a Redux store and how to use middleware and thunks to interact with an API.</p>
<p>After completing this final section on Redux, you should be able to:</p>
<ul>
<li>Describe what a higher-order component (HOC) is</li>
<li>Write a higher-order component (HOC) that accepts a component as an argument and returns a new component</li>
<li>Use the React-Redux library’s <code>&lt;Provider /&gt;</code> component to make your Redux store available to any nested components that have been wrapped in the <code>connect</code> function</li>
<li>Use the React-Redux library’s <code>connect</code> function to give a component access to a Redux store</li>
<li>Write a selector to extract and format information from state stored in a Redux store</li>
<li>Use the React-Redux library’s <code>applyMiddleware</code> function to configure one or more middleware when creating a store</li>
<li>Write a thunk action creator to make an asynchronous request to an API and dispatch an action when the response is received</li>
<li>Describe a situation where defining multiple containers for a single component is advantageous</li>
<li>Configure a React application to use the Redux development tools</li>
</ul>
<hr />
<h1 id="higher-order-components">Higher-Order Components</h1>
<p>In React, <a href="https://reactjs.org/docs/higher-order-components.html">higher-order components (HOCs)</a> are a pattern for reusing component logic. Ultimately, higher order components allow you to dynamically generate wrapper components.</p>
<p>Before React existed, developers leveraged JavaScript’s support for functions as first-class objects, meaning that functions can be treated just like any other data type (i.e. stored in a variable, object, or array, passed as an argument to a function, or returned from a function). Understanding what higher-order functions are and how they work will help you to understand and use higher-order components in React.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Describe what a higher-order component (HOC) is</li>
<li>Write a higher-order component (HOC) that accepts a component as an argument and returns a new component</li>
</ul>
<h2 id="reviewing-higher-order-functions">Reviewing higher-order functions</h2>
<p>Functions that operate on other functions, either by receiving them as arguments or returning them, are called <strong>higher-order functions</strong>. Said differently, higher-order functions are functions that:</p>
<ul>
<li>Define and return functions;</li>
<li>Accept callbacks as arguments;</li>
<li>Or do both.</li>
</ul>
<h3 id="using-closures-with-higher-order-functions">Using closures with higher-order functions</h3>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures"><strong>closure</strong></a>, also known as <em>lexical scoping</em>, is a function that uses <strong>free variables</strong>, variables defined outside of its scope. Closures come in handy when writing higher-order functions. Consider the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> calculator <span class="op">=</span> <span class="kw">function</span> (operationCb) <span class="op">{</span> <span class="co">// high-order function</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="cf">return</span> <span class="kw">function</span> (op1<span class="op">,</span> op2) <span class="op">{</span> <span class="co">// closure</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`calling with </span><span class="sc">${</span>op1<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>op2<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="kw">const</span> result <span class="op">=</span> <span class="at">operationCb</span>(op1<span class="op">,</span> op2)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`equals </span><span class="sc">${</span>result<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="op">};</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">const</span> addition <span class="op">=</span> <span class="kw">function</span> (n1<span class="op">,</span> n2) <span class="op">{</span> <span class="co">// callback</span></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span>n1<span class="sc">}</span><span class="vs"> + </span><span class="sc">${</span>n2<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-11" title="11">  <span class="cf">return</span> n1 <span class="op">+</span> n2<span class="op">;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="op">}</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">const</span> adder <span class="op">=</span> <span class="at">calculator</span>(addition)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="at">adder</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">// calling with 1 2</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">// 1 + 2</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">// equals 3</span></a></code></pre></div>
<p>The <code>calculator</code> function receives a callback as an argument (<code>operationCb</code>) which is called in the anonymous function <code>calculator</code> returns. This return value would not work if the inner function could not close over <code>operationCb</code>, a variable defined outside of its scope.</p>
<h3 id="defining-higher-order-functions-with-arrow-functions">Defining higher-order functions with arrow functions</h3>
<p>Arrow functions make it easy to write higher-order functions. The two examples below illustrate the same function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// Without arrow functions (ES5):</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">function</span> <span class="at">foo</span>(arg1) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="cf">return</span> <span class="kw">function</span>(arg2) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="cf">return</span> <span class="kw">function</span>(arg3) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-5" title="5">      <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span>arg1<span class="sc">}</span><span class="vs"> came before </span><span class="sc">${</span>arg2<span class="sc">}</span><span class="vs"> and </span><span class="sc">${</span>arg3<span class="sc">}</span><span class="vs"> came last`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="op">};</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="op">};</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">// With arrow functions (ES6):</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw">const</span> foo <span class="op">=</span> arg1 <span class="kw">=&gt;</span> arg2 <span class="kw">=&gt;</span> arg3 <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span>arg1<span class="sc">}</span><span class="vs"> came before </span><span class="sc">${</span>arg2<span class="sc">}</span><span class="vs"> and </span><span class="sc">${</span>arg3<span class="sc">}</span><span class="vs"> came last`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="op">};</span></a></code></pre></div>
<p>Here’s the earlier <code>calculator</code> function rewritten using arrow functions:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> calculator <span class="op">=</span> (operationCb) <span class="kw">=&gt;</span> (op1<span class="op">,</span> op2) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`calling with </span><span class="sc">${</span>op1<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>op2<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="kw">const</span> result <span class="op">=</span> <span class="at">operationCb</span>(op1<span class="op">,</span> op2)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`equals </span><span class="sc">${</span>result<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="op">};</span></a></code></pre></div>
<blockquote>
<p><strong>Note:</strong> Remember, ES6 arrow functions, unlike normal JavaScript functions, are automatically bound to the context (<code>this</code>) that existed when they were defined. In other words, <code>this</code> means the same thing inside an arrow function that it does outside of it.</p>
</blockquote>
<h2 id="leveraging-higher-order-components-hocs">Leveraging higher-order components (HOCs)</h2>
<p>In the same way that higher-order functions can receive a function as an argument and return a new function, <a href="https://reactjs.org/docs/higher-order-components.html"><strong>higher-order components</strong> or <strong>HOC</strong>s</a> receive a React component as an argument and return a new component.</p>
<h3 id="protectedroute-and-authroute"><code>ProtectedRoute</code> and <code>AuthRoute</code></h3>
<p>In the <strong>React Twitter Lite</strong> project, you created two HOCs to control what pages users could see based upon their authentication status. The <code>ProtectedRoute</code> HOC ensured that only logged users could view the Profile and Home pages while the <code>AuthRoute</code> HOC prevented logged in users from viewing the <code>Login</code> or <code>Registration</code> pages:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="im">export</span> <span class="kw">const</span> ProtectedRoute <span class="op">=</span> (<span class="op">{</span> <span class="dt">component</span><span class="op">:</span> Component<span class="op">,</span> path<span class="op">,</span> currentUserId<span class="op">,</span> exact <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="op">&lt;</span>Route</a>
<a class="sourceLine" id="cb4-4" title="4">      path<span class="op">={</span>path<span class="op">}</span></a>
<a class="sourceLine" id="cb4-5" title="5">      exact<span class="op">={</span>exact<span class="op">}</span></a>
<a class="sourceLine" id="cb4-6" title="6">      render<span class="op">={</span>(props) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb4-7" title="7">        currentUserId <span class="op">?</span> <span class="op">&lt;</span>Component <span class="op">{</span>...<span class="at">props</span><span class="op">}</span> /&gt; : <span class="op">&lt;</span>Redirect to<span class="op">=</span><span class="st">&quot;/login&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb4-8" title="8">      <span class="op">}</span></a>
<a class="sourceLine" id="cb4-9" title="9">    /&gt;</a>
<a class="sourceLine" id="cb4-10" title="10">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="op">};</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="im">export</span> <span class="kw">const</span> AuthRoute <span class="op">=</span> (<span class="op">{</span> <span class="dt">component</span><span class="op">:</span> Component<span class="op">,</span> path<span class="op">,</span> currentUserId<span class="op">,</span> exact <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="op">&lt;</span>Route</a>
<a class="sourceLine" id="cb5-4" title="4">      path<span class="op">={</span>path<span class="op">}</span></a>
<a class="sourceLine" id="cb5-5" title="5">      exact<span class="op">={</span>exact<span class="op">}</span></a>
<a class="sourceLine" id="cb5-6" title="6">      render<span class="op">={</span>(props) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb5-7" title="7">        currentUserId <span class="op">?</span> <span class="op">&lt;</span>Redirect to<span class="op">=</span><span class="st">&quot;/&quot;</span> /&gt; : <span class="op">&lt;</span>Component <span class="op">{</span>...<span class="at">props</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb5-8" title="8">      <span class="op">}</span></a>
<a class="sourceLine" id="cb5-9" title="9">    /&gt;</a>
<a class="sourceLine" id="cb5-10" title="10">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="op">};</span></a></code></pre></div>
<p>Notice how both components accept a component via the <code>component</code> parameter and return a <code>Route</code> component (that renders the passed component via a <code>render</code> prop).</p>
<h2 id="using-hocs-to-keep-code-dry">Using HOCs to keep code DRY</h2>
<p>HOCs give React developers a powerful way to reuse component logic so that they can keep their code DRY.</p>
<p>When learning about Redux container components, you might have noticed that the <code>FruitManagerContainer</code> and <code>FarmerManagerContainer</code> components in the Fruit Stand application contain the same <code>componentDidMount</code> and <code>componentWillUnmount</code> lifecycle method implementations:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="co">// ./src/components/FruitManagerContainer.js</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;../store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="im">import</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-6" title="6">  addFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb6-7" title="7">  addFruits<span class="op">,</span></a>
<a class="sourceLine" id="cb6-8" title="8">  sellFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb6-9" title="9">  sellOut<span class="op">,</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/fruitActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="im">import</span> FruitManager <span class="im">from</span> <span class="st">&#39;./FruitManager&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">class</span> FruitManagerContainer <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-15" title="15">    <span class="kw">this</span>.<span class="at">unsubscribe</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">subscribe</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-16" title="16">      <span class="kw">this</span>.<span class="at">forceUpdate</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-17" title="17">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-18" title="18">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-19" title="19"></a>
<a class="sourceLine" id="cb6-20" title="20">  <span class="at">componentWillUnmount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-21" title="21">    <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">unsubscribe</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-22" title="22">      <span class="kw">this</span>.<span class="at">unsubscribe</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-23" title="23">    <span class="op">}</span></a>
<a class="sourceLine" id="cb6-24" title="24">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-25" title="25"></a>
<a class="sourceLine" id="cb6-26" title="26">  add <span class="op">=</span> (fruit) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-27" title="27">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addFruit</span>(fruit))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-28" title="28">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-29" title="29"></a>
<a class="sourceLine" id="cb6-30" title="30">  addBulk <span class="op">=</span> (fruit) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-31" title="31">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addFruits</span>(fruit))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-32" title="32">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-33" title="33"></a>
<a class="sourceLine" id="cb6-34" title="34">  sell <span class="op">=</span> (fruit) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-35" title="35">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">sellFruit</span>(fruit))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-36" title="36">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-37" title="37"></a>
<a class="sourceLine" id="cb6-38" title="38">  sellAll <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-39" title="39">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">sellOut</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb6-40" title="40">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-41" title="41"></a>
<a class="sourceLine" id="cb6-42" title="42">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-43" title="43">    <span class="kw">const</span> <span class="op">{</span> fruit <span class="op">}</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-44" title="44">    <span class="kw">const</span> distinctFruit <span class="op">=</span> <span class="va">Array</span>.<span class="at">from</span>(<span class="kw">new</span> <span class="at">Set</span>(fruit)).<span class="at">sort</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-45" title="45"></a>
<a class="sourceLine" id="cb6-46" title="46">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb6-47" title="47">      <span class="op">&lt;</span>FruitManager</a>
<a class="sourceLine" id="cb6-48" title="48">        fruit<span class="op">={</span>fruit<span class="op">}</span></a>
<a class="sourceLine" id="cb6-49" title="49">        distinctFruit<span class="op">={</span>distinctFruit<span class="op">}</span></a>
<a class="sourceLine" id="cb6-50" title="50">        add<span class="op">={</span><span class="kw">this</span>.<span class="at">add</span><span class="op">}</span></a>
<a class="sourceLine" id="cb6-51" title="51">        addBulk<span class="op">={</span><span class="kw">this</span>.<span class="at">addBulk</span><span class="op">}</span></a>
<a class="sourceLine" id="cb6-52" title="52">        sell<span class="op">={</span><span class="kw">this</span>.<span class="at">sell</span><span class="op">}</span></a>
<a class="sourceLine" id="cb6-53" title="53">        sellAll<span class="op">={</span><span class="kw">this</span>.<span class="at">sellAll</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb6-54" title="54">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb6-55" title="55">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-56" title="56"><span class="op">}</span></a>
<a class="sourceLine" id="cb6-57" title="57"></a>
<a class="sourceLine" id="cb6-58" title="58"><span class="im">export</span> <span class="im">default</span> FruitManagerContainer<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="co">// ./src/components/FarmerManagerContainer.js</span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;../store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="im">import</span> <span class="op">{</span> hireFarmer<span class="op">,</span> payFarmer <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/farmersActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="im">import</span> FarmerManager <span class="im">from</span> <span class="st">&#39;./FarmerManager&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-7" title="7"></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="kw">class</span> FarmerManagerContainer <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="kw">this</span>.<span class="at">unsubscribe</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">subscribe</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-11" title="11">      <span class="kw">this</span>.<span class="at">forceUpdate</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-12" title="12">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-14" title="14"></a>
<a class="sourceLine" id="cb7-15" title="15">  <span class="at">componentWillUnmount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-16" title="16">    <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">unsubscribe</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-17" title="17">      <span class="kw">this</span>.<span class="at">unsubscribe</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-18" title="18">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-19" title="19">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-20" title="20"></a>
<a class="sourceLine" id="cb7-21" title="21">  pay <span class="op">=</span> (id) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-22" title="22">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">payFarmer</span>(id))<span class="op">;</span></a>
<a class="sourceLine" id="cb7-23" title="23">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-24" title="24"></a>
<a class="sourceLine" id="cb7-25" title="25">  hire <span class="op">=</span> (name) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-26" title="26">    <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">hireFarmer</span>(name))<span class="op">;</span></a>
<a class="sourceLine" id="cb7-27" title="27">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-28" title="28"></a>
<a class="sourceLine" id="cb7-29" title="29">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-30" title="30">    <span class="kw">const</span> <span class="op">{</span> <span class="dt">farmers</span><span class="op">:</span> farmersState <span class="op">}</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-31" title="31">    <span class="kw">const</span> farmers <span class="op">=</span> <span class="va">Object</span>.<span class="at">values</span>(farmersState)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-32" title="32"></a>
<a class="sourceLine" id="cb7-33" title="33">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb7-34" title="34">      <span class="op">&lt;</span>FarmerManager</a>
<a class="sourceLine" id="cb7-35" title="35">        farmers<span class="op">={</span>farmers<span class="op">}</span></a>
<a class="sourceLine" id="cb7-36" title="36">        pay<span class="op">={</span><span class="kw">this</span>.<span class="at">pay</span><span class="op">}</span></a>
<a class="sourceLine" id="cb7-37" title="37">        hire<span class="op">={</span><span class="kw">this</span>.<span class="at">hire</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb7-38" title="38">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb7-39" title="39">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="op">}</span></a>
<a class="sourceLine" id="cb7-41" title="41"></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="im">export</span> <span class="im">default</span> FarmerManagerContainer<span class="op">;</span></a></code></pre></div>
<p>While the amount of duplicated code is currently relatively small, keep in mind that <strong>the approach of using the <code>forceUpdate</code> method to render the component whenever state is updated in the store isn’t optimal</strong>. Calling <code>forceUpdate</code> causes <code>render</code> to be called without first calling <code>shouldComponentUpdate</code>.</p>
<p>Ideally, each container component should contain logic to determine if the state that it retrieves from the store has <em>actually changed</em> before continuing with rendering. Adding the code for this logic would increase the amount of code duplicated in each container component.</p>
<h3 id="react-redux-connect">React-Redux <code>connect</code></h3>
<p><a href="https://react-redux.js.org/">React-Redux</a>, a library from the creators of <a href="https://redux.js.org/">Redux</a>, includes a higher-order component named <code>connect</code> that you can use to create container components. Using <code>connect</code> frees you from having to manually create the <code>FruitManagerContainer</code> and <code>FarmerManagerContainer</code> container components. Using <code>connect</code> also eliminates boilerplate code so you can focus on what makes each container unique: selecting specific slices of state from the store and writing functions to dispatch specific actions. Even better, <code>connect</code> includes the logic that’s needed to optimize the rendering performance, only rendering when the state retrieved from the store has <em>actually changed</em>.</p>
<blockquote>
<p>Over the next couple of articles, you’ll learn how to use <code>connect</code> and the <a href="https://react-redux.js.org/">React-Redux</a> library.</p>
</blockquote>
<h3 id="writing-a-hoc-for-creating-container-components">Writing a HOC for creating container components</h3>
<p>Higher-order components like <a href="https://react-redux.js.org/">React-Redux</a> <code>connect</code>, while extremely useful, can be confusing to understand. To help give you some insight into the underlying implementation of the <code>connect</code> function, you can build a your own <em>custom version</em> of <code>connect</code> (albeit without the logic that’s needed to optimize rendering performance).</p>
<blockquote>
<p>Don’t worry if you struggle to fully understand the following custom version of <code>connect</code>. It takes time and practice to get comfortable with the techniques that are used to create higher-order components. And remember, <strong>you don’t have to build your <code>connect</code> function!</strong> Going forward, you’ll use the well-maintained, highly optimized <code>connect</code> function provided by the <a href="https://react-redux.js.org/">React-Redux</a> library.</p>
</blockquote>
<p>Consider the following <em>custom</em> <code>connect</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="co">// ./src/connect.js</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">const</span> connect <span class="op">=</span> (mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="kw">=&gt;</span> (WrappedComponent) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb8-7" title="7">  <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-9" title="9">      <span class="kw">let</span> stateProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb8-10" title="10">      <span class="cf">if</span> (mapStateToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-11" title="11">        stateProps <span class="op">=</span> <span class="at">mapStateToProps</span>(<span class="va">store</span>.<span class="at">getState</span>()<span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-12" title="12">      <span class="op">}</span></a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14">      <span class="kw">let</span> dispatchProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb8-15" title="15">      <span class="cf">if</span> (mapDispatchToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-16" title="16">        dispatchProps <span class="op">=</span> <span class="at">mapDispatchToProps</span>(<span class="va">store</span>.<span class="at">dispatch</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-17" title="17">      <span class="op">}</span></a>
<a class="sourceLine" id="cb8-18" title="18"></a>
<a class="sourceLine" id="cb8-19" title="19">      <span class="kw">const</span> propsToSpread <span class="op">=</span> <span class="va">Object</span>.<span class="at">assign</span>(<span class="op">{},</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">,</span> stateProps<span class="op">,</span> dispatchProps)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-20" title="20"></a>
<a class="sourceLine" id="cb8-21" title="21">      <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb8-22" title="22">        <span class="op">&lt;</span>WrappedComponent <span class="op">{</span>...<span class="at">propsToSpread</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb8-23" title="23">      )<span class="op">;</span></a>
<a class="sourceLine" id="cb8-24" title="24">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-25" title="25"></a>
<a class="sourceLine" id="cb8-26" title="26">    <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-27" title="27">      <span class="kw">this</span>.<span class="at">unsubscribe</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">subscribe</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-28" title="28">        <span class="kw">this</span>.<span class="at">forceUpdate</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-29" title="29">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-30" title="30">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-31" title="31">  </a>
<a class="sourceLine" id="cb8-32" title="32">    <span class="at">componentWillUnmount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-33" title="33">      <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">unsubscribe</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-34" title="34">        <span class="kw">this</span>.<span class="at">unsubscribe</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-35" title="35">      <span class="op">}</span></a>
<a class="sourceLine" id="cb8-36" title="36">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-37" title="37">  <span class="op">}</span></a>
<a class="sourceLine" id="cb8-38" title="38">)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-39" title="39"></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="im">export</span> <span class="im">default</span> connect<span class="op">;</span></a></code></pre></div>
<p>The <code>connect</code> function is a higher-order component that returns a function. That function returns an anonymous class component that wraps the component passed in via the <code>WrappedComponent</code> parameter.</p>
<p>The anonymous class component is a “generic” container component that <em>connects</em> <code>WrappedComponent</code> to the Redux store by:</p>
<ul>
<li>Defining the <code>componentDidMount</code> and <code>componentWillUnmount</code> lifecycle method implementations necessary for managing the subscription to the store to render <code>WrappedComponent</code> when state is updated; and</li>
<li>Passing slices of state and functions to dispatch actions down to <code>WrappedComponent</code> using props.</li>
</ul>
<h3 id="comparing-nested-arrow-functions-to-regular-functions">Comparing nested arrow functions to regular functions</h3>
<p>As you saw earlier in this article, higher-order functions can be written using arrow functions or regular functions. The <code>connect</code> higher-order function can be written using arrow functions and implicit return statements:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> connect <span class="op">=</span> (mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="kw">=&gt;</span> (WrappedComponent) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb9-5" title="5">)<span class="op">;</span></a></code></pre></div>
<p>Or can be rewritten using regular functions and explicit return statements:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">function</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="cf">return</span> <span class="kw">function</span>(WrappedComponent) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-3" title="3">    <span class="cf">return</span> <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-4" title="4">      <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb10-5" title="5">    <span class="op">};</span></a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="op">};</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="op">};</span></a></code></pre></div>
<p>The arrow function syntax, while concise, can be confusing to read.</p>
<h3 id="dynamically-setting-component-attributes">Dynamically setting component attributes</h3>
<p>The <code>connect</code> function’s <code>mapStateToProps</code> and <code>mapDispatchToProps</code> parameters are both functions that are called within the anonymous class’ <code>render</code> method:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">const</span> connect <span class="op">=</span> (mapStateToProps<span class="op">,</span> mapDispatchToProps) <span class="kw">=&gt;</span> (WrappedComponent) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw">class</span> <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb11-3" title="3">    <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb11-4" title="4">      <span class="kw">let</span> stateProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb11-5" title="5">      <span class="cf">if</span> (mapStateToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-6" title="6">        stateProps <span class="op">=</span> <span class="at">mapStateToProps</span>(<span class="va">store</span>.<span class="at">getState</span>()<span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-7" title="7">      <span class="op">}</span></a>
<a class="sourceLine" id="cb11-8" title="8"></a>
<a class="sourceLine" id="cb11-9" title="9">      <span class="kw">let</span> dispatchProps <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb11-10" title="10">      <span class="cf">if</span> (mapDispatchToProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-11" title="11">        dispatchProps <span class="op">=</span> <span class="at">mapDispatchToProps</span>(<span class="va">store</span>.<span class="at">dispatch</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">props</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-12" title="12">      <span class="op">}</span></a>
<a class="sourceLine" id="cb11-13" title="13"></a>
<a class="sourceLine" id="cb11-14" title="14">      <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb11-15" title="15">    <span class="op">}</span></a>
<a class="sourceLine" id="cb11-16" title="16"></a>
<a class="sourceLine" id="cb11-17" title="17">    <span class="co">// Code removed for brevity.</span></a>
<a class="sourceLine" id="cb11-18" title="18">  <span class="op">}</span></a>
<a class="sourceLine" id="cb11-19" title="19">)<span class="op">;</span></a></code></pre></div>
<p>The Redux store’s current state, retrieved using <code>store.getState</code>, is passed to the <code>mapStateToProps</code> function and the store’s <code>dispatch</code> method is passed to the <code>mapDispatchToProps</code> function. The <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions also receive the anonymous class component’s props (via <code>this.props</code>).</p>
<p>But what are the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions exactly? To answer that question, take a look at an example of using the <code>connect</code> function to define the <code>FruitManagerContainer</code> component:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="co">// ./src/components/FruitManagerContainer.js</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="im">import</span> connect <span class="im">from</span> <span class="st">&#39;../connect&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="im">import</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-5" title="5">  addFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb12-6" title="6">  addFruits<span class="op">,</span></a>
<a class="sourceLine" id="cb12-7" title="7">  sellFruit<span class="op">,</span></a>
<a class="sourceLine" id="cb12-8" title="8">  sellOut<span class="op">,</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/fruitActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="im">import</span> FruitManager <span class="im">from</span> <span class="st">&#39;./FruitManager&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-11" title="11"></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb12-13" title="13">  <span class="dt">fruit</span><span class="op">:</span> <span class="va">state</span>.<span class="at">fruit</span><span class="op">,</span></a>
<a class="sourceLine" id="cb12-14" title="14">  <span class="dt">distinctFruit</span><span class="op">:</span> <span class="va">Array</span>.<span class="at">from</span>(<span class="kw">new</span> <span class="at">Set</span>(<span class="va">state</span>.<span class="at">fruit</span>)).<span class="at">sort</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-16" title="16"></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> (dispatch) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb12-18" title="18">  <span class="dt">add</span><span class="op">:</span> (fruit) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addFruit</span>(fruit))<span class="op">,</span></a>
<a class="sourceLine" id="cb12-19" title="19">  <span class="dt">addBulk</span><span class="op">:</span> (fruit) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addFruits</span>(fruit))<span class="op">,</span></a>
<a class="sourceLine" id="cb12-20" title="20">  <span class="dt">sell</span><span class="op">:</span> (fruit) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">sellFruit</span>(fruit))<span class="op">,</span></a>
<a class="sourceLine" id="cb12-21" title="21">  <span class="dt">sellAll</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">sellOut</span>())<span class="op">,</span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-23" title="23"></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb12-25" title="25">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb12-26" title="26">  mapDispatchToProps</a>
<a class="sourceLine" id="cb12-27" title="27">)(FruitManager)<span class="op">;</span></a></code></pre></div>
<p><code>mapStateToProps</code> is a function that accepts store’s current state and returns an object that maps state data to one or more properties. <code>mapDispatchToProps</code> is also a function, but it accepts the store’s <code>dispatch</code> method and returns an object whose properties are set to functions that can be called dispatch actions to the store.</p>
<p>In the <code>connect</code> function, <code>Object.assign</code> is then used to combine the <code>stateProps</code> and <code>dispatchProps</code> objects with <code>this.props</code> (the anonymous class component’s props):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">const</span> propsToSpread <span class="op">=</span> <span class="va">Object</span>.<span class="at">assign</span>(<span class="op">{},</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">,</span> stateProps<span class="op">,</span> dispatchProps)<span class="op">;</span></a></code></pre></div>
<p>Then the properties defined on the <code>propsToSpread</code> object become props on <code>WrappedComponent</code> using JSX spread attribute syntax (<code>...</code>):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="cf">return</span> (</a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="op">&lt;</span>WrappedComponent <span class="op">{</span>...<span class="at">propsToSpread</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb14-3" title="3">)<span class="op">;</span></a></code></pre></div>
<p>Within the <code>FruitManager</code> component (the component that the <code>connect</code> function’s <code>WrappedComponent</code> is wrapping), parameter destructuring is used to reference the props provided by the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions. These props are then passed as props to the appropriate child presentational component:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="co">// ./src/components/FruitManager.js</span></a>
<a class="sourceLine" id="cb15-2" title="2"></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="im">import</span> FruitList <span class="im">from</span> <span class="st">&#39;./FruitList&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="im">import</span> FruitSeller <span class="im">from</span> <span class="st">&#39;./FruitSeller&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="im">import</span> FruitQuickAdd <span class="im">from</span> <span class="st">&#39;./FruitQuickAdd&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="im">import</span> FruitBulkAdd <span class="im">from</span> <span class="st">&#39;./FruitBulkAdd&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb15-8" title="8"></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw">const</span> FruitManager <span class="op">=</span> (<span class="op">{</span> fruit<span class="op">,</span> distinctFruit<span class="op">,</span> add<span class="op">,</span> addBulk<span class="op">,</span> sell<span class="op">,</span> sellAll <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb15-11" title="11">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-12" title="12">      <span class="op">&lt;</span>h2<span class="op">&gt;</span>Available Fruit&lt;/h2<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-13" title="13">      <span class="op">&lt;</span>FruitList fruit<span class="op">={</span>fruit<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-14" title="14">      <span class="op">&lt;</span>h2<span class="op">&gt;</span>Fruit Inventory Manager&lt;/h2<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-15" title="15">      <span class="op">&lt;</span>FruitSeller distinctFruit<span class="op">={</span>distinctFruit<span class="op">}</span> sell<span class="op">={</span>sell<span class="op">}</span> sellAll<span class="op">={</span>sellAll<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-16" title="16">      <span class="op">&lt;</span>FruitQuickAdd add<span class="op">={</span>add<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-17" title="17">      <span class="op">&lt;</span>FruitBulkAdd addBulk<span class="op">={</span>addBulk<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb15-18" title="18">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-19" title="19">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-21" title="21"></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="im">export</span> <span class="im">default</span> FruitManager<span class="op">;</span></a></code></pre></div>
<p>Visualizing the flow of data all the from the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> function definitions within the <code>FruitManagerContainer.js</code> file through the <code>connect</code> higher-order component down to the <code>FruitManager</code> wrapped component is <strong>difficult to do</strong>. Understanding how to use React’s ability to dynamically set component attributes using JSX spread attribute syntax is <strong>one of the more challenging aspects of writing higher-order components</strong>.</p>
<p><strong>Just remember that you don’t need to fully understand the above example to use the <code>connect</code> function provided by the <a href="https://react-redux.js.org/">React-Redux</a> library.</strong></p>
<h2 id="reviewing-a-completed-fruit-stand-example">Reviewing a completed Fruit Stand example</h2>
<p>To review and run a completed Fruit Stand example application that utilizes the above <em>custom</em> <code>connect</code> higher-order component to create container components, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>fruit-stand-redux-with-react-generic-container</code> folder. Run the command <code>npm install</code> to install the project’s dependencies. Then use the command <code>npm start</code> to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the Create React App tooling. When running the application using <code>npm start</code>, the application should automatically open in your default browser. If it doesn’t, you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 id="what-you-learned">What you learned</h2>
<p>In this article, you learned about higher-order components (HOCs) including how to write a higher-order component that accepts a component as an argument and returns a new component.</p>
<hr />
<h1 id="react-redux-provider">React-Redux: <code>&lt;Provider/&gt;</code></h1>
<p>As you learned in earlier articles, the integration techniques that you were initially shown were just a starting point with using Redux with React. Now that you’ve learned the basics of how React components interact with a Redux store, it’s time to learn how you can use <a href="https://react-redux.js.org/">React-Redux</a>, a library from the creators of <a href="https://redux.js.org/">Redux</a>, to improve upon those techniques.</p>
<p>To prepare to use the <code>connect</code> function from the <a href="https://react-redux.js.org/">React-Redux library</a>, you need to first add a <code>&lt;Provider /&gt;</code> component to your React application. When you finish this article, you should be able to use the <code>&lt;Provider /&gt;</code> component to make your Redux store available to any nested components that have been wrapped in the <code>connect</code> function.</p>
<h2 id="understanding-the-advantages-of-the-provider-component">Understanding the advantages of the <code>&lt;Provider /&gt;</code> component</h2>
<p>Oftentimes, a deeply nested component will need access to the store, while its parents do not. Using vanilla React, these parents would have to receive the <code>store</code> prop in order to pass it down to its child.</p>
<p>Consider the example below:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="co">// App.js</span></a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-4" title="4"></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw">const</span> UserInfo <span class="op">=</span> (<span class="op">{</span> store <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb16-6" title="6">  <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb16-7" title="7">    <span class="op">{</span><span class="va">store</span>.<span class="at">getState</span>().<span class="at">username</span><span class="op">}</span></a>
<a class="sourceLine" id="cb16-8" title="8">  &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb16-9" title="9">)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-10" title="10"></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="kw">const</span> Header <span class="op">=</span> (<span class="op">{</span> store <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb16-12" title="12">  <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb16-13" title="13">    <span class="op">&lt;</span>UserInfo store<span class="op">={</span>store<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb16-14" title="14">  &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb16-15" title="15">)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-16" title="16"></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="kw">const</span> App <span class="op">=</span> (<span class="op">{</span> store <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb16-18" title="18">  <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb16-19" title="19">    <span class="op">&lt;</span>Header store<span class="op">={</span>store<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb16-20" title="20">  &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb16-21" title="21">)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-22" title="22"></a>
<a class="sourceLine" id="cb16-23" title="23"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="co">// index.js</span></a>
<a class="sourceLine" id="cb17-2" title="2"></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="im">import</span> <span class="op">{</span> createStore <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="im">import</span> reducer <span class="im">from</span> <span class="st">&#39;./reducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="im">import</span> App <span class="im">from</span> <span class="st">&#39;./App&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-9" title="9"></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(reducer)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-11" title="11"></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="op">&lt;</span><span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb17-14" title="14">    <span class="op">&lt;</span>App store<span class="op">={</span>store<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb17-15" title="15">  &lt;/<span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb17-16" title="16">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb17-17" title="17">)<span class="op">;</span></a></code></pre></div>
<p>The <code>store</code> is created in the <code>index.js</code> file, but the <code>UserInfo</code> component that needs to access it is deeply nested. Thus, the store must be passed as a prop down the entire component tree, even though components such as the <code>Header</code> do not need to access the store.</p>
<p>This pattern, called <strong>prop threading</strong>, is tedious and error-prone. You can avoid it by using the <code>&lt;Provider /&gt;</code>/<code>connect</code> API provided by React-Redux.</p>
<h3 id="preparing-your-react-application-for-server-side-rendering">Preparing your React application for server-side rendering</h3>
<p>Using <code>&lt;Provider /&gt;</code> also helps to prepare your React/Redux application to utilize server-side rendering. Server-side rendering allows you to render components to static markup, which can help to reduce the initial loading time of your application.</p>
<blockquote>
<p>React server-side rendering is an advanced topic that won’t be covered in this course. For more information, see the official <a href="https://reactjs.org/docs/react-dom-server.html">React</a> and <a href="https://redux.js.org/recipes/server-rendering">Redux</a> docs.</p>
</blockquote>
<h2 id="adding-provider">Adding <code>&lt;Provider /&gt;</code></h2>
<p>Before adding <code>&lt;Provider /&gt;</code> to your React application, use npm to install the <code>react-redux</code> package:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb18-1" title="1"><span class="ex">npm</span> install react-redux</a></code></pre></div>
<p>Then, in the entry point for your application (typically the <code>index.js</code> file), import the <code>Provider</code> component and your Redux <code>store</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Then use the <code>Provider</code> component to wrap your <code>App</code> component and set its <code>store</code> prop to your Redux <code>store</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="op">&lt;</span>App /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb20-3" title="3">&lt;/Provider<span class="op">&gt;</span></a></code></pre></div>
<p>Here’s what your completed <code>index.js</code> file will look like:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="co">// ./src/index.js</span></a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="im">import</span> <span class="st">&#39;./index.css&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="im">import</span> App <span class="im">from</span> <span class="st">&#39;./App&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="im">import</span> store <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-9" title="9"></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb21-11" title="11">  <span class="op">&lt;</span><span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb21-12" title="12">    <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb21-13" title="13">      <span class="op">&lt;</span>App /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb21-14" title="14">    &lt;/Provider<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb21-15" title="15">  &lt;/<span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb21-16" title="16">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb21-17" title="17">)<span class="op">;</span></a></code></pre></div>
<p><code>&lt;Provider /&gt;</code> is simply a React component in which you wrap the rest of the application. The <code>Provider</code> component receives the <code>store</code> as a <code>prop</code> and sets a store <code>context</code>. Because you wrapped the entire <code>App</code> in the <code>Provider</code> component, all your components can access the store <code>context</code>.</p>
<p>Components that need to access the store <code>context</code> have to be wrapped in a container component created by the <code>connect</code> function, which converts the store <code>context</code> into a <code>store</code> prop. You’ll learn how to use the <code>connect</code> function in the next article.</p>
<h2 id="understanding-how-provider-relates-to-the-react-context-api">Understanding how <code>&lt;Provider /&gt;</code> relates to the React Context API</h2>
<p>The store <code>context</code> set by <code>&lt;Provider /&gt;</code> is the <em>same</em> React Context that you used in an earlier lesson to manage global state within a React application. You can see this in action by reviewing the <code>react-redux</code> source code on GitHub:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="co">// https://github.com/reduxjs/react-redux/blob/master/src/components/Context.js</span></a>
<a class="sourceLine" id="cb22-2" title="2"></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span></a>
<a class="sourceLine" id="cb22-4" title="4"></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="im">export</span> <span class="kw">const</span> ReactReduxContext <span class="op">=</span> <span class="co">/*#__PURE__*/</span> <span class="va">React</span>.<span class="at">createContext</span>(<span class="kw">null</span>)</a>
<a class="sourceLine" id="cb22-6" title="6"></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="cf">if</span> (<span class="va">process</span>.<span class="va">env</span>.<span class="at">NODE_ENV</span> <span class="op">!==</span> <span class="st">&#39;production&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-8" title="8">  <span class="va">ReactReduxContext</span>.<span class="at">displayName</span> <span class="op">=</span> <span class="st">&#39;ReactRedux&#39;</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="op">}</span></a>
<a class="sourceLine" id="cb22-10" title="10"></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="im">export</span> <span class="im">default</span> ReactReduxContext</a></code></pre></div>
<p>And while it’s rarely used, it’s possible to import the context from React-Redux and use the <code>&lt;Consumer /&gt;</code> to access the <code>store</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="im">import</span> <span class="op">{</span> ReactReduxContext <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb23-2" title="2"></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="co">// in your connected component</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb23-5" title="5">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb23-6" title="6">    <span class="op">&lt;</span><span class="va">ReactReduxContext</span>.<span class="at">Consumer</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb23-7" title="7">      <span class="op">{</span>(<span class="op">{</span> store <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-8" title="8">        <span class="co">// do something with the store here</span></a>
<a class="sourceLine" id="cb23-9" title="9">      <span class="op">}}</span></a>
<a class="sourceLine" id="cb23-10" title="10">    &lt;/<span class="va">ReactReduxContext</span>.<span class="at">Consumer</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb23-11" title="11">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="op">}</span></a></code></pre></div>
<p>You can also connect the Redux <code>&lt;Provider /&gt;</code> component to the <code>&lt;Context.Provider /&gt;</code> component that passes the <code>value</code> of a context object to all child components. Redux’s <code>&lt;Provider /&gt;</code> component simply passes the Redux <code>store</code>, instead of a context <code>value</code>.</p>
<h2 id="what-you-learned-1">What you learned</h2>
<p>In this article, you learned how to use the <code>&lt;Provider /&gt;</code> component to make your Redux store available to any nested components that have been wrapped in the <code>connect</code> function.</p>
<hr />
<h1 id="react-redux-connect-1">React-Redux: <code>connect()</code></h1>
<p>The React-Redux library allows you to access the store <code>context</code> set by the <code>&lt;Provider /&gt;</code> in a powerful and convenient way via the <code>connect</code> function. Using <code>connect</code>, you can pass specific slices of the store’s state and specific action-dispatches to a React component as <code>props</code>. A component’s <code>props</code> then serve as its API to the store, making the component more modular and less burdened by Redux boilerplate.</p>
<p>When you finish this article, you should be able to use the <code>connect</code> function to give a component access to a Redux store.</p>
<h2 id="calling-connect">Calling <code>connect</code></h2>
<p>The React-Redux <code>connect</code> function is a <em>higher-order function</em>. It takes two arguments (plus a couple optional arguments you can read more about in the <a href="https://react-redux.js.org/using-react-redux/connect-mapstate#ownprops-optional">docs</a>) and returns a function:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">const</span> createConnectedComponent <span class="op">=</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb24-2" title="2">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb24-3" title="3">  mapDispatchToProps</a>
<a class="sourceLine" id="cb24-4" title="4">)<span class="op">;</span></a></code></pre></div>
<p>The returned function (<code>createConnectedComponent</code>) then takes the React component that needs access to the Redux store and returns a new React component:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">createConnectedComponent</span>(MyComponent)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-2" title="2"></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="im">export</span> <span class="im">default</span> ConnectedComponent<span class="op">;</span></a></code></pre></div>
<p><code>ConnectedComponent</code> will render <code>MyComponent</code>, passing along <code>props</code> as determined by the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> arguments.</p>
<p>You can combine these function calls into a single statement by immediately calling the function returned by the <code>connect</code> method (similarly to how you immediately call a function expression when defining an <a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a>):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(MyComponent)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-2" title="2"></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="im">export</span> <span class="im">default</span> ConnectedComponent<span class="op">;</span></a></code></pre></div>
<p>Typically, to keep things as concise as possible, the <code>ConnectedComponent</code> variable is omitted:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<h2 id="defining-mapstatetopropsstate-ownprops">Defining <code>mapStateToProps(state, [ownProps])</code></h2>
<p>This first argument to <code>connect</code> is a function, <code>mapStateToProps</code>. It tells <code>connect</code> how to map the <code>state</code> into your component’s <code>props</code>.</p>
<p>It must take as an argument the store’s <code>state</code> (supplied by the <code>Provider</code>’s store <code>context</code>) and return an object containing the relevant <code>props</code> for your component.</p>
<pre class="jsx"><code>const MyComponent = ({ name }) =&gt; (
  &lt;div&gt;{name}&lt;/div&gt;
);

const mapStateToProps = (state) =&gt; ({
  name: state.name;
});

const ConnectedComponent = connect(mapStateToProps)(MyComponent);</code></pre>
<p>In the example above, <code>ConnectedComponent</code> will render <code>MyComponent</code>, passing <code>name</code> as a prop.</p>
<h3 id="ownprops-optional"><code>ownProps</code> (optional)</h3>
<p>A component with explicit <code>props</code> passed down from its parent (e.g. <code>&lt;ConnectedComponent lastName={'Wozniak'}/&gt;</code>) can merge those <code>props</code> with slices of <code>state</code> via <code>ownProps</code>, a optional second argument to <code>mapStateToProps</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb29-2" title="2">  <span class="dt">firstName</span><span class="op">:</span> <span class="va">state</span>.<span class="at">name</span><span class="op">,</span></a>
<a class="sourceLine" id="cb29-3" title="3">  <span class="dt">initials</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="va">state</span>.<span class="at">name</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">. </span><span class="sc">${</span><span class="va">ownProps</span>.<span class="at">lastName</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">.`</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb29-5" title="5"></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(mapStateToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<p>You can also access React Router props, such <code>match</code> and <code>history</code> through <code>ownProps</code>. Imagine you have a <code>users</code> slice of state, and you want to pass a specific user’s <code>name</code> based on a <code>:userId</code> parameter. You can access the parameter from within the <code>mapStateToProps</code> function with <code>ownProps.match.params.userId</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb30-2" title="2">  <span class="dt">name</span><span class="op">:</span> <span class="va">state</span>.<span class="at">users</span>[<span class="va">ownProps</span>.<span class="va">match</span>.<span class="va">params</span>.<span class="at">userId</span>].<span class="at">name</span><span class="op">,</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb30-4" title="4"></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(mapStateToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<h2 id="defining-mapdispatchtoprops">Defining <code>mapDispatchToProps</code></h2>
<p><code>mapDispatchToProps</code> is the second argument to <code>connect</code>. It’s a function that accepts the store’s <code>dispatch</code> method and returns an object containing functions that can be called to dispatch actions to the store. These action dispatchers are then passed as <code>props</code> to the component.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">const</span> deleteTodo <span class="op">=</span> (id) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;DELETE_TODO&#39;</span><span class="op">,</span> id <span class="op">}</span>)<span class="op">;</span> <span class="co">// action creators</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">const</span> addTodo <span class="op">=</span> (msg) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;ADD_TODO&#39;</span><span class="op">,</span> msg <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> (dispatch) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb31-5" title="5">  <span class="dt">handleDelete</span><span class="op">:</span> (id) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">deleteTodo</span>(id))<span class="op">,</span></a>
<a class="sourceLine" id="cb31-6" title="6">  <span class="dt">handleAdd</span><span class="op">:</span> (msg) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addTodo</span>(msg))</a>
<a class="sourceLine" id="cb31-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb31-8" title="8"></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(<span class="kw">null</span><span class="op">,</span> mapDispatchToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<p>Notice that in the example above, the <code>connect</code> function is invoked with <code>null</code> as a placeholder for the <code>mapStateToProps</code> function. The <code>connect</code> function expects <code>mapStateToProps</code> as its first argument and <code>mapDispatchToProps</code> as its second argument.</p>
<h2 id="putting-it-all-together">Putting it all together</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">const</span> MyComponent <span class="op">=</span> (<span class="op">{</span> firstName<span class="op">,</span> initials<span class="op">,</span> handleAdd<span class="op">,</span> handleDelete <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb32-2" title="2">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>...&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="op">};</span></a>
<a class="sourceLine" id="cb32-4" title="4"></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb32-6" title="6">  <span class="dt">firstName</span><span class="op">:</span> <span class="va">state</span>.<span class="at">name</span><span class="op">,</span></a>
<a class="sourceLine" id="cb32-7" title="7">  <span class="dt">initials</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="va">state</span>.<span class="at">name</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">. </span><span class="sc">${</span><span class="va">ownProps</span>.<span class="at">lastName</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">.`</span></a>
<a class="sourceLine" id="cb32-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb32-9" title="9"></a>
<a class="sourceLine" id="cb32-10" title="10"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> (dispatch) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb32-11" title="11">  <span class="dt">handleDelete</span><span class="op">:</span> (id) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">deleteTodo</span>(id))<span class="op">,</span></a>
<a class="sourceLine" id="cb32-12" title="12">  <span class="dt">handleAdd</span><span class="op">:</span> (msg) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addTodo</span>(msg))</a>
<a class="sourceLine" id="cb32-13" title="13"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb32-14" title="14"></a>
<a class="sourceLine" id="cb32-15" title="15"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb32-16" title="16">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb32-17" title="17">  mapDispatchToProps</a>
<a class="sourceLine" id="cb32-18" title="18">)(MyComponent)<span class="op">;</span></a></code></pre></div>
<p><code>MyComponent</code> will receive <code>firstName</code>, <code>initials</code>, <code>handleDelete</code>, and <code>handleAdd</code> as <code>props</code>.</p>
<p>And remember, unlike the earlier attempt at writing a custom <code>connect</code> higher-order component, the React-Redux library’s <code>connect</code> function <strong>contains logic to optimize the rendering of your connected components</strong>.</p>
<h2 id="reviewing-a-completed-fruit-stand-example-1">Reviewing a completed Fruit Stand example</h2>
<p>To review and run a completed Fruit Stand example application that utilizes the React-Redux library, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>fruit-stand-redux-with-react-official-bindings</code> folder. Run the command <code>npm install</code> to install the project’s dependencies. Then use the command <code>npm start</code> to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the Create React App tooling. When running the application using <code>npm start</code>, the application should automatically open in your default browser. If it doesn’t, you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 id="what-you-learned-2">What you learned</h2>
<p>In this article, you learned how to use the React-Redux library’s <code>connect</code> function to give a component access to a Redux store.</p>
<hr />
<h1 id="react-redux-connect-2">React-Redux: <code>connect()</code></h1>
<p>The React-Redux library allows you to access the store <code>context</code> set by the <code>&lt;Provider /&gt;</code> in a powerful and convenient way via the <code>connect</code> function. Using <code>connect</code>, you can pass specific slices of the store’s state and specific action-dispatches to a React component as <code>props</code>. A component’s <code>props</code> then serve as its API to the store, making the component more modular and less burdened by Redux boilerplate.</p>
<p>When you finish this article, you should be able to use the <code>connect</code> function to give a component access to a Redux store.</p>
<h2 id="calling-connect-1">Calling <code>connect</code></h2>
<p>The React-Redux <code>connect</code> function is a <em>higher-order function</em>. It takes two arguments (plus a couple optional arguments you can read more about in the <a href="https://react-redux.js.org/using-react-redux/connect-mapstate#ownprops-optional">docs</a>) and returns a function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">const</span> createConnectedComponent <span class="op">=</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb33-2" title="2">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb33-3" title="3">  mapDispatchToProps</a>
<a class="sourceLine" id="cb33-4" title="4">)<span class="op">;</span></a></code></pre></div>
<p>The returned function (<code>createConnectedComponent</code>) then takes the React component that needs access to the Redux store and returns a new React component:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">createConnectedComponent</span>(MyComponent)<span class="op">;</span></a>
<a class="sourceLine" id="cb34-2" title="2"></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="im">export</span> <span class="im">default</span> ConnectedComponent<span class="op">;</span></a></code></pre></div>
<p><code>ConnectedComponent</code> will render <code>MyComponent</code>, passing along <code>props</code> as determined by the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> arguments.</p>
<p>You can combine these function calls into a single statement by immediately calling the function returned by the <code>connect</code> method (similarly to how you immediately call a function expression when defining an <a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a>):</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(MyComponent)<span class="op">;</span></a>
<a class="sourceLine" id="cb35-2" title="2"></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="im">export</span> <span class="im">default</span> ConnectedComponent<span class="op">;</span></a></code></pre></div>
<p>Typically, to keep things as concise as possible, the <code>ConnectedComponent</code> variable is omitted:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb36-1" title="1"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<h2 id="defining-mapstatetopropsstate-ownprops-1">Defining <code>mapStateToProps(state, [ownProps])</code></h2>
<p>This first argument to <code>connect</code> is a function, <code>mapStateToProps</code>. It tells <code>connect</code> how to map the <code>state</code> into your component’s <code>props</code>.</p>
<p>It must take as an argument the store’s <code>state</code> (supplied by the <code>Provider</code>’s store <code>context</code>) and return an object containing the relevant <code>props</code> for your component.</p>
<pre class="jsx"><code>const MyComponent = ({ name }) =&gt; (
  &lt;div&gt;{name}&lt;/div&gt;
);

const mapStateToProps = (state) =&gt; ({
  name: state.name;
});

const ConnectedComponent = connect(mapStateToProps)(MyComponent);</code></pre>
<p>In the example above, <code>ConnectedComponent</code> will render <code>MyComponent</code>, passing <code>name</code> as a prop.</p>
<h3 id="ownprops-optional-1"><code>ownProps</code> (optional)</h3>
<p>A component with explicit <code>props</code> passed down from its parent (e.g. <code>&lt;ConnectedComponent lastName={'Wozniak'}/&gt;</code>) can merge those <code>props</code> with slices of <code>state</code> via <code>ownProps</code>, a optional second argument to <code>mapStateToProps</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb38-2" title="2">  <span class="dt">firstName</span><span class="op">:</span> <span class="va">state</span>.<span class="at">name</span><span class="op">,</span></a>
<a class="sourceLine" id="cb38-3" title="3">  <span class="dt">initials</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="va">state</span>.<span class="at">name</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">. </span><span class="sc">${</span><span class="va">ownProps</span>.<span class="at">lastName</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">.`</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb38-5" title="5"></a>
<a class="sourceLine" id="cb38-6" title="6"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(mapStateToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<p>You can also access React Router props, such <code>match</code> and <code>history</code> through <code>ownProps</code>. Imagine you have a <code>users</code> slice of state, and you want to pass a specific user’s <code>name</code> based on a <code>:userId</code> parameter. You can access the parameter from within the <code>mapStateToProps</code> function with <code>ownProps.match.params.userId</code>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb39-2" title="2">  <span class="dt">name</span><span class="op">:</span> <span class="va">state</span>.<span class="at">users</span>[<span class="va">ownProps</span>.<span class="va">match</span>.<span class="va">params</span>.<span class="at">userId</span>].<span class="at">name</span><span class="op">,</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb39-4" title="4"></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(mapStateToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<h2 id="defining-mapdispatchtoprops-1">Defining <code>mapDispatchToProps</code></h2>
<p><code>mapDispatchToProps</code> is the second argument to <code>connect</code>. It’s a function that accepts the store’s <code>dispatch</code> method and returns an object containing functions that can be called to dispatch actions to the store. These action dispatchers are then passed as <code>props</code> to the component.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">const</span> deleteTodo <span class="op">=</span> (id) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;DELETE_TODO&#39;</span><span class="op">,</span> id <span class="op">}</span>)<span class="op">;</span> <span class="co">// action creators</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">const</span> addTodo <span class="op">=</span> (msg) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;ADD_TODO&#39;</span><span class="op">,</span> msg <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-3" title="3"></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> (dispatch) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb40-5" title="5">  <span class="dt">handleDelete</span><span class="op">:</span> (id) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">deleteTodo</span>(id))<span class="op">,</span></a>
<a class="sourceLine" id="cb40-6" title="6">  <span class="dt">handleAdd</span><span class="op">:</span> (msg) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addTodo</span>(msg))</a>
<a class="sourceLine" id="cb40-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-8" title="8"></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="kw">const</span> ConnectedComponent <span class="op">=</span> <span class="at">connect</span>(<span class="kw">null</span><span class="op">,</span> mapDispatchToProps)(MyComponent)<span class="op">;</span></a></code></pre></div>
<p>Notice that in the example above, the <code>connect</code> function is invoked with <code>null</code> as a placeholder for the <code>mapStateToProps</code> function. The <code>connect</code> function expects <code>mapStateToProps</code> as its first argument and <code>mapDispatchToProps</code> as its second argument.</p>
<h2 id="putting-it-all-together-1">Putting it all together</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">const</span> MyComponent <span class="op">=</span> (<span class="op">{</span> firstName<span class="op">,</span> initials<span class="op">,</span> handleAdd<span class="op">,</span> handleDelete <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb41-2" title="2">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>...&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="op">};</span></a>
<a class="sourceLine" id="cb41-4" title="4"></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb41-6" title="6">  <span class="dt">firstName</span><span class="op">:</span> <span class="va">state</span>.<span class="at">name</span><span class="op">,</span></a>
<a class="sourceLine" id="cb41-7" title="7">  <span class="dt">initials</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="va">state</span>.<span class="at">name</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">. </span><span class="sc">${</span><span class="va">ownProps</span>.<span class="at">lastName</span>[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">.`</span></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb41-9" title="9"></a>
<a class="sourceLine" id="cb41-10" title="10"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> (dispatch) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb41-11" title="11">  <span class="dt">handleDelete</span><span class="op">:</span> (id) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">deleteTodo</span>(id))<span class="op">,</span></a>
<a class="sourceLine" id="cb41-12" title="12">  <span class="dt">handleAdd</span><span class="op">:</span> (msg) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">addTodo</span>(msg))</a>
<a class="sourceLine" id="cb41-13" title="13"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb41-14" title="14"></a>
<a class="sourceLine" id="cb41-15" title="15"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb41-16" title="16">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb41-17" title="17">  mapDispatchToProps</a>
<a class="sourceLine" id="cb41-18" title="18">)(MyComponent)<span class="op">;</span></a></code></pre></div>
<p><code>MyComponent</code> will receive <code>firstName</code>, <code>initials</code>, <code>handleDelete</code>, and <code>handleAdd</code> as <code>props</code>.</p>
<p>And remember, unlike the earlier attempt at writing a custom <code>connect</code> higher-order component, the React-Redux library’s <code>connect</code> function <strong>contains logic to optimize the rendering of your connected components</strong>.</p>
<h2 id="reviewing-a-completed-fruit-stand-example-2">Reviewing a completed Fruit Stand example</h2>
<p>To review and run a completed Fruit Stand example application that utilizes the React-Redux library, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>fruit-stand-redux-with-react-official-bindings</code> folder. Run the command <code>npm install</code> to install the project’s dependencies. Then use the command <code>npm start</code> to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the Create React App tooling. When running the application using <code>npm start</code>, the application should automatically open in your default browser. If it doesn’t, you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 id="what-you-learned-3">What you learned</h2>
<p>In this article, you learned how to use the React-Redux library’s <code>connect</code> function to give a component access to a Redux store.</p>
<hr />
<h1 id="selectors">Selectors</h1>
<p>Selectors are functions used to extract and format information from the application state in different forms. When you finish this article, you should be able to write a selector to extract and format information from state stored in a Redux store.</p>
<h2 id="writing-a-selector">Writing a selector</h2>
<p>Here’s a sample state tree from the Fruit Stand React/Redux application:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb42-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb42-2" title="2">  <span class="dt">fruit</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb42-3" title="3">    <span class="st">&#39;APPLE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-4" title="4">    <span class="st">&#39;APPLE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-5" title="5">    <span class="st">&#39;ORANGE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-6" title="6">    <span class="st">&#39;GRAPEFRUIT&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-7" title="7">    <span class="st">&#39;WATERMELON&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-8" title="8">  ]<span class="op">,</span></a>
<a class="sourceLine" id="cb42-9" title="9">  <span class="dt">farmers</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb42-10" title="10">    <span class="dv">1</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb42-11" title="11">      <span class="dt">id</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-12" title="12">      <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;John Smith&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-13" title="13">      <span class="dt">paid</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-14" title="14">    <span class="op">},</span></a>
<a class="sourceLine" id="cb42-15" title="15">    <span class="dv">2</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb42-16" title="16">      <span class="dt">id</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-17" title="17">      <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Sally Jones&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-18" title="18">      <span class="dt">paid</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-19" title="19">    <span class="op">},</span></a>
<a class="sourceLine" id="cb42-20" title="20">  <span class="op">}</span></a>
<a class="sourceLine" id="cb42-21" title="21"><span class="op">}</span></a></code></pre></div>
<p>The state’s <code>farmers</code> are stored as an object. Keys correspond to <code>farmer.id</code>s and values correspond to <code>farmer</code> objects. This yields O(1) for the lookup of a single farmer. However, storing all the farmers as values of an object makes it slightly inconvenient to obtain and render them all at once. To solve this inconvenience, we use selectors.</p>
<p>Selectors are typically defined in a file that sits next to the reducer for its slice of state. For example, if the <code>farmers</code> state slice is managed by the reducer defined in <code>./src/reducers/farmersReducer.js</code>, then the farmers selectors would be stored in a file at <code>./src/reducers/farmersSelectors.js</code>.</p>
<p>Selectors are passed the application’s <code>state</code> and return information from the state in a specified form (e.g. an array). You can use selectors to format different slice(s) of the state by calling them in a container’s <code>mapStateToProps</code>.</p>
<p>For example, <code>getAllFarmers</code> returns all the farmers stored in the state as an array of <code>farmer</code> objects, making it easier to iterate over and render each one.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb43-1" title="1"><span class="co">// ./src/reducers/farmersSelectors.js</span></a>
<a class="sourceLine" id="cb43-2" title="2"></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="im">export</span> <span class="kw">const</span> getAllFarmers <span class="op">=</span> (<span class="op">{</span> farmers <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb43-4" title="4">  <span class="va">Object</span>.<span class="at">values</span>(farmers)</a>
<a class="sourceLine" id="cb43-5" title="5">)<span class="op">;</span></a></code></pre></div>
<p>A selector can be used in multiple components’ <code>mapStateToProps</code>. For example:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb44-1" title="1"><span class="co">// ./src/components/FarmerManagerContainer.js</span></a>
<a class="sourceLine" id="cb44-2" title="2"></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="im">import</span> <span class="op">{</span> getAllFarmers <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../reducers/farmersSelectors&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb44-4" title="4"></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb44-6" title="6">  <span class="dt">farmers</span><span class="op">:</span> <span class="at">getAllFarmers</span>(state)<span class="op">,</span></a>
<a class="sourceLine" id="cb44-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Selectors are passed the entire application <code>state</code> so they can utilize multiple slices of the application state to assemble data. For example, if the Fruit Stand application’s state tree included a <code>filter</code> state slice:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb45-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb45-2" title="2">  <span class="dt">fruit</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb45-3" title="3">    <span class="st">&#39;APPLE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-4" title="4">    <span class="st">&#39;APPLE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-5" title="5">    <span class="st">&#39;ORANGE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-6" title="6">    <span class="st">&#39;GRAPEFRUIT&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-7" title="7">    <span class="st">&#39;WATERMELON&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-8" title="8">  ]<span class="op">,</span></a>
<a class="sourceLine" id="cb45-9" title="9">  <span class="dt">farmers</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb45-10" title="10">    <span class="dv">1</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb45-11" title="11">      <span class="dt">id</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-12" title="12">      <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;John Smith&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-13" title="13">      <span class="dt">paid</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-14" title="14">    <span class="op">},</span></a>
<a class="sourceLine" id="cb45-15" title="15">    <span class="dv">2</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb45-16" title="16">      <span class="dt">id</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-17" title="17">      <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Sally Jones&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-18" title="18">      <span class="dt">paid</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb45-19" title="19">    <span class="op">},</span></a>
<a class="sourceLine" id="cb45-20" title="20">  <span class="op">},</span></a>
<a class="sourceLine" id="cb45-21" title="21">  <span class="dt">filter</span><span class="op">:</span> <span class="st">&#39;&#39;</span></a>
<a class="sourceLine" id="cb45-22" title="22"><span class="op">}</span></a></code></pre></div>
<p>Then you could write a selector to extract a filtered list of <code>farmer</code> objects:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb46-1" title="1"><span class="co">// ./src/reducers/farmersSelectors.js</span></a>
<a class="sourceLine" id="cb46-2" title="2"></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="im">export</span> <span class="kw">const</span> getAllFarmers <span class="op">=</span> (<span class="op">{</span> farmers <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb46-4" title="4">  <span class="va">Object</span>.<span class="at">values</span>(farmers)</a>
<a class="sourceLine" id="cb46-5" title="5">)<span class="op">;</span></a>
<a class="sourceLine" id="cb46-6" title="6"></a>
<a class="sourceLine" id="cb46-7" title="7"><span class="im">export</span> <span class="kw">const</span> getFilteredFarmers <span class="op">=</span> (<span class="op">{</span> farmers<span class="op">,</span> filter <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb46-8" title="8">  <span class="kw">const</span> lowerCaseFilter <span class="op">=</span> <span class="va">filter</span>.<span class="at">toLowerCase</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb46-9" title="9">  <span class="cf">return</span> <span class="va">Object</span>.<span class="at">values</span>(farmers).<span class="at">filter</span>(</a>
<a class="sourceLine" id="cb46-10" title="10">    (farmer) <span class="kw">=&gt;</span> <span class="va">farmer</span>.<span class="va">name</span>.<span class="at">toLowerCase</span>().<span class="at">includes</span>(lowerCaseFilter)</a>
<a class="sourceLine" id="cb46-11" title="11">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb46-12" title="12"><span class="op">};</span></a></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb47-1" title="1"><span class="co">// ./src/components/FarmerManagerContainer.js</span></a>
<a class="sourceLine" id="cb47-2" title="2"></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="im">import</span> <span class="op">{</span> getAllFarmers<span class="op">,</span> getFilteredFarmers <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../reducers/farmersSelectors&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb47-4" title="4"></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb47-6" title="6">  <span class="dt">farmers</span><span class="op">:</span> <span class="at">getAllFarmers</span>(state)<span class="op">,</span></a>
<a class="sourceLine" id="cb47-7" title="7">  <span class="dt">filteredFarmers</span><span class="op">:</span> <span class="at">getFilteredFarmers</span>(state)<span class="op">,</span></a>
<a class="sourceLine" id="cb47-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="selector-examples">Selector examples</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb48-1" title="1"><span class="co">// ./src/reducers/farmersSelectors.js</span></a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co">// Returns the state&#39;s farmers as an array of farmer objects.</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="im">export</span> <span class="kw">const</span> getAllFarmers <span class="op">=</span> (<span class="op">{</span> farmers <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb48-5" title="5">  <span class="va">Object</span>.<span class="at">values</span>(farmers)</a>
<a class="sourceLine" id="cb48-6" title="6">)<span class="op">;</span></a>
<a class="sourceLine" id="cb48-7" title="7"></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co">// Returns the state&#39;s farmers as an array of farmer objects,</span></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="co">// filtered by their name.</span></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="im">export</span> <span class="kw">const</span> getFilteredFarmers <span class="op">=</span> (<span class="op">{</span> farmers<span class="op">,</span> filter <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb48-11" title="11">  <span class="kw">const</span> lowerCaseFilter <span class="op">=</span> <span class="va">filter</span>.<span class="at">toLowerCase</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb48-12" title="12">  <span class="cf">return</span> <span class="va">Object</span>.<span class="at">values</span>(farmers).<span class="at">filter</span>(</a>
<a class="sourceLine" id="cb48-13" title="13">    (farmer) <span class="kw">=&gt;</span> <span class="va">farmer</span>.<span class="va">name</span>.<span class="at">toLowerCase</span>().<span class="at">includes</span>(lowerCaseFilter)</a>
<a class="sourceLine" id="cb48-14" title="14">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb48-15" title="15"><span class="op">};</span></a>
<a class="sourceLine" id="cb48-16" title="16"></a>
<a class="sourceLine" id="cb48-17" title="17"><span class="co">// Returns the selected farmer object or an empty farmer object</span></a>
<a class="sourceLine" id="cb48-18" title="18"><span class="co">// if no farmer exists with given id.</span></a>
<a class="sourceLine" id="cb48-19" title="19"><span class="im">export</span> <span class="kw">const</span> selectFarmer <span class="op">=</span> (<span class="op">{</span> farmers <span class="op">},</span> id) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb48-20" title="20">  <span class="kw">const</span> nullFarmer <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb48-21" title="21">    <span class="dt">id</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></a>
<a class="sourceLine" id="cb48-22" title="22">    <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb48-23" title="23">    <span class="dt">paid</span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb48-24" title="24">  <span class="op">};</span></a>
<a class="sourceLine" id="cb48-25" title="25">  <span class="cf">return</span> farmers[id] <span class="op">||</span> nullFarmer<span class="op">;</span></a>
<a class="sourceLine" id="cb48-26" title="26"><span class="op">};</span></a></code></pre></div>
<h2 id="what-you-learned-4">What you learned</h2>
<p>In this article, you learned how to write a selector to extract and format information from state stored in a Redux store.</p>
<hr />
<h1 id="middleware">Middleware</h1>
<p>In Redux, middleware specifically refers to an <code>enhancer</code> passed to the store via <code>createStore</code>. When a <code>dispatch</code> is made, the middleware intercepts the <code>action</code> before it reaches the <code>reducer</code>. The middleware can then:</p>
<ul>
<li><strong>resolve the action itself</strong> (for example, by making an AJAX request),</li>
<li><strong>pass along the action</strong> (if the middleware isn’t concerned with it),</li>
<li><strong>generate a side effect</strong> (such as logging debugging information),</li>
<li><strong>send another dispatch</strong> (if the action triggers other actions),</li>
<li>or some combination thereof.</li>
</ul>
<p>You’ll use Redux middleware for logging information about the store and making asynchronous API requests, but you can also use it for crash reporting, routing, and many other applications.</p>
<p>When you finish this article, you should be able to use the React-Redux library’s <code>applyMiddleware</code> function to configure one or more middleware when creating a store.</p>
<h2 id="applying-middleware-to-a-redux-store">Applying middleware to a Redux store</h2>
<p>Recall the <code>redux</code> library’s <code>createStore</code> function used to instantiate a store. <code>createStore</code> accepts three arguments (<code>reducer, preloadedState, enhancer</code>); middleware is given to the store via the optional <code>enhancer</code> argument.</p>
<p>Consider the following example, where you import a third-party <code>logger</code> middleware:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb49-1" title="1"><span class="co">// ./src/store.js</span></a>
<a class="sourceLine" id="cb49-2" title="2"></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb49-5" title="5"></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="im">import</span> rootReducer <span class="im">from</span> <span class="st">&#39;./reducers/rootReducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb49-7" title="7"></a>
<a class="sourceLine" id="cb49-8" title="8"><span class="kw">const</span> configureStore <span class="op">=</span> (preloadedState <span class="op">=</span> <span class="op">{}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb49-9" title="9">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb49-10" title="10">    rootReducer<span class="op">,</span></a>
<a class="sourceLine" id="cb49-11" title="11">    preloadedState<span class="op">,</span></a>
<a class="sourceLine" id="cb49-12" title="12">    <span class="at">applyMiddleware</span>(logger)<span class="op">,</span></a>
<a class="sourceLine" id="cb49-13" title="13">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb49-14" title="14"><span class="op">};</span></a>
<a class="sourceLine" id="cb49-15" title="15"></a>
<a class="sourceLine" id="cb49-16" title="16"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<p>Any actions dispatched to the <code>store</code> pass through the <code>logger</code> middleware, which prints the store’s state before and after the <code>action</code> is processed.</p>
<blockquote>
<p><strong>Note:</strong> <code>applyMiddleware()</code> accepts multiple arguments, so you can also apply more middleware if necessary.</p>
</blockquote>
<h2 id="reviewing-the-signature-of-middleware-functions">Reviewing the signature of middleware functions</h2>
<p>In addition to importing third-party middlewares such as the above <code>logger</code>, you’ll sometimes need to roll your own. All middleware functions need to conform to the same signature in order to be compatible with the store and other middlewares.</p>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Glossary/Signature/Function"><strong>function signature</strong></a> is the set of inputs and output of a function. A Redux middleware must always have the following signature:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">const</span> middleware <span class="op">=</span> store <span class="kw">=&gt;</span> next <span class="kw">=&gt;</span> action <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb50-2" title="2"> <span class="co">// side effects, if any</span></a>
<a class="sourceLine" id="cb50-3" title="3"> <span class="cf">return</span> <span class="at">next</span>(action)<span class="op">;</span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="op">};</span></a></code></pre></div>
<p>Every middleware receives the <code>store</code> as an argument and returns a function that takes the <code>next</code> link in the middleware chain as an argument. That function returns <em>another</em> function that receives the <code>action</code> and then triggers any side effects before returning the result of <code>next(action)</code>. Side effects can include triggering AJAX requests, logging to the console, and more. Side effects can also happen after <code>next(action)</code> is called, like so:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">const</span> middleware <span class="op">=</span> store <span class="kw">=&gt;</span> next <span class="kw">=&gt;</span> action <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb51-2" title="2"> <span class="kw">const</span> result <span class="op">=</span> <span class="at">next</span>(action)<span class="op">;</span></a>
<a class="sourceLine" id="cb51-3" title="3"> <span class="co">// side effect using `result`</span></a>
<a class="sourceLine" id="cb51-4" title="4"> <span class="cf">return</span> result<span class="op">;</span></a>
<a class="sourceLine" id="cb51-5" title="5"><span class="op">};</span></a></code></pre></div>
<h2 id="creating-your-own-logger-middleware">Creating your own <code>logger</code> middleware</h2>
<p>You can hand-roll the <code>logger</code> middleware you imported above. It should print out the state before and after each dispatch, allowing you to check if your reducers are working as expected. This middleware should:</p>
<ul>
<li>receive the store as its only argument,</li>
<li>return a function that receives the <code>next</code> middleware,</li>
<li>which should itself return a function receiving the <code>action</code>.</li>
</ul>
<p>The body of the innermost function is where you want to do your logging. That function should:</p>
<ul>
<li><code>console.log</code> the <code>action</code></li>
<li><code>console.log</code> the result of <code>store.getState()</code> (pre-dispatch)</li>
<li>call <code>next(action)</code> to pass the action on to the rest of the middlewares, and eventually, the reducer</li>
<li>save the <code>result</code> of the <code>next(action)</code> variable, to be returned later</li>
<li><code>console.log</code> the new <code>store.getState()</code></li>
<li>return the saved <code>result</code></li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">const</span> logger <span class="op">=</span> store <span class="kw">=&gt;</span> next <span class="kw">=&gt;</span> action <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb52-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Action received:&#39;</span><span class="op">,</span> action)<span class="op">;</span></a>
<a class="sourceLine" id="cb52-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;State pre-dispatch:&#39;</span><span class="op">,</span> <span class="va">store</span>.<span class="at">getState</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb52-4" title="4"></a>
<a class="sourceLine" id="cb52-5" title="5">  <span class="kw">let</span> result <span class="op">=</span> <span class="at">next</span>(action)<span class="op">;</span></a>
<a class="sourceLine" id="cb52-6" title="6"></a>
<a class="sourceLine" id="cb52-7" title="7">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;State post-dispatch:&#39;</span><span class="op">,</span> <span class="va">store</span>.<span class="at">getState</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb52-8" title="8"></a>
<a class="sourceLine" id="cb52-9" title="9">  <span class="cf">return</span> result<span class="op">;</span></a>
<a class="sourceLine" id="cb52-10" title="10"><span class="op">};</span></a></code></pre></div>
<p>Now, whenever you dispatch an action, you’ll see its effect on the store.</p>
<h2 id="installing-and-applying-the-redux-logger-middleware">Installing and applying the <code>redux-logger</code> middleware</h2>
<p>As you move forward with Redux, you’ll want to have access to your store’s state for debugging purposes. Including the <code>redux-logger</code> npm package and adding it as a middleware gives you access (through the console) to the previous state, action, and next state with each dispatch. This is incredibly convenient for debugging purposes and avoids such unpleasantness as attaching the <code>store</code> to the <code>window</code>.</p>
<figure>
<img src="images/react-redux-logger.png" alt="react-redux-logger" /><figcaption>react-redux-logger</figcaption>
</figure>
<p>Follow the example below to include it in your projects:</p>
<ul>
<li>Include the <code>redux-logger</code> package:</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb53-1" title="1"><span class="ex">npm</span> install redux-logger</a></code></pre></div>
<ul>
<li>Pass an instance of <code>redux-logger</code> to <code>applyMiddleware</code> when creating your store:</li>
</ul>
<p><strong>Note: <code>logger</code> must be the last middleware passed into <code>applyMiddleware</code></strong>, otherwise it will log the thunk and any involved promises. You’ll learn about thunks and <code>react-thunk</code> in the next article.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb54-1" title="1"><span class="co">// ./src/store.js</span></a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;redux-thunk&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb54-6" title="6"></a>
<a class="sourceLine" id="cb54-7" title="7"><span class="im">import</span> rootReducer <span class="im">from</span> <span class="st">&#39;./reducers/rootReducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb54-8" title="8"></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="kw">const</span> configureStore <span class="op">=</span> (preloadedState <span class="op">=</span> <span class="op">{}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb54-10" title="10">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb54-11" title="11">    rootReducer<span class="op">,</span></a>
<a class="sourceLine" id="cb54-12" title="12">    preloadedState<span class="op">,</span></a>
<a class="sourceLine" id="cb54-13" title="13">    <span class="at">applyMiddleware</span>(thunk<span class="op">,</span> logger)<span class="op">,</span></a>
<a class="sourceLine" id="cb54-14" title="14">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb54-15" title="15"><span class="op">};</span></a>
<a class="sourceLine" id="cb54-16" title="16"></a>
<a class="sourceLine" id="cb54-17" title="17"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<h2 id="what-you-learned-5">What you learned</h2>
<p>In this article, you learned how to use the React-Redux library’s <code>applyMiddleware</code> function to configure one or more middleware when creating a store.</p>
<hr />
<h1 id="thunks">Thunks</h1>
<p>One of the most common problems you need middleware to solve is asynchronicity. When building web applications that interact with a server, you’ll need to request resources and then dispatch the response to your store when it eventually gets back.</p>
<p>While it’s possible to make these API calls from your components and dispatch synchronously on success, for consistency and reusability it’s preferable to have the source of every change to our application state be an action creator. Thunks are a new kind of action creator that will allow you to do that.</p>
<p>When you finish this article, you should be able to write a thunk action creator to make an asynchronous request to an API and dispatch an action when the response is received.</p>
<h2 id="looking-at-how-thunks-work">Looking at how thunks work</h2>
<p>Rather than returning a plain object, a thunk action creator returns a function. This function, when called with an argument of <code>dispatch</code>, can then dispatch one or more actions, immediately, or later. Here’s an example:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">const</span> thunkActionCreator <span class="op">=</span> () <span class="kw">=&gt;</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb55-2" title="2">  <span class="at">dispatch</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb55-3" title="3">    <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;RECEIVE_MESSAGE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb55-4" title="4">    <span class="dt">message</span><span class="op">:</span> <span class="st">&#39;This will be dispatched immediately.&#39;</span></a>
<a class="sourceLine" id="cb55-5" title="5">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb55-6" title="6"></a>
<a class="sourceLine" id="cb55-7" title="7">  <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb55-8" title="8">    <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;RECEIVE_MESSAGE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb55-9" title="9">    <span class="dt">message</span><span class="op">:</span> <span class="st">&#39;This will be dispatched 1 second later.&#39;</span></a>
<a class="sourceLine" id="cb55-10" title="10">  <span class="op">},</span> <span class="dv">1000</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb55-11" title="11"><span class="op">}</span></a></code></pre></div>
<p>This is great, but without custom middleware it will break as soon as the function action hits your reducer. You need middleware to intercept all actions of type <code>function</code> and then trigger the dispatch:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb56-1" title="1"><span class="co">// ./src/middleware/thunkMiddleware.js</span></a>
<a class="sourceLine" id="cb56-2" title="2"></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="kw">const</span> thunk <span class="op">=</span> (<span class="op">{</span> dispatch<span class="op">,</span> getState <span class="op">}</span>) <span class="kw">=&gt;</span> next <span class="kw">=&gt;</span> action <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb56-4" title="4">  <span class="cf">if</span> (<span class="kw">typeof</span> action <span class="op">===</span> <span class="st">&#39;function&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb56-5" title="5">    <span class="cf">return</span> <span class="at">action</span>(dispatch<span class="op">,</span> getState)<span class="op">;</span></a>
<a class="sourceLine" id="cb56-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb56-7" title="7">  <span class="cf">return</span> <span class="at">next</span>(action)<span class="op">;</span></a>
<a class="sourceLine" id="cb56-8" title="8"><span class="op">};</span></a>
<a class="sourceLine" id="cb56-9" title="9"></a>
<a class="sourceLine" id="cb56-10" title="10"><span class="im">export</span> <span class="im">default</span> thunk<span class="op">;</span></a></code></pre></div>
<p>Notice how the <code>getState</code> function is passed into the <code>action</code> in case your asynchronous action creators need access to your application state.</p>
<p>Then you’d apply your custom middleware to your store:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb57-1" title="1"><span class="co">// ./src/store.js</span></a>
<a class="sourceLine" id="cb57-2" title="2"></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb57-5" title="5"></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="im">import</span> rootReducer <span class="im">from</span> <span class="st">&#39;./reducers/rootReducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;./middleware/thunkMiddleware&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb57-8" title="8"></a>
<a class="sourceLine" id="cb57-9" title="9"><span class="kw">const</span> configureStore <span class="op">=</span> (preloadedState <span class="op">=</span> <span class="op">{}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb57-10" title="10">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb57-11" title="11">    rootReducer<span class="op">,</span></a>
<a class="sourceLine" id="cb57-12" title="12">    preloadedState<span class="op">,</span></a>
<a class="sourceLine" id="cb57-13" title="13">    <span class="at">applyMiddleware</span>(thunk<span class="op">,</span> logger)<span class="op">,</span></a>
<a class="sourceLine" id="cb57-14" title="14">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb57-15" title="15"><span class="op">};</span></a>
<a class="sourceLine" id="cb57-16" title="16"></a>
<a class="sourceLine" id="cb57-17" title="17"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<p>That’s it! Now that you have all the pieces, you’re ready to review a more concrete example.</p>
<h2 id="reviewing-a-concrete-example">Reviewing a concrete example</h2>
<p>Much like the logger from the previous article, thunk middleware is available as the <code>redux-thunk</code> library.</p>
<blockquote>
<p>The middleware you just wrote is almost the entire original library! (<a href="https://github.com/gaearon/redux-thunk/blob/master/src/index.js">Check out the source code</a>). For more on thunks and handling asynchronicity in Redux, you can take a look at <a href="http://stackoverflow.com/questions/35411423/how-to-dispatch-a-redux-action-with-a-timeout/35415559#35415559">this interesting SO post from the creator</a>.</p>
</blockquote>
<p>Start by using npm to install the <code>redux-thunk</code> package:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb58-1" title="1"><span class="ex">npm</span> install redux-thunk</a></code></pre></div>
<p>Then apply the middleware to your store:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb59-1" title="1"><span class="co">// ./src/store.js</span></a>
<a class="sourceLine" id="cb59-2" title="2"></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;redux-thunk&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb59-6" title="6"></a>
<a class="sourceLine" id="cb59-7" title="7"><span class="im">import</span> rootReducer <span class="im">from</span> <span class="st">&#39;./reducers/rootReducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb59-8" title="8"></a>
<a class="sourceLine" id="cb59-9" title="9"><span class="kw">const</span> configureStore <span class="op">=</span> (preloadedState <span class="op">=</span> <span class="op">{}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb59-10" title="10">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb59-11" title="11">    rootReducer<span class="op">,</span></a>
<a class="sourceLine" id="cb59-12" title="12">    preloadedState<span class="op">,</span></a>
<a class="sourceLine" id="cb59-13" title="13">    <span class="at">applyMiddleware</span>(thunk<span class="op">,</span> logger)<span class="op">,</span></a>
<a class="sourceLine" id="cb59-14" title="14">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb59-15" title="15"><span class="op">};</span></a>
<a class="sourceLine" id="cb59-16" title="16"></a>
<a class="sourceLine" id="cb59-17" title="17"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<p>Imagine that you’re updating the Fruit Stand application to use a Node/Express API for data persistence. You would use a <code>fetchFruits</code> thunk action creator to retrieve the list of fruits from the API:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb60-1" title="1"><span class="co">// ./src/actions/fruitActions.js</span></a>
<a class="sourceLine" id="cb60-2" title="2"></a>
<a class="sourceLine" id="cb60-3" title="3"><span class="im">import</span> <span class="op">{</span> FRUIT_STAND_API_BASE_URL <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../config&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb60-4" title="4"></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="im">export</span> <span class="kw">const</span> RECEIVE_FRUITS <span class="op">=</span> <span class="st">&#39;RECEIVE_FRUITS&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb60-6" title="6"></a>
<a class="sourceLine" id="cb60-7" title="7"><span class="im">export</span> <span class="kw">const</span> fetchFruits <span class="op">=</span> () <span class="kw">=&gt;</span> (dispatch) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb60-8" title="8">  <span class="at">fetch</span>(<span class="vs">`</span><span class="sc">${</span>FRUIT_STAND_API_BASE_URL<span class="sc">}</span><span class="vs">/fruits`</span>)</a>
<a class="sourceLine" id="cb60-9" title="9">    .<span class="at">then</span>((res) <span class="kw">=&gt;</span> <span class="va">res</span>.<span class="at">json</span>())</a>
<a class="sourceLine" id="cb60-10" title="10">    .<span class="at">then</span>((data) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb60-11" title="11">      <span class="at">dispatch</span>(<span class="at">receiveFruits</span>(<span class="va">data</span>.<span class="at">fruits</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb60-12" title="12">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb60-13" title="13">)<span class="op">;</span></a>
<a class="sourceLine" id="cb60-14" title="14"></a>
<a class="sourceLine" id="cb60-15" title="15"><span class="kw">const</span> receiveFruits <span class="op">=</span> (fruits) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb60-16" title="16">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb60-17" title="17">    <span class="dt">type</span><span class="op">:</span> RECEIVE_FRUITS<span class="op">,</span></a>
<a class="sourceLine" id="cb60-18" title="18">    fruits<span class="op">,</span></a>
<a class="sourceLine" id="cb60-19" title="19">  <span class="op">};</span></a>
<a class="sourceLine" id="cb60-20" title="20"><span class="op">};</span></a></code></pre></div>
<p>Notice that the Fetch API is used to make an HTTP request to the <code>/fruits</code> API endpoint. When the promise returned from the <code>fetch</code> method call resolves, the <code>res.json</code> method is called to parse the JSON into JavaScript objects, which in turn is dispatched to the store using the <code>receiveFruits</code> action creator. The <code>receiveFruits</code> action creator returns an action of type <code>RECEIVE_FRUITS</code> that includes the <code>fruit</code> payload.</p>
<p>In the <code>fruitReducer</code>, the <code>RECEIVE_FRUITS</code> case clause simply returns the <code>action.fruits</code> payload as the new state:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb61-1" title="1"><span class="co">// ./src/reducers/fruitReducer.js</span></a>
<a class="sourceLine" id="cb61-2" title="2"></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="im">import</span> <span class="op">{</span> RECEIVE_FRUITS <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/fruitActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb61-4" title="4"></a>
<a class="sourceLine" id="cb61-5" title="5"><span class="kw">const</span> fruitReducer <span class="op">=</span> (state <span class="op">=</span> []<span class="op">,</span> action) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb61-6" title="6">  <span class="va">Object</span>.<span class="at">freeze</span>(state)<span class="op">;</span></a>
<a class="sourceLine" id="cb61-7" title="7">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb61-8" title="8">    <span class="cf">case</span> <span class="dt">RECEIVE_FRUITS</span><span class="op">:</span></a>
<a class="sourceLine" id="cb61-9" title="9">      <span class="cf">return</span> <span class="va">action</span>.<span class="at">fruits</span><span class="op">;</span></a>
<a class="sourceLine" id="cb61-10" title="10">    <span class="cf">default</span><span class="op">:</span></a>
<a class="sourceLine" id="cb61-11" title="11">      <span class="cf">return</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb61-12" title="12">  <span class="op">}</span></a>
<a class="sourceLine" id="cb61-13" title="13"><span class="op">};</span></a>
<a class="sourceLine" id="cb61-14" title="14"></a>
<a class="sourceLine" id="cb61-15" title="15"><span class="im">export</span> <span class="im">default</span> fruitReducer<span class="op">;</span></a></code></pre></div>
<p>To load the fruits from the API when the React application starts up, you can update the <code>index.js</code> file to dispatch the <code>fetchFruits</code> thunk action creator after creating the store:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb62-1" title="1"><span class="co">// ./src/index.js</span></a>
<a class="sourceLine" id="cb62-2" title="2"></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-6" title="6"></a>
<a class="sourceLine" id="cb62-7" title="7"><span class="im">import</span> <span class="st">&#39;./index.css&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-8" title="8"><span class="im">import</span> App <span class="im">from</span> <span class="st">&#39;./App&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="im">import</span> configureStore <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-10" title="10"><span class="im">import</span> <span class="op">{</span> fetchFruits <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./actions/fruitActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-11" title="11"></a>
<a class="sourceLine" id="cb62-12" title="12"><span class="kw">const</span> store <span class="op">=</span> <span class="at">configureStore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb62-13" title="13"><span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">fetchFruits</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb62-14" title="14"></a>
<a class="sourceLine" id="cb62-15" title="15"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb62-16" title="16">  <span class="op">&lt;</span><span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb62-17" title="17">    <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb62-18" title="18">      <span class="op">&lt;</span>App /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb62-19" title="19">    &lt;/Provider<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb62-20" title="20">  &lt;/<span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb62-21" title="21">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb62-22" title="22">)<span class="op">;</span></a></code></pre></div>
<h3 id="adding-configuration-for-the-api-base-url">Adding configuration for the API base URL</h3>
<p>The <code>FRUIT_STAND_API_BASE_URL</code> variable (imported at the top of the <code>fruitActions.js</code> file) is defined in the <code>config.js</code> file:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb63-1" title="1"><span class="im">export</span> <span class="kw">const</span> FRUIT_STAND_API_BASE_URL <span class="op">=</span> <span class="va">process</span>.<span class="va">env</span>.<span class="at">REACT_APP_FRUIT_STAND_API_BASE_URL</span><span class="op">;</span></a></code></pre></div>
<p>And the <code>REACT_APP_FRUIT_STAND_API_BASE_URL</code> environment variable is defined in an <code>.env</code> file (located in the root of the React project):</p>
<pre><code>REACT_APP_FRUIT_STAND_API_BASE_URL=http://localhost:8080</code></pre>
<p>Adding configuration for the API base URL keeps you from having to hard-code a value that’ll change between environments.</p>
<h2 id="reviewing-a-completed-fruit-stand-example-3">Reviewing a completed Fruit Stand example</h2>
<p>To review and run a completed Fruit Stand example application that utilizes middleware and thunks to support asynchronous interaction with a backend API, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>fruit-stand-redux-with-react-middleware-thunks</code> folder.</p>
<h3 id="running-the-api">Running the API</h3>
<p>To run the Node/Express API application, complete the following steps:</p>
<ol type="1">
<li><p>Within the <code>backend</code> folder, add an <code>.env</code> file based upon the <code>.env.example</code> file.</p></li>
<li><p>Use the following SQL statements to create a PostgreSQL database and user:</p></li>
</ol>
<div class="sourceCode" id="cb65"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">create</span> <span class="kw">database</span> fruit_stand;</a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">create</span> <span class="fu">user</span> fruit_stand_app <span class="kw">with</span> encrypted <span class="kw">password</span> <span class="st">&#39;«a strong password for the fruit_stand_app user»&#39;</span>;</a>
<a class="sourceLine" id="cb65-3" title="3"><span class="kw">grant</span> <span class="kw">all</span> <span class="kw">privileges</span> <span class="kw">on</span> <span class="kw">database</span> fruit_stand <span class="kw">to</span> fruit_stand_app;</a></code></pre></div>
<ol start="3" type="1">
<li>From a terminal, browse to the <code>backend</code> folder and run the following commands to apply the Sequelize migrations and seed data:</li>
</ol>
<div class="sourceCode" id="cb66"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb66-1" title="1"><span class="ex">npx</span> dotenv sequelize db:migrate</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="ex">npx</span> dotenv sequelize db:seed:all</a></code></pre></div>
<ol start="4" type="1">
<li>Start the application using <code>npm start</code>.</li>
</ol>
<h3 id="running-the-react-application">Running the React application</h3>
<p>From the <code>frontend</code> folder, run the command <code>npm install</code> to install the project’s dependencies. Then use the command <code>npm start</code> to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the Create React App tooling. When running the application using <code>npm start</code>, the application should automatically open in your default browser. If it doesn’t, you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 id="what-you-learned-6">What you learned</h2>
<p>In this article, you learned how to write a thunk action creator to make an asynchronous request to an API and dispatch an action when the response is received.</p>
<hr />
<h1 id="advanced-containers">Advanced Containers</h1>
<p>While you learned in an earlier article that you should aim to have very few containers, there are exceptions. When you finish this article, you should be able to describe a situation where defining multiple containers for a single component is advantageous.</p>
<h2 id="knowing-when-to-break-the-rules">Knowing when to break the rules</h2>
<p>Separating your concerns with presentational and container components allows you to reuse presentational components where it makes sense, rather than duplicating code. If a presentational component needs different data in each situation, though, you may need more containers. By creating more container components, you can render the same presentational component with each of those containers to suit different needs.</p>
<p>Consider a form component that may either <em>create</em> or <em>edit</em> a post. The form itself looks and works the same in both cases; it has a few inputs and a submit button. The use cases differ, though, in that the edit form needs to map state from the store to its props, while the create form does not. Furthermore, the edit form will need to dispatch a different action when the form submits than the create form will, as well as request the object from our backend.</p>
<p><strong>As you go through the code snippets below, read the comments carefully.</strong></p>
<p>Here’s the presentational component, <code>PostForm</code>:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb67-1" title="1"><span class="co">// PostForm.js</span></a>
<a class="sourceLine" id="cb67-2" title="2"></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb67-4" title="4"></a>
<a class="sourceLine" id="cb67-5" title="5"><span class="kw">class</span> PostForm <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb67-6" title="6">  <span class="at">constructor</span>(props) <span class="op">{</span></a>
<a class="sourceLine" id="cb67-7" title="7">    <span class="kw">super</span>(props)<span class="op">;</span></a>
<a class="sourceLine" id="cb67-8" title="8">    <span class="co">// set up initial state</span></a>
<a class="sourceLine" id="cb67-9" title="9">    <span class="kw">this</span>.<span class="at">state</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">props</span>.<span class="at">post</span><span class="op">;</span> <span class="co">// a Post object has a title and a body</span></a>
<a class="sourceLine" id="cb67-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb67-11" title="11"></a>
<a class="sourceLine" id="cb67-12" title="12">  <span class="kw">static</span> <span class="at">getDerivedStateFromProps</span>(props<span class="op">,</span> state) <span class="op">{</span></a>
<a class="sourceLine" id="cb67-13" title="13">    <span class="co">// if we get a different post in props, we&#39;ll need to set state</span></a>
<a class="sourceLine" id="cb67-14" title="14">    <span class="cf">if</span> (<span class="va">props</span>.<span class="va">post</span>.<span class="at">id</span> <span class="op">!==</span> <span class="va">state</span>.<span class="at">id</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb67-15" title="15">      <span class="cf">return</span> <span class="va">props</span>.<span class="at">post</span><span class="op">;</span></a>
<a class="sourceLine" id="cb67-16" title="16">    <span class="op">}</span></a>
<a class="sourceLine" id="cb67-17" title="17">  <span class="op">}</span></a>
<a class="sourceLine" id="cb67-18" title="18"></a>
<a class="sourceLine" id="cb67-19" title="19">  update <span class="op">=</span> (field) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb67-20" title="20">    <span class="cf">return</span> (e) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb67-21" title="21">      <span class="kw">this</span>.<span class="at">setState</span>(<span class="op">{</span> [field]<span class="op">:</span> <span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb67-22" title="22">    <span class="op">};</span></a>
<a class="sourceLine" id="cb67-23" title="23">  <span class="op">}</span></a>
<a class="sourceLine" id="cb67-24" title="24"></a>
<a class="sourceLine" id="cb67-25" title="25">  handleSubmit <span class="op">=</span> (e) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb67-26" title="26">    <span class="va">e</span>.<span class="at">preventDefault</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb67-27" title="27">    <span class="co">// `submit` will be a thunk action that presumably creates or edits a post</span></a>
<a class="sourceLine" id="cb67-28" title="28">    <span class="kw">this</span>.<span class="va">props</span>.<span class="at">submit</span>(<span class="kw">this</span>.<span class="at">state</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb67-29" title="29">  <span class="op">}</span></a>
<a class="sourceLine" id="cb67-30" title="30"></a>
<a class="sourceLine" id="cb67-31" title="31">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb67-32" title="32">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb67-33" title="33">      <span class="op">&lt;</span>form onSubmit<span class="op">={</span><span class="kw">this</span>.<span class="at">handleSubmit</span><span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb67-34" title="34">        <span class="op">&lt;</span>label<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb67-35" title="35">          Title</a>
<a class="sourceLine" id="cb67-36" title="36">          <span class="op">&lt;</span>input</a>
<a class="sourceLine" id="cb67-37" title="37">            type<span class="op">=</span><span class="st">&quot;text&quot;</span></a>
<a class="sourceLine" id="cb67-38" title="38">            onChange<span class="op">={</span><span class="kw">this</span>.<span class="at">update</span>(<span class="st">&quot;title&quot;</span>)<span class="op">}</span></a>
<a class="sourceLine" id="cb67-39" title="39">            value<span class="op">={</span><span class="kw">this</span>.<span class="va">state</span>.<span class="at">title</span><span class="op">}</span></a>
<a class="sourceLine" id="cb67-40" title="40">          /&gt;</a>
<a class="sourceLine" id="cb67-41" title="41">        &lt;/label<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb67-42" title="42"></a>
<a class="sourceLine" id="cb67-43" title="43">        <span class="op">&lt;</span>label<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb67-44" title="44">          Body</a>
<a class="sourceLine" id="cb67-45" title="45">          <span class="op">&lt;</span>input</a>
<a class="sourceLine" id="cb67-46" title="46">            type<span class="op">=</span><span class="st">&quot;text&quot;</span></a>
<a class="sourceLine" id="cb67-47" title="47">            onChange<span class="op">={</span><span class="kw">this</span>.<span class="at">update</span>(<span class="st">&quot;body&quot;</span>)<span class="op">}</span></a>
<a class="sourceLine" id="cb67-48" title="48">            value<span class="op">={</span><span class="kw">this</span>.<span class="va">state</span>.<span class="at">body</span><span class="op">}</span></a>
<a class="sourceLine" id="cb67-49" title="49">          /&gt;</a>
<a class="sourceLine" id="cb67-50" title="50">        &lt;/label<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb67-51" title="51"></a>
<a class="sourceLine" id="cb67-52" title="52">        <span class="op">&lt;</span>button<span class="op">&gt;</span>Submit Post&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb67-53" title="53">      &lt;/form<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb67-54" title="54">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb67-55" title="55">  <span class="op">}</span></a>
<a class="sourceLine" id="cb67-56" title="56"><span class="op">}</span></a>
<a class="sourceLine" id="cb67-57" title="57"></a>
<a class="sourceLine" id="cb67-58" title="58"><span class="im">export</span> <span class="im">default</span> PostForm<span class="op">;</span></a></code></pre></div>
<p>You can see that <code>PostForm</code> is expecting two things in props: a <code>post</code> object and a <code>submit</code> function. The container will have to define these, since right now, this form can’t actually do anything. Give it the ability to create a post:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb68-1" title="1"><span class="co">// CreatePostFormContainer.js</span></a>
<a class="sourceLine" id="cb68-2" title="2"></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="im">import</span> <span class="op">{</span> connect <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="im">import</span> PostForm <span class="im">from</span> <span class="st">&#39;./PostForm&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb68-5" title="5"><span class="im">import</span> <span class="op">{</span> createPost <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/postActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb68-6" title="6"></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="kw">const</span> mapStateToProps <span class="op">=</span> state <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb68-8" title="8">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb68-9" title="9">    <span class="dt">post</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">body</span><span class="op">:</span> <span class="st">&#39;&#39;</span> <span class="op">}</span> <span class="co">// a default blank object</span></a>
<a class="sourceLine" id="cb68-10" title="10">  <span class="op">};</span></a>
<a class="sourceLine" id="cb68-11" title="11"><span class="op">};</span></a>
<a class="sourceLine" id="cb68-12" title="12"></a>
<a class="sourceLine" id="cb68-13" title="13"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb68-14" title="14">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb68-15" title="15">    <span class="dt">submit</span><span class="op">:</span> post <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">createPost</span>(post))</a>
<a class="sourceLine" id="cb68-16" title="16">  <span class="op">};</span></a>
<a class="sourceLine" id="cb68-17" title="17"><span class="op">};</span></a>
<a class="sourceLine" id="cb68-18" title="18"></a>
<a class="sourceLine" id="cb68-19" title="19"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb68-20" title="20">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb68-21" title="21">  mapDispatchToProps</a>
<a class="sourceLine" id="cb68-22" title="22">)(PostForm)<span class="op">;</span></a></code></pre></div>
<p>So far, this is nothing new. Now, wherever you need a form to create a post, you can render <code>CreatePostFormContainer</code> by importing from the above file.</p>
<p>But what about editing? This is a little trickier, because you need more information from the store - so you’ll need a <a href="https://spin.atomicobject.com/2017/03/02/higher-order-components-in-react/">higher-order component</a> to help you out. Higher-order components are a useful React pattern that essentially uses a component to render another component, usually to handle some sort of work and pass in data. This pattern allows us to keep your components small and modular. Here, you’ll use a higher-order component to fetch the post you want to edit and pass it into the <code>PostForm</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb69-1" title="1"><span class="co">// EditPostFormContainer.js</span></a>
<a class="sourceLine" id="cb69-2" title="2"></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb69-4" title="4"><span class="im">import</span> <span class="op">{</span> connect <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb69-5" title="5"><span class="im">import</span> PostForm <span class="im">from</span> <span class="st">&#39;./PostForm&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb69-6" title="6"><span class="im">import</span> <span class="op">{</span> fetchPost<span class="op">,</span> updatePost <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/postActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb69-7" title="7"><span class="im">import</span> <span class="op">{</span> selectPost <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../reducers/postSelectors&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb69-8" title="8"></a>
<a class="sourceLine" id="cb69-9" title="9"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-10" title="10">  <span class="kw">const</span> defaultPost <span class="op">=</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">body</span><span class="op">:</span> <span class="st">&#39;&#39;</span> <span class="op">};</span></a>
<a class="sourceLine" id="cb69-11" title="11">  <span class="kw">const</span> post <span class="op">=</span> <span class="at">selectPost</span>(<span class="va">ownProps</span>.<span class="va">match</span>.<span class="va">params</span>.<span class="at">postId</span>) <span class="op">||</span> defaultPost<span class="op">;</span></a>
<a class="sourceLine" id="cb69-12" title="12">  <span class="co">// get the post this route is asking for</span></a>
<a class="sourceLine" id="cb69-13" title="13">  <span class="co">// (assuming here that this component is being rendered by a route)</span></a>
<a class="sourceLine" id="cb69-14" title="14">  <span class="co">// if you don&#39;t have the post in state yet, return a blank post so PostForm doesn&#39;t break</span></a>
<a class="sourceLine" id="cb69-15" title="15">  <span class="cf">return</span> <span class="op">{</span> post <span class="op">};</span></a>
<a class="sourceLine" id="cb69-16" title="16"><span class="op">};</span></a>
<a class="sourceLine" id="cb69-17" title="17"></a>
<a class="sourceLine" id="cb69-18" title="18"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-19" title="19">  <span class="co">// an edit form will need to fetch the relevant post, but the PostForm shouldn&#39;t handle that</span></a>
<a class="sourceLine" id="cb69-20" title="20">  <span class="co">// you&#39;ll handle this problem with a higher-order component, EditPostFormContainer</span></a>
<a class="sourceLine" id="cb69-21" title="21">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-22" title="22">    <span class="dt">fetchPost</span><span class="op">:</span> id <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">fetchPost</span>(id))<span class="op">,</span></a>
<a class="sourceLine" id="cb69-23" title="23">    <span class="dt">submit</span><span class="op">:</span> post <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">updatePost</span>(post))</a>
<a class="sourceLine" id="cb69-24" title="24">  <span class="op">};</span></a>
<a class="sourceLine" id="cb69-25" title="25"><span class="op">};</span></a>
<a class="sourceLine" id="cb69-26" title="26"></a>
<a class="sourceLine" id="cb69-27" title="27"><span class="kw">class</span> EditPostForm <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-28" title="28">  <span class="co">// this is the higher-order component made to handle the fetch</span></a>
<a class="sourceLine" id="cb69-29" title="29"></a>
<a class="sourceLine" id="cb69-30" title="30">  <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb69-31" title="31">    <span class="co">// do the fetching here so that PostForm doesn&#39;t have to</span></a>
<a class="sourceLine" id="cb69-32" title="32">    <span class="kw">this</span>.<span class="va">props</span>.<span class="at">fetchPost</span>(<span class="kw">this</span>.<span class="va">props</span>.<span class="va">match</span>.<span class="va">params</span>.<span class="at">postId</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-33" title="33">  <span class="op">}</span></a>
<a class="sourceLine" id="cb69-34" title="34"></a>
<a class="sourceLine" id="cb69-35" title="35">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb69-36" title="36">    <span class="co">// destructure the props so you can easily pass them down to PostForm</span></a>
<a class="sourceLine" id="cb69-37" title="37">    <span class="kw">const</span> <span class="op">{</span> post<span class="op">,</span> submit <span class="op">}</span> <span class="op">=</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">;</span></a>
<a class="sourceLine" id="cb69-38" title="38">    <span class="cf">return</span> <span class="op">&lt;</span>PostForm post<span class="op">={</span>post<span class="op">}</span> submit<span class="op">={</span>submit<span class="op">}</span> /&gt;<span class="op">;</span></a>
<a class="sourceLine" id="cb69-39" title="39">  <span class="op">}</span></a>
<a class="sourceLine" id="cb69-40" title="40"><span class="op">}</span></a>
<a class="sourceLine" id="cb69-41" title="41"></a>
<a class="sourceLine" id="cb69-42" title="42"><span class="co">// now `connect` it to the Redux store</span></a>
<a class="sourceLine" id="cb69-43" title="43"></a>
<a class="sourceLine" id="cb69-44" title="44"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb69-45" title="45">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb69-46" title="46">  mapDispatchToProps</a>
<a class="sourceLine" id="cb69-47" title="47">)(EditPostForm)<span class="op">;</span></a></code></pre></div>
<p>The result here is that we can render a <code>CreatePostFormContainer</code> wherever you want a form to create a post, and an <code>EditPostFormContainer</code> wherever you want to edit a post. Both components will render a <code>PostForm</code>, but each will have different functions. The <code>PostForm</code> also gets to be very simple and make almost no decisions. This helps keep your code DRY and modular.</p>
<p>You can use this pattern with any presentational component that needs to be connected to the store, but may need entirely different data to perform different functions.</p>
<h2 id="what-you-learned-7">What you learned</h2>
<p>In this article, you learned about a situation where defining multiple containers for a single component is advantageous.</p>
<hr />
<h1 id="redux-developer-tools">Redux Developer Tools</h1>
<p>Redux has its own special set of developer tools. They allow you to do things like inspect your application state in real time as you use your app, or cancel an action to see a live recalculation of the state as if that action had never been dispatched. They require only a few minutes of setup, and can be well worth the effort.</p>
<h2 id="instructions">Instructions</h2>
<ol type="1">
<li><p>Install the <a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd">chrome extension</a>.</p></li>
<li><p>Install the npm package into your project:</p></li>
</ol>
<div class="sourceCode" id="cb70"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb70-1" title="1"><span class="ex">npm</span> install redux-devtools-extension</a></code></pre></div>
<ol start="3" type="1">
<li>Make the following changes to your <code>./src/store.js</code> file.</li>
</ol>
<p><strong>If you’re <em>not</em> using middleware:</strong></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb71-1" title="1">  // ./src/store.js</a>
<a class="sourceLine" id="cb71-2" title="2"></a>
<a class="sourceLine" id="cb71-3" title="3">  import { createStore } from &#39;redux&#39;;</a>
<a class="sourceLine" id="cb71-4" title="4"><span class="va">+ import { devToolsEnhancer } from &#39;redux-devtools-extension&#39;;</span></a>
<a class="sourceLine" id="cb71-5" title="5"></a>
<a class="sourceLine" id="cb71-6" title="6">  import rootReducer from &#39;./reducers/rootReducer&#39;;</a>
<a class="sourceLine" id="cb71-7" title="7"></a>
<a class="sourceLine" id="cb71-8" title="8">  const configureStore = () =&gt; {</a>
<a class="sourceLine" id="cb71-9" title="9">    return createStore(</a>
<a class="sourceLine" id="cb71-10" title="10">      rootReducer,</a>
<a class="sourceLine" id="cb71-11" title="11"><span class="va">+     devToolsEnhancer()</span></a>
<a class="sourceLine" id="cb71-12" title="12">    );</a>
<a class="sourceLine" id="cb71-13" title="13">  };</a>
<a class="sourceLine" id="cb71-14" title="14"></a>
<a class="sourceLine" id="cb71-15" title="15">  export default configureStore;</a></code></pre></div>
<p><strong>Or if you’re using middleware:</strong></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb72-1" title="1">  // ./src/store.js</a>
<a class="sourceLine" id="cb72-2" title="2"></a>
<a class="sourceLine" id="cb72-3" title="3">  import { createStore, applyMiddleware } from &#39;redux&#39;;</a>
<a class="sourceLine" id="cb72-4" title="4">  import thunk from &#39;redux-thunk&#39;;</a>
<a class="sourceLine" id="cb72-5" title="5">  import logger from &#39;redux-logger&#39;;</a>
<a class="sourceLine" id="cb72-6" title="6"><span class="va">+ import { composeWithDevTools } from &#39;redux-devtools-extension&#39;;</span></a>
<a class="sourceLine" id="cb72-7" title="7"></a>
<a class="sourceLine" id="cb72-8" title="8">  import rootReducer from &#39;./reducers/rootReducer&#39;;</a>
<a class="sourceLine" id="cb72-9" title="9"></a>
<a class="sourceLine" id="cb72-10" title="10">  const configureStore = () =&gt; {</a>
<a class="sourceLine" id="cb72-11" title="11">    return createStore(</a>
<a class="sourceLine" id="cb72-12" title="12">      rootReducer,</a>
<a class="sourceLine" id="cb72-13" title="13"><span class="va">+     composeWithDevTools(applyMiddleware(thunk, logger))</span></a>
<a class="sourceLine" id="cb72-14" title="14"><span class="st">-     applyMiddleware(thunk, logger)</span></a>
<a class="sourceLine" id="cb72-15" title="15">    );</a>
<a class="sourceLine" id="cb72-16" title="16">  };</a>
<a class="sourceLine" id="cb72-17" title="17"></a>
<a class="sourceLine" id="cb72-18" title="18">  export default configureStore;</a></code></pre></div>
<h2 id="use">Use</h2>
<p>Now that you’ve set up the Redux dev tools, you can try them out. You’ll use one of the Fruit Stand application examples. If you haven’t already, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>fruit-stand-redux-with-react-official-bindings</code> folder. Run the command <code>npm install</code> to install the project’s dependencies. Then use the command <code>npm start</code> to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the Create React App tooling. When running the application using <code>npm start</code>, the application should automatically open in your default browser. If it doesn’t, you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<p><strong>Open the project into your code editor and complete the above set up steps.</strong></p>
<p>You should see an atom (a nucleus with electrons) icon on your Chrome toolbar, and if you’ve set up the Redux dev tools correctly it should now be green. Click on it. When the Redux dev tools open, click one of the buttons on the very bottom left to open them in a new window.</p>
<p>Now try adding some fruit. This will cause actions to be dispatched. You should see those actions popping up in the Redux dev tools. You can click on them to cancel them and you should see the state recalculated in real time.</p>
<p>The Redux dev tools have some other handy features, so click around and explore!</p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd">Redux Dev Tools - Chrome Extension</a></li>
<li><a href="https://github.com/gaearon/redux-devtools">Redux Dev Tools - Github Page</a></li>
<li><a href="http://extension.remotedev.io/#demo">Redux Dev Tools - Demo</a></li>
</ul>
<hr />
<h1 id="redux-based-pokedex-project">Redux-Based Pokedex Project</h1>
<p>Instead of building a new application, you will spend time refactoring an existing application, one that is not yours. Navigating around someone else’s code is an interesting way to learn what to do and what <em>not</em> to do. The starter application is in a little bit of a mess and needs your help to get unmessed.</p>
<p>By the end of this walk-through, you will be able to:</p>
<ul>
<li>Describe the Redux data cycle</li>
<li>Explain a <em>reducer</em></li>
<li>Configure a React application to use Redux</li>
<li>Use connected components to access Redux state</li>
<li>Use composed reducers to simplify state management</li>
<li>Configure a React application to use the Redux development tools</li>
</ul>
<h2 id="getting-started">Getting started</h2>
<p>You’ll need the backend of the application.</p>
<p>If you have <em>not</em> cloned it, please clone the repository from https://github.com/appacademy-starters/pokedex-backend.</p>
<p>If you have cloned it, please get the latest (things sometimes change) by going to the repository in your Terminal and typing <code>git pull origin master</code>. This will get the latest code for you.</p>
<p>You’ll need the starter application. Please clone the repository from https://github.com/appacademy-starters/redux-pokedex-starter.</p>
<h2 id="tour-the-application">Tour the application</h2>
<p>This application is a Heroku-deployable React application. Here are the files that are in it. Hopefully, you find nothing surprising about the file layout or the intent of each file. Take a moment to look in each file to get the lay of the land. (Really, take a look in each file. You may feel like jumping right into it, but looking at other people’s code is helpful. This is one of the benefits to the pair-programming learning style at App Academy.)</p>
<pre><code>.
├── package-lock.json        - The NPM lock file
├── package.json             - The NPM file
├── public
│   └── index.html           - The page that gets served to the browser
├── server.js                - A very light-weight server for Heroku
└── src
    ├── App.js               - The main application component
    ├── Fab.js               - A floating action button component
    ├── LoginPanel.js        - The form that shows the login
    ├── LogoutButton.js      - A component for logging out
    ├── PokemonBrowser.js    - The component that shows the list and detail
    ├── PokemonDetail.js     - The component that shows the detail of a Pokemon
    ├── PokemonForm.js       - The form to create a new Pokemon
    ├── config.js            - Configuration variables
    ├── index.css            - Styling for the application
    └── index.js             - The main entry point for Webpack</code></pre>
<p>Start the backend with <code>npm run dev</code>. Start the React application with <code>npm run dev</code>. Make sure it runs. It looks for a local backend at <code>http://localhost:8000</code>, so make sure that’s where the backend is running.</p>
<h2 id="install-redux-and-devtools">Install Redux and DevTools</h2>
<p>If you haven’t already, install <a href="https://github.com/supasate/connected-react-router">Redux DevTools</a>. During development, you can watch the Redux store handle actions and change state in the timeline.</p>
<p>To use Redux in this application, you need to install it and the connector between Redux and React. You will also want to use asynchronous actions with the Redux store, so you’ll want a middleware, one like <a href="https://github.com/reduxjs/redux-thunk">Redux Thunk</a>.</p>
<pre><code>npm install react-redux redux redux-thunk</code></pre>
<p>There are more than one asynchronous action-handling middleware out there in the world. Redux Thunk happens to be one of the oldest and widely used.</p>
<p>Whenever you consider installing a library or framework, you should make sure that your existing application meets the expectations. For example, as of the time of this writing, to <a href="https://github.com/supasate/connected-react-router/blob/master/FAQ.md#how-to-navigate-with-redux-action">install “react-redux”</a>, your application needs to support <strong>React 16.8.3</strong> or later. Take a look in the <strong>package.json</strong> file to make sure that an acceptable version of React is listed in there. If not, you will need to upgrade the version of React used by this project by running something like <code>npm upgrade</code>.</p>
<h2 id="setting-up-the-store">Setting up the store</h2>
<p>The <em>store</em> is the object (and supporting objects and functions) that will contain the state of the application. This centralizes the state so that, presumably, you can better reason about it.</p>
<p>There are a couple of ways to organize your state management code, each with their own benefits. Redux has a list of different articles about <a href="https://redux.js.org/faq/code-structure/">this very topic</a>. You should choose to organize your code in a way that makes sense to your team (or follow any conventions that already exist). This walk-through will follow the <a href="https://github.com/erikras/ducks-modular-redux">Ducks</a> approach of layout.</p>
<p>In the <strong>src</strong> directory, create a new directory named <strong>store</strong>. In that new directory, create a new file named <strong>configureStore.js</strong>. In that file, put this code. This is boilerplate code and will appear in nearly every application that you have that uses Redux. A description of the contents follows the code block.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb75-1" title="1"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware<span class="op">,</span> combineReducers<span class="op">,</span> compose <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb75-2" title="2"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;redux-thunk&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb75-3" title="3"></a>
<a class="sourceLine" id="cb75-4" title="4"><span class="kw">const</span> composeEnhancers <span class="op">=</span> <span class="va">window</span>.<span class="at">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span> <span class="op">||</span> compose<span class="op">;</span></a>
<a class="sourceLine" id="cb75-5" title="5"></a>
<a class="sourceLine" id="cb75-6" title="6"><span class="kw">const</span> reducer <span class="op">=</span> <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb75-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb75-8" title="8"></a>
<a class="sourceLine" id="cb75-9" title="9"><span class="kw">const</span> configureStore <span class="op">=</span> initialState <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb75-10" title="10">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb75-11" title="11">    reducer<span class="op">,</span></a>
<a class="sourceLine" id="cb75-12" title="12">    initialState<span class="op">,</span></a>
<a class="sourceLine" id="cb75-13" title="13">    <span class="at">composeEnhancers</span>(<span class="at">applyMiddleware</span>(thunk))<span class="op">,</span></a>
<a class="sourceLine" id="cb75-14" title="14">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb75-15" title="15"><span class="op">};</span></a>
<a class="sourceLine" id="cb75-16" title="16"></a>
<a class="sourceLine" id="cb75-17" title="17"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<p>(If you’re looking in your console after putting this code in there, you’ll see an error about not having any valid reducers. That’s true, there are no valid reducers. You’ll fix that in just a moment.)</p>
<p>On those first two lines, the code imports the stuff it will need to create and configure a store.</p>
<ul>
<li><code>createStore</code> is the function from Redux that creates the state-management object</li>
<li><code>applyMiddleware</code> allows you to plug in extra functionality into the state-management workflow (in this case, Redux Thunk)</li>
<li><code>combineReducers</code> takes many reducers and combines them into a single one</li>
<li><code>compose</code> is a function that <em>composes</em> functions from right-to-left, that is, it puts them together, the return value of the right-most getting passed to the second right-most, return values getting passed from that to the third right-most, and so on, until the first function in the list returns its final value to the store (<a href="https://redux.js.org/api/compose">documentation</a> for compose)</li>
<li><code>thunk</code> is the middleware that will allow you to make asynchronous calls because you can’t do that in Redux actions</li>
</ul>
<p>The fourth line creates a new <code>composeEnhancers</code> variable that will be either the Redux DevTools special compose function, or the one from Redux, if DevTools is not installed. This allows browsers that have the DevTools installed to take advantage of watching the changes in the store.</p>
<p>The sixth and seventh lines is just the thing that combines the reducers for the store into a single reducer. More about that later.</p>
<p>The ninth line declares a function that gets exported at the end of the file that creates and configures the store with the <code>reducer</code>, the <code>initialState</code> passed into the function, and composes the React Thunk middleware and the Redux DevTools, if they exist.</p>
<p>To use this functionality, open <strong>src/index.js</strong> and add two imports to the top of the file.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb76-1" title="1"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="im">import</span> configureStore <span class="im">from</span> <span class="st">&#39;./store/configureStore&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Those two lines import a Context Provider from React Redux and the function you just created above. Now, under those lines and before the <code>ReactDOM.render</code> statement, create a store.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">const</span> store <span class="op">=</span> <span class="at">configureStore</span>()<span class="op">;</span></a></code></pre></div>
<p>Finally, wrap the <code>App</code> component in a <code>Provider</code> component that has a “store” property assigned the value of <code>store</code> that you created in the previous code snippet, just as you saw in the <em>Passing the Store</em> section of the <em>Usage with React</em> article you read in the homework preparing you for these topics.</p>
<p>If everything works, you should be able to view the Redux DevTools in your browser’s DevTools environment as a new tab. You should see the “@<span class="citation" data-cites="INIT">@INIT</span>” action that was run and an empty state.</p>
<figure>
<img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/aggregates/pokedex/redux-based/assets/redux-initial-state-devtools.png" alt="Redux DevTools initialization" /><figcaption>Redux DevTools initialization</figcaption>
</figure>
<h2 id="your-first-action-workflow">Your first action workflow</h2>
<p>Now, you will refactor the <code>LoginPanel</code> component to put the token it receives from the AJAX call into the Redux store. The rest of the application will remain the same, for now.</p>
<p>Open <code>LoginPanel</code> and review it. There are two “interesting” portions of this code, the <code>render</code> function which will redirect to the path “/” when a token exists (and show the login form if it does not), and the <code>handleSubmit</code> method that makes the actual AJAX call to get the token. These are the things that you will modify to make this work. It’s going to seem like a lot of code replacing just a few lines, but this will make your application easier to understand because all of the state changes will be encapsulated in their own area under the <strong>store</strong> directory. You won’t have to search through a bunch of components to figure out why the application as a whole is not working.</p>
<p>The first step is to make <code>LoginPanel</code> a <em>connected component</em>, that is, connect it to the Redux store’s pipeline. To do this, follow these steps:</p>
<ol type="1">
<li>Import <code>connect</code> from <code>react-redux</code> in the import section of the <code>LoginPanel</code>.</li>
<li><p>Remove the <code>export</code> line at the bottom and replace it with this.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> state <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb78-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb78-3" title="3">  <span class="op">};</span></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="op">};</span></a>
<a class="sourceLine" id="cb78-5" title="5"></a>
<a class="sourceLine" id="cb78-6" title="6"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb78-7" title="7">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb78-8" title="8">  <span class="op">};</span></a>
<a class="sourceLine" id="cb78-9" title="9"><span class="op">};</span></a>
<a class="sourceLine" id="cb78-10" title="10"></a>
<a class="sourceLine" id="cb78-11" title="11"><span class="co">// Yes, this looks funny, but you will often</span></a>
<a class="sourceLine" id="cb78-12" title="12"><span class="co">// see this kind of indentation in others&#39;</span></a>
<a class="sourceLine" id="cb78-13" title="13"><span class="co">// code when using React and Redux.</span></a>
<a class="sourceLine" id="cb78-14" title="14"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(</a>
<a class="sourceLine" id="cb78-15" title="15">  mapStateToProps<span class="op">,</span></a>
<a class="sourceLine" id="cb78-16" title="16">  mapDispatchToProps</a>
<a class="sourceLine" id="cb78-17" title="17">)(</a>
<a class="sourceLine" id="cb78-18" title="18">  LoginPanel</a>
<a class="sourceLine" id="cb78-19" title="19">)<span class="op">;</span></a></code></pre></div></li>
</ol>
<p>The last line of the code <em>connects</em> the <code>LoginPanel</code> to the Redux store. The two functions that you created above it, <code>mapStateToProps</code> and <code>mapDispatchToProps</code> are functions that you will write to help in translating state and actions for use in your component. The <code>mapStateToProps</code> function maps the state of the Redux store to the values that you want to show up in the <code>props</code> of the connected component. The <code>mapDispatchToProps</code> function maps complicated action calls to simple ones that your component can use.</p>
<p>The first thing you’ll need is one of those actions. This is going to be something to let your authentication run to get that token. In the <strong>src/store</strong> directory, create a new file named <strong>authentication.js</strong> which will contain all of the Redux-related stuff to handle authentication:</p>
<ul>
<li>the actions,</li>
<li>the action types,</li>
<li>the thunks (which are just actions that are allowed to perform calls that have use resources <em>outside</em> the function, like AJAX calls or putting something into local storage), and,</li>
<li>the reducers.</li>
</ul>
<p>The steps that you want the application to go through are:</p>
<ul>
<li>Make an AJAX call to sign in (that’s a <em>thunk</em>)</li>
<li>When the token returns, create an <em>action</em> that will send the token to the store</li>
<li>Create a reducer to put the token in the store</li>
</ul>
<p>Most of these steps will need something more, so if you see something not defined in one of these steps, you will get to it in a later step.</p>
<h3 id="the-thunk">The thunk</h3>
<p>In case you lost track, this goes in <strong>src/store/authentication.js</strong>.</p>
<p>First up, <em>thunks</em> are functions that return another function that takes a single function as its argument. The argument is the <code>dispatch</code> method used to dispatch actions to Redux. So, for example, the <code>login</code> thunk could have this form.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb79-1" title="1"><span class="im">export</span> <span class="kw">const</span> login <span class="op">=</span> (email<span class="op">,</span> password) <span class="kw">=&gt;</span> <span class="kw">async</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb79-2" title="2">  <span class="co">// Dispatch an action, here</span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="op">}</span></a></code></pre></div>
<p>That’s pretty weird, if you’ve never seen that syntax before, those double <code>=&gt;</code> signs in there. It’s a shortcut to write a function that returns a function. You could also write it like this:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb80-1" title="1"><span class="im">export</span> <span class="kw">const</span> login <span class="op">=</span> (email<span class="op">,</span> password) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb80-2" title="2">  <span class="cf">return</span> <span class="kw">async</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb80-3" title="3">    <span class="co">// Dispatch an action, here</span></a>
<a class="sourceLine" id="cb80-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb80-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>Once you get used to the double (or triple) <code>=&gt;</code> signs, it becomes second nature to write functions that return functions, that way.</p>
<p>Inside the login method, make a <code>fetch</code> call to the API using the same <code>fetch</code> call found in <code>LoginPanel</code>’s <code>handleSubmit</code> method. You’ll need to import <code>baseUrl</code> from the <strong>src/config.js</strong> module. You don’t have access to the state of the object, just the <code>email</code> and <code>password</code> that they’re passing in through your method call, so change the “body” parameter of the <code>fetch</code> from <code>JSON.stringify(this.state),</code> to <code>JSON.stringify({ email, password }),</code>.</p>
<p>For now, if the response from the fetch is ok, just get the token out of the response object and log it to the console.</p>
<p>Now, to hook up this thunk to your component, open <strong>src/LoginPanel.js</strong> and import the <code>login</code> thunk that you just created. At the bottom in the <code>mapDispatchToProps</code> function, add a “login” key that is a function that takes an email and password, and then dispatches the <code>login</code> thunk with those values.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb81-1" title="1"><span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb81-2" title="2">  <span class="dt">login</span><span class="op">:</span> (email<span class="op">,</span> password) <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">login</span>(email<span class="op">,</span> password))</a>
<a class="sourceLine" id="cb81-3" title="3"><span class="op">};</span></a></code></pre></div>
<p>Now, there’s a “login” property on the <code>props</code> handed to the <code>LoginPanel</code> component. The value of the “login” property is a function that takes an <em>email</em> and a <em>password</em>. Those then get handed to the <code>login</code> thunk which returns a function to the <code>dispatch</code> function of Redux. It’s functions all the way down.</p>
<p>Now, delete everything from the <code>handleSubmit</code> method <em>except</em> the line that prevents the default action. Replace it with a call to the function in the “login” property of the <code>props</code> like this.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">this</span>.<span class="va">props</span>.<span class="at">login</span>(<span class="kw">this</span>.<span class="va">state</span>.<span class="at">email</span><span class="op">,</span> <span class="kw">this</span>.<span class="va">state</span>.<span class="at">password</span>)<span class="op">;</span></a></code></pre></div>
<p>After the application refreshes, you should be able to click the <em>Login</em> button on the screen and see token appear after the AJAX call completes.</p>
<p>Now that you have the token, you need to dispatch another action, one that isn’t created yet, to set the token in the state so it can be used elsewhere. Remove the <code>console.log</code> statement in your <code>login</code> thunk and replace it with an invocation of the <code>dispatch</code> method that your thunk gets, dispatching an action creator named <code>setToken</code> with the token as its argument.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb83-1" title="1"><span class="at">dispatch</span>(<span class="at">setToken</span>(token))</a></code></pre></div>
<p>Now, it’s time to create that action.</p>
<h3 id="the-action">The action</h3>
<p>Actions are just plain objects that have, at a minimum, a “type” property. Action creators are just plain functions that return actions.</p>
<p>Below your import section and above the <code>login</code> thunk of your code in <strong>src/store/authentication.js</strong>, create a constant named <code>SET_TOKEN</code> and set it equal to the string <code>'pokedex/authentication/SET_TOKEN'</code>. You could make this string <em>anything</em>, it just needs to be unique within your application. This is merely the <a href="https://github.com/erikras/ducks-modular-redux">Ducks</a> convention.</p>
<p>Now, create a function <code>setToken</code> that takes a token as its one parameter, and returns an object that has a “type” property set to the <code>SET_TOKEN</code> constant and a “token” property set to the value passed into the parameter. Export the <code>setToken</code> function.</p>
<p>If you’ve done everything correctly to this point, when you click the <em>Login</em> button, you should now see an action appear in the Redux DevTools with the string that you set the <code>SET_TOKEN</code> constant to.</p>
<figure>
<img src="images/redux-set-token-action-devtools.png" alt="Redux DevTools with SET_TOKEN action" /><figcaption>Redux DevTools with SET_TOKEN action</figcaption>
</figure>
<p>Now, you need to tell Redux how to handle that action with a reducer.</p>
<h2 id="the-reducer">The reducer</h2>
<p>Somewhere in the <strong>src/store/authentication.js</strong> file, export a <code>reducer</code> function as the default value of the module. The <code>state</code> parameter gets a default value of an empty object because Redux does not like <code>undefined</code> values returned from reducers. Redux <em>will</em> call your reducer when it creates the store with <code>undefined</code> just to mess with you.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb84-1" title="1"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">reducer</span>(state <span class="op">=</span> <span class="op">{},</span> action) <span class="op">{</span></a>
<a class="sourceLine" id="cb84-2" title="2">  <span class="co">// Your code in here.</span></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="op">}</span></a></code></pre></div>
<p>In that reducer, you want to check if the “type” property of <code>action</code> is equal to the <code>SET_TOKEN</code> constant. Every reducer is called with every action, so you have to do this check. If it is, then you should return an object with the token in it. If it doesn’t, then just return the state unaltered. Idiomatic Redux usually uses a <code>switch</code> statement to do this with each <code>case</code> statement handling a different action type.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb85-1" title="1"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">reducer</span>(state <span class="op">=</span> <span class="op">{},</span> action) <span class="op">{</span></a>
<a class="sourceLine" id="cb85-2" title="2">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb85-3" title="3">    <span class="cf">case</span> <span class="dt">SET_TOKEN</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb85-4" title="4">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb85-5" title="5">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb85-6" title="6">        <span class="dt">token</span><span class="op">:</span> <span class="va">action</span>.<span class="at">token</span><span class="op">,</span></a>
<a class="sourceLine" id="cb85-7" title="7">      <span class="op">};</span></a>
<a class="sourceLine" id="cb85-8" title="8">    <span class="op">}</span></a>
<a class="sourceLine" id="cb85-9" title="9"></a>
<a class="sourceLine" id="cb85-10" title="10">    <span class="cf">default</span><span class="op">:</span> <span class="cf">return</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb85-11" title="11">  <span class="op">}</span></a>
<a class="sourceLine" id="cb85-12" title="12"><span class="op">}</span></a></code></pre></div>
<h3 id="adding-the-reducer-to-the-store">Adding the reducer to the store</h3>
<p>Now that you have the reducer handling the action, you must add it to the reducer in <strong>src/store/configureStore.js</strong>. Open up that file and import the default value as <code>authentication</code> from the <strong>src/store/authentication.js</strong> module.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb86-1" title="1"><span class="im">import</span> authentication <span class="im">from</span> <span class="st">&#39;./authentication&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Then, in the <code>combineReducers</code> invocation, add <code>authentication</code> as a key and value.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">const</span> reducer <span class="op">=</span> <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb87-2" title="2">  authentication</a>
<a class="sourceLine" id="cb87-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>After the page reloads, when you click the <em>Login</em> button, you should now see the authentication and token appear in the right pane of the Redux DevTools. (You may need to select the action in the left pane.)</p>
<h2 id="using-the-token">Using the token</h2>
<p>Now, you’ve come full circle. You’re going to use the token in the store to inform the <code>LoginPanel</code> that it needs to close. In the <code>render</code> function, the code uses <code>this.state.token</code> to determine whether or not to redirect. You want that to use <code>this.props.token</code>, now, so change it to that.</p>
<p>To get the token value from the state of the Redux store into the <code>props</code>, you use <code>mapStateToProps</code> function that you created below. Change it to read like this, now, which takes the value of the token stored in the state and puts it into the “token” property of what will be passed to <code>LoginPanel</code> in its <code>props</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> state <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb88-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb88-3" title="3">    <span class="dt">token</span><span class="op">:</span> <span class="va">state</span>.<span class="va">authentication</span>.<span class="at">token</span><span class="op">,</span></a>
<a class="sourceLine" id="cb88-4" title="4">  <span class="op">};</span></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="op">};</span></a></code></pre></div>
<p>Now, when you click the <em>Login</em> button, it redirects the application back to “/”. However, because <code>App</code> relies on its own state to get updated from a call to its <code>updateToken</code> method, it goes into an recursive loop of redirecting back and forth between the <code>App</code> component and the <code>LoginPanel</code>. You’ll fix that in the next section.</p>
<hr />
<h1 id="more-state-moving">More State Moving</h1>
<p>The application is cleaner, but now has that bug of infinite redirecting. You will first fix that.</p>
<h2 id="fixing-the-loop">Fixing the loop</h2>
<p>In the <code>App</code> component, it would change state in response to the <code>LoginPanel</code> calling the <code>updateToken</code> method. The <code>LoginPanel</code> no longer does that because it dispatches its information to a thunk that makes the AJAX call and, in turns, dispatches an action that updates the Redux store. Then, <code>LoginPanel</code> uses the value from the store to no that something good has happened. You need to have <code>App</code> do the same.</p>
<p>Since <code>updateToken</code> is no longer used, remove the method and all of its uses from the <code>App</code> component.</p>
<p>When you have that done, you may notice that the route that shows the <code>LoginPanel</code> looks like this.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb89-1" title="1"><span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/login&quot;</span></a>
<a class="sourceLine" id="cb89-2" title="2">  render<span class="op">={</span>props <span class="kw">=&gt;</span> <span class="op">&lt;</span>LoginPanel <span class="op">{</span>...<span class="at">props</span><span class="op">}</span> /&gt;<span class="op">}</span> /&gt;</a></code></pre></div>
<p>That is rendering <code>LoginPanel</code> and passing its props to it. That’s just like using the “component” property of the <code>Route</code> component, so change it to use that instead of the more expensive “render” property.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb90-1" title="1"><span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/login&quot;</span> component<span class="op">={</span>LoginPanel<span class="op">}</span> /&gt;</a></code></pre></div>
<p>You’re still in a render loop, so that hasn’t fixed it. Time to connect <code>App</code> to the Redux store.</p>
<ol type="1">
<li>Like you did in <code>LoginPanel</code>, import the <code>connect</code> function from the “react-redux” module.</li>
<li>Then, just like you did in <code>LoginPanel</code>, declare <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions after the component.</li>
</ol>
<ul>
<li>In the <code>mapStateToProps</code> function, map the token to a property named “token” identically to the way it is done in <code>LoginPanel</code>.</li>
<li>You have no actions, right now, so leave <code>mapDispatchToProps</code> just returning an empty object.</li>
</ul>
<ol start="3" type="1">
<li>Finally, connect <code>App</code> to the Redux store using those functions.</li>
</ol>
<p>That puts the value of the token into the props. In the actual <code>App</code> component, now find everywhere that uses <code>this.state.token</code> and replace it with <code>this.props.token</code>.</p>
<p>Try logging in, again. Still doesn’t work. That’s because <code>App</code> relies on another setting in its state named “needLogin” which is just a Boolean value that is basically the opposite of whether the token has a value. If there is a token, there is no need to login. If there is no token, there is a need to login. You can figure that out in the <code>mapStateToProps</code> function! Create another property, one named “needLogin”, in the object returned from the function. If there <em>is</em> a value in <code>state.authentication.token</code>, then set it to <code>false</code>. If there is <em>no</em> value (or an empty string) in <code>state.authentication.token</code>, then set “needLogin” to <code>true</code>. Once you have that, find every use of <code>this.state.needLogin</code> and replace it with <code>this.props.needLogin</code>.</p>
<p>You have now fixed the problem with the infinite redirects! And, once you log into the application, you can check that the <code>App</code> component <em>is</em> rendering the <code>PokemonBrowser</code> component. However, it is not showing anything. That’s because the <code>App</code> component calls its <code>loadPokemon</code> method in the <code>componentDidMount</code> method. There’s no token at that time in its state because the token now comes from Redux.</p>
<p>What would be great is if, after logging in, the <code>login</code> action loaded the Pokemon for you, put them in the store, and <code>PokemonBrowser</code> could just use them directly.</p>
<p>Oh, that’s what you’ll do next.</p>
<h2 id="getting-the-list-of-pokemon">Getting the list of Pokemon</h2>
<p>Now, you need some actions, thunks, and reducers for Pokemon, not authentication. Create a new file <strong>src/store/pokemon.js</strong>. In there, create the following items.</p>
<ul>
<li>An action type named <code>LOAD</code> with a value of ‘pokedex/pokemon/LOAD’</li>
<li>An action creator named <code>load</code> that takes in a list of Pokemon and creates an action with the type of <code>LOAD</code> and the list of Pokemon in it</li>
<li>A reducer that checks for the “LOAD” action and adds the list of Pokemon to the state (and returns just the state if the action is not “LOAD”)</li>
<li>Make sure the reducer has a default value for its <code>state</code> parameter</li>
</ul>
<p>Now, you need to make a thunk that will make the AJAX call. Call your think “getPokemon”. The thunk needs the token from the state to make its API call. The function that gets the “dispatch” parameter can also get a second parameter, a function conventionally called “getState”. Your thunk could look like this.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb91-1" title="1"><span class="im">export</span> <span class="kw">const</span> getPokemon <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="kw">async</span> (dispatch<span class="op">,</span> getState) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb91-2" title="2">  <span class="kw">const</span> <span class="op">{</span> <span class="dt">authentication</span><span class="op">:</span> <span class="op">{</span> token <span class="op">}</span> <span class="op">}</span> <span class="op">=</span> <span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb91-3" title="3">  <span class="co">// AJAX call</span></a>
<a class="sourceLine" id="cb91-4" title="4">  <span class="co">// Handle response</span></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="op">};</span></a></code></pre></div>
<p>Then, in <strong>configureStore.js</strong>, import the default reducer and add it to the <code>combineReducers</code> argument as the “pokemon” property next to “authentication”.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">const</span> reducer <span class="op">=</span> <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb92-2" title="2">  authentication<span class="op">,</span></a>
<a class="sourceLine" id="cb92-3" title="3">  pokemon<span class="op">,</span></a>
<a class="sourceLine" id="cb92-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now, you just need to kick off that AJAX call. It seems only reasonable that the component that actually needs it kicks it off, the <code>PokemonBrowser</code> component. In <code>PokemonBrowser</code>, do the following:</p>
<ul>
<li>Import the <code>connect</code> function from “react-redux”</li>
<li>Import the <code>getPokemon</code> thunk you just created</li>
<li>Create a <code>mapStateToProps</code> function that maps the list of Pokemon from <code>state.pokemon.list</code> (or whatever you called your property in the reducer) to a property named “pokemon”</li>
<li>Create a <code>mapDispatchToProps</code> function that returns an object with a property named “getPokemon” that dispatches the <code>getPokemon</code> thunk you imported</li>
<li>Connect your component to the Redux store using <code>connect</code>, <code>mapStateToProps</code>, and <code>mapDispatchToProps</code></li>
<li>Add a <code>componentDidMount</code> method to the <code>PokemonBrowser</code> component and call <code>this.props.getPokemon()</code> from it</li>
</ul>
<p>Now, when you log into the application, you should see two actions in your Redux store!</p>
<figure>
<img src="https://github.com/supasate/connected-react-router" alt="Pokemon LOAD action in Redux DevTools" /><figcaption>Pokemon LOAD action in Redux DevTools</figcaption>
</figure>
<p>More importantly, you should see the list of Pokemon in the <code>PokemonBrowser</code> actually appear in the browser.</p>
<h2 id="clean-up-the-app-component">Clean up the App component</h2>
<p>Previously, all of the fetching logic for the list of Pokemon was handled by the <code>App</code> component. You can now get rid of the <code>loadPokemon</code> method and clean up any calls to it. Also, anywhere that refers to <code>this.state.pokemon</code> or using <code>setState</code> to update the “pokemon” property, you should get rid of all of that. This makes the <code>handleCreated</code> method empty, so get rid of that and all references to it, too, in the <code>App</code> component.</p>
<p>Because the <code>App</code> component doesn’t make any AJAX calls, anymore, it doesn’t need the token from the state. Remove the “token” property in <code>mapStateToProps</code> and everywhere <code>token</code> is used in the <code>App</code> component. Include the call to local storage, too, in the deleting of things. You can remove the import of <code>baseUrl</code>, too, because there are no AJAX calls in the file.</p>
<p>Now, because <code>cProps</code> in the <code>render</code> method is empty, delete it and its uses in the <code>PrivateRoute</code> components below it. Now that the code is not using <code>cProps</code>, you can delete the parameter and its use from the <code>PrivateRoute</code> component on line 8 (or so) of the <strong>src/App.js</strong> file.</p>
<h2 id="storing-the-token-in-local-storage">Storing the token in local storage</h2>
<p>Actions that use outside resources like AJAX calls and local storage <em>must</em> be created in thunks. Back in the <strong>src/store/authentication.js</strong> module, do two things:</p>
<ul>
<li>Create a constant named <code>TOKEN_KEY</code> and set it equal to some non-empty string</li>
<li>In the <code>login</code> thunk, between getting the token from the response and dispatching the <code>setToken</code> action, write the token to local storage using the constant <code>TOKEN_KEY</code></li>
</ul>
<h2 id="reading-the-token-out-of-local-storage">Reading the token out of local storage</h2>
<p>You need a new thunk to do this. Create a thunk named <code>loadToken</code> that takes no parameters, and returns a function that accepts a “dispatch” parameter. Then, implement it to read the value from local storage using the <code>TOKEN_KEY</code> constant. If a value comes back, have it dispatch the <code>setToken</code> action.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb93-1" title="1"><span class="im">export</span> <span class="kw">const</span> loadToken <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="kw">async</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb93-2" title="2">  <span class="co">// Read the token from local</span></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="op">};</span></a></code></pre></div>
<p>In the <code>App</code> component, import the <code>loadToken</code> thunk. Use it in the <code>mapDispatchToProps</code> by mapping the dispatch of the <code>loadToken</code> thunk to a property of the same name.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb94-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb94-3" title="3">    <span class="dt">loadToken</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">loadToken</span>())<span class="op">,</span></a>
<a class="sourceLine" id="cb94-4" title="4">  <span class="op">};</span></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="op">};</span></a></code></pre></div>
<p>Invoke that <code>loadToken</code> method in the <code>componentDidMount</code> method of the <code>App</code> component.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">async</span> <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb95-2" title="2">  <span class="kw">this</span>.<span class="at">setState</span>(<span class="op">{</span> <span class="dt">loaded</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb95-3" title="3">  <span class="kw">this</span>.<span class="va">props</span>.<span class="at">loadToken</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb95-4" title="4"><span class="op">}</span></a></code></pre></div>
<p>The moment you do that, the page should refresh and you should see the Pokemon browser rather than the login form.</p>
<p>You’re halfway home!</p>
<hr />
<p>The application is cleaner, but now has that bug of infinite redirecting. You will first fix that.</p>
<h2 id="fixing-the-loop-1">Fixing the loop</h2>
<p>In the <code>App</code> component, it would change state in response to the <code>LoginPanel</code> calling the <code>updateToken</code> method. The <code>LoginPanel</code> no longer does that because it dispatches its information to a thunk that makes the AJAX call and, in turns, dispatches an action that updates the Redux store. Then, <code>LoginPanel</code> uses the value from the store to no that something good has happened. You need to have <code>App</code> do the same.</p>
<p>Since <code>updateToken</code> is no longer used, remove the method and all of its uses from the <code>App</code> component.</p>
<p>When you have that done, you may notice that the route that shows the <code>LoginPanel</code> looks like this.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb96-1" title="1"><span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/login&quot;</span></a>
<a class="sourceLine" id="cb96-2" title="2">  render<span class="op">={</span>props <span class="kw">=&gt;</span> <span class="op">&lt;</span>LoginPanel <span class="op">{</span>...<span class="at">props</span><span class="op">}</span> /&gt;<span class="op">}</span> /&gt;</a></code></pre></div>
<p>That is rendering <code>LoginPanel</code> and passing its props to it. That’s just like using the “component” property of the <code>Route</code> component, so change it to use that instead of the more expensive “render” property.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb97-1" title="1"><span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/login&quot;</span> component<span class="op">={</span>LoginPanel<span class="op">}</span> /&gt;</a></code></pre></div>
<p>You’re still in a render loop, so that hasn’t fixed it. Time to connect <code>App</code> to the Redux store.</p>
<ol type="1">
<li>Like you did in <code>LoginPanel</code>, import the <code>connect</code> function from the “react-redux” module.</li>
<li>Then, just like you did in <code>LoginPanel</code>, declare <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions after the component.</li>
</ol>
<ul>
<li>In the <code>mapStateToProps</code> function, map the token to a property named “token” identically to the way it is done in <code>LoginPanel</code>.</li>
<li>You have no actions, right now, so leave <code>mapDispatchToProps</code> just returning an empty object.</li>
</ul>
<ol start="3" type="1">
<li>Finally, connect <code>App</code> to the Redux store using those functions.</li>
</ol>
<p>That puts the value of the token into the props. In the actual <code>App</code> component, now find everywhere that uses <code>this.state.token</code> and replace it with <code>this.props.token</code>.</p>
<p>Try logging in, again. Still doesn’t work. That’s because <code>App</code> relies on another setting in its state named “needLogin” which is just a Boolean value that is basically the opposite of whether the token has a value. If there is a token, there is no need to login. If there is no token, there is a need to login. You can figure that out in the <code>mapStateToProps</code> function! Create another property, one named “needLogin”, in the object returned from the function. If there <em>is</em> a value in <code>state.authentication.token</code>, then set it to <code>false</code>. If there is <em>no</em> value (or an empty string) in <code>state.authentication.token</code>, then set “needLogin” to <code>true</code>. Once you have that, find every use of <code>this.state.needLogin</code> and replace it with <code>this.props.needLogin</code>.</p>
<p>You have now fixed the problem with the infinite redirects! And, once you log into the application, you can check that the <code>App</code> component <em>is</em> rendering the <code>PokemonBrowser</code> component. However, it is not showing anything. That’s because the <code>App</code> component calls its <code>loadPokemon</code> method in the <code>componentDidMount</code> method. There’s no token at that time in its state because the token now comes from Redux.</p>
<p>What would be great is if, after logging in, the <code>login</code> action loaded the Pokemon for you, put them in the store, and <code>PokemonBrowser</code> could just use them directly.</p>
<p>Oh, that’s what you’ll do next.</p>
<h2 id="getting-the-list-of-pokemon-1">Getting the list of Pokemon</h2>
<p>Now, you need some actions, thunks, and reducers for Pokemon, not authentication. Create a new file <strong>src/store/pokemon.js</strong>. In there, create the following items.</p>
<ul>
<li>An action type named <code>LOAD</code> with a value of ‘pokedex/pokemon/LOAD’</li>
<li>An action creator named <code>load</code> that takes in a list of Pokemon and creates an action with the type of <code>LOAD</code> and the list of Pokemon in it</li>
<li>A reducer that checks for the “LOAD” action and adds the list of Pokemon to the state (and returns just the state if the action is not “LOAD”)</li>
<li>Make sure the reducer has a default value for its <code>state</code> parameter</li>
</ul>
<p>Now, you need to make a thunk that will make the AJAX call. Call your think “getPokemon”. The thunk needs the token from the state to make its API call. The function that gets the “dispatch” parameter can also get a second parameter, a function conventionally called “getState”. Your thunk could look like this.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb98-1" title="1"><span class="im">export</span> <span class="kw">const</span> getPokemon <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="kw">async</span> (dispatch<span class="op">,</span> getState) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb98-2" title="2">  <span class="kw">const</span> <span class="op">{</span> <span class="dt">authentication</span><span class="op">:</span> <span class="op">{</span> token <span class="op">}</span> <span class="op">}</span> <span class="op">=</span> <span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb98-3" title="3">  <span class="co">// AJAX call</span></a>
<a class="sourceLine" id="cb98-4" title="4">  <span class="co">// Handle response</span></a>
<a class="sourceLine" id="cb98-5" title="5"><span class="op">};</span></a></code></pre></div>
<p>Then, in <strong>configureStore.js</strong>, import the default reducer and add it to the <code>combineReducers</code> argument as the “pokemon” property next to “authentication”.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">const</span> reducer <span class="op">=</span> <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb99-2" title="2">  authentication<span class="op">,</span></a>
<a class="sourceLine" id="cb99-3" title="3">  pokemon<span class="op">,</span></a>
<a class="sourceLine" id="cb99-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now, you just need to kick off that AJAX call. It seems only reasonable that the component that actually needs it kicks it off, the <code>PokemonBrowser</code> component. In <code>PokemonBrowser</code>, do the following:</p>
<ul>
<li>Import the <code>connect</code> function from “react-redux”</li>
<li>Import the <code>getPokemon</code> thunk you just created</li>
<li>Create a <code>mapStateToProps</code> function that maps the list of Pokemon from <code>state.pokemon.list</code> (or whatever you called your property in the reducer) to a property named “pokemon”</li>
<li>Create a <code>mapDispatchToProps</code> function that returns an object with a property named “getPokemon” that dispatches the <code>getPokemon</code> thunk you imported</li>
<li>Connect your component to the Redux store using <code>connect</code>, <code>mapStateToProps</code>, and <code>mapDispatchToProps</code></li>
<li>Add a <code>componentDidMount</code> method to the <code>PokemonBrowser</code> component and call <code>this.props.getPokemon()</code> from it</li>
</ul>
<p>Now, when you log into the application, you should see two actions in your Redux store!</p>
<figure>
<img src="https://github.com/supasate/connected-react-router" alt="Pokemon LOAD action in Redux DevTools" /><figcaption>Pokemon LOAD action in Redux DevTools</figcaption>
</figure>
<p>More importantly, you should see the list of Pokemon in the <code>PokemonBrowser</code> actually appear in the browser.</p>
<h2 id="clean-up-the-app-component-1">Clean up the App component</h2>
<p>Previously, all of the fetching logic for the list of Pokemon was handled by the <code>App</code> component. You can now get rid of the <code>loadPokemon</code> method and clean up any calls to it. Also, anywhere that refers to <code>this.state.pokemon</code> or using <code>setState</code> to update the “pokemon” property, you should get rid of all of that. This makes the <code>handleCreated</code> method empty, so get rid of that and all references to it, too, in the <code>App</code> component.</p>
<p>Because the <code>App</code> component doesn’t make any AJAX calls, anymore, it doesn’t need the token from the state. Remove the “token” property in <code>mapStateToProps</code> and everywhere <code>token</code> is used in the <code>App</code> component. Include the call to local storage, too, in the deleting of things. You can remove the import of <code>baseUrl</code>, too, because there are no AJAX calls in the file.</p>
<p>Now, because <code>cProps</code> in the <code>render</code> method is empty, delete it and its uses in the <code>PrivateRoute</code> components below it. Now that the code is not using <code>cProps</code>, you can delete the parameter and its use from the <code>PrivateRoute</code> component on line 8 (or so) of the <strong>src/App.js</strong> file.</p>
<h2 id="storing-the-token-in-local-storage-1">Storing the token in local storage</h2>
<p>Actions that use outside resources like AJAX calls and local storage <em>must</em> be created in thunks. Back in the <strong>src/store/authentication.js</strong> module, do two things:</p>
<ul>
<li>Create a constant named <code>TOKEN_KEY</code> and set it equal to some non-empty string</li>
<li>In the <code>login</code> thunk, between getting the token from the response and dispatching the <code>setToken</code> action, write the token to local storage using the constant <code>TOKEN_KEY</code></li>
</ul>
<h2 id="reading-the-token-out-of-local-storage-1">Reading the token out of local storage</h2>
<p>You need a new thunk to do this. Create a thunk named <code>loadToken</code> that takes no parameters, and returns a function that accepts a “dispatch” parameter. Then, implement it to read the value from local storage using the <code>TOKEN_KEY</code> constant. If a value comes back, have it dispatch the <code>setToken</code> action.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb100-1" title="1"><span class="im">export</span> <span class="kw">const</span> loadToken <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="kw">async</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb100-2" title="2">  <span class="co">// Read the token from local</span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="op">};</span></a></code></pre></div>
<p>In the <code>App</code> component, import the <code>loadToken</code> thunk. Use it in the <code>mapDispatchToProps</code> by mapping the dispatch of the <code>loadToken</code> thunk to a property of the same name.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb101-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb101-3" title="3">    <span class="dt">loadToken</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">loadToken</span>())<span class="op">,</span></a>
<a class="sourceLine" id="cb101-4" title="4">  <span class="op">};</span></a>
<a class="sourceLine" id="cb101-5" title="5"><span class="op">};</span></a></code></pre></div>
<p>Invoke that <code>loadToken</code> method in the <code>componentDidMount</code> method of the <code>App</code> component.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">async</span> <span class="at">componentDidMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb102-2" title="2">  <span class="kw">this</span>.<span class="at">setState</span>(<span class="op">{</span> <span class="dt">loaded</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb102-3" title="3">  <span class="kw">this</span>.<span class="va">props</span>.<span class="at">loadToken</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="op">}</span></a></code></pre></div>
<p>The moment you do that, the page should refresh and you should see the Pokemon browser rather than the login form.</p>
<p>You’re halfway home!</p>
<hr />
<h1 id="making-decisions-about-state">Making Decisions About State</h1>
<p>Now, it’s time to log out of the application. Do that with the following steps.</p>
<p>The steps that the application will take are these:</p>
<ol type="1">
<li>Someone clicks the logout button</li>
<li>The <code>LogoutButton</code> component dispatches a thunk</li>
<li>The thunk makes the AJAX call to logout</li>
<li>If that AJAX call succeeds, remove the token from local storage and dispatch an action to remove the token from the store</li>
<li>Redux will invoke a reducer that removes the token from the store</li>
<li>The <code>LogoutButton</code> will redirect the application back to “/login”</li>
</ol>
<p>In <strong>src/store/authentication.js</strong>:</p>
<ul>
<li>Create a new action type named <code>REMOVE_TOKEN</code></li>
<li>Create a new action creator that returns an action with just the “type” property set to the value of <code>REMOVE_TOKEN</code></li>
<li>Create a thunk named <code>logout</code> that
<ul>
<li>makes an AJAX call to the API to <code>DELETE /api/session</code> (using the token in the state)</li>
<li>if the response is ok, then
<ul>
<li>removes the item from local storage with the key <code>TOKEN_KEY</code></li>
<li>dispatches the <code>removeToken</code> action</li>
</ul></li>
</ul></li>
<li><p>Handles the <code>REMOVE_TOKEN</code> action type in the reducer by creating a new object that does <em>not</em> have the “token” key in it and returning that.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb103-1" title="1"><span class="cf">case</span> REMOVE_TOKEN<span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb103-2" title="2">  <span class="kw">const</span> newState <span class="op">=</span> <span class="op">{</span> ...<span class="at">state</span> <span class="op">};</span></a>
<a class="sourceLine" id="cb103-3" title="3">  <span class="kw">delete</span> <span class="va">newState</span>.<span class="at">token</span><span class="op">;</span></a>
<a class="sourceLine" id="cb103-4" title="4">  <span class="cf">return</span> newState<span class="op">;</span></a>
<a class="sourceLine" id="cb103-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>Remember that handlers in reducers <em>must</em> return new objects if they want to modify the state.</p></li>
</ul>
<p>In <strong>src/LogoutButton.js</strong>:</p>
<p>(If you make a mistake with this and get into an inconsistent state, just delete all of the contents of your local storage and refresh your browser.)</p>
<ul>
<li>Import <code>connect</code> from “react-redux”</li>
<li>Import the <code>logout</code> thunk you just created</li>
<li>Create the <code>mapStateToProps</code> and set a property named <code>loggedOut</code> to <code>true</code> if the token in the state is empty, and <code>false</code> if there is a value for the token in the state</li>
<li>Create the <code>mapDispatchToProps</code> and set the “logout” property equal to a function that dispatches the result of the <code>logout</code> thunk you imported</li>
<li>In the <code>LogoutButton</code>’s method named “logout”, instead of making an AJAX call, have it call <code>this.props.logout()</code>, instead</li>
<li>Get rid of the</li>
<li>Get rid of initializing the state in the constructor</li>
<li>Change the use of <code>this.state.loggedOut</code> to <code>this.props.loggedOut</code></li>
<li>Remove any unused imports</li>
</ul>
<p>If you check the console, now, you’ll see that Babel is reporting a “useless” constructor. Sure enough, it is. <code>LogoutButton</code> no longer has any state, so there’s no reason to leave it as a class-based component. Convert it to a function-based component. If you’ve followed these instructions, your <code>LogoutButton</code> should end up looking something like this.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">const</span> LogoutButton <span class="op">=</span> props <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb104-2" title="2">  <span class="va">props</span>.<span class="at">loggedOut</span> <span class="op">?</span></a>
<a class="sourceLine" id="cb104-3" title="3">    <span class="op">&lt;</span>Redirect to<span class="op">=</span><span class="st">&quot;/login&quot;</span> /&gt; :</a>
<a class="sourceLine" id="cb104-4" title="4">    <span class="op">&lt;</span>div id<span class="op">=</span><span class="st">&quot;logout-button-holder&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb104-5" title="5">      <span class="op">&lt;</span>button onClick<span class="op">={</span><span class="va">props</span>.<span class="at">logout</span><span class="op">}&gt;</span>Logout&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb104-6" title="6">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb104-7" title="7"><span class="op">;</span></a></code></pre></div>
<hr />
<h1 id="the-rest-of-it">The Rest Of It</h1>
<p>You have now been given instructions on how to refactor components from managing global application state to putting it in Redux. There are two more pieces left, the “select the current Pokemon” functionality and the “create a new Pokemon” functionality. Refactor the application so those are Redux-supported, as well.</p>
<h2 id="select-the-current-pokemon">Select the current Pokemon</h2>
<p>The place to start, here, is to determine how the click of the navigation item on the left gets handled. It’s a <code>NavLink</code>, so the <code>BrowserRouter</code> in the <code>App</code> component handles that by routing to the <code>PokemonBrowser</code> with the route parameters. The <code>PokemonBrowser</code> then routes to the <code>PokemonDetail</code> with a <code>Route</code> component. In the <code>PokemonDetail</code> component, if the value of the <code>this.props.match.params.id</code> changes, then the <code>loadPokemon</code> method is called which, in turn, makes an AJAX call. And, there it is! The AJAX call.</p>
<p>This is like everything else, create a thunk, an action type, yada yada yada.</p>
<ul>
<li>Create a thunk (similar to what you did for logging in) to load the current Pokemon that
<ul>
<li>accepts an id</li>
<li>loads the Pokemon from an AJAX call</li>
<li>dispatches a “set current Pokemon” action</li>
</ul></li>
<li>Create a reducer that handles the “set current Pokemon” action by adding it to the state</li>
<li>Connect the <code>PokemonDetail</code> to the Redux store by
<ul>
<li>mapping the current Pokemon information in the state to its props, and</li>
<li>mapping the “load the current Pokemon” thunk to its props with a <code>dispatch</code> call (don’t forget the id parameter)</li>
</ul></li>
</ul>
<h2 id="creating-a-new-pokemon">Creating a new Pokemon</h2>
<p>This is very similar to the login stuff you did with <code>LoginPanel</code>. In the <code>PokemonForm</code>, have</p>
<ul>
<li>the <code>componentDidMount</code> method call a thunk to load the Pokemon types</li>
<li>the <code>handleSubmit</code> method call a thunk to post the form information to the API</li>
</ul>
<p>In moving the Pokemon type fetching from the state to the props, you may end up getting an error that there is no method “map” of undefined. If that’s the case, in the reducer in your <strong>src/store/pokemon.js</strong> file, have the default state include an array for the “types” property.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb105-1" title="1"><span class="co">// CODE SNIPPET</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">reducer</span>(state <span class="op">=</span> <span class="op">{</span> <span class="dt">types</span><span class="op">:</span> [] <span class="op">},</span> action) <span class="op">{</span></a></code></pre></div>
<p>That’s the power of default parameters and initial state!</p>
<p>The action types, action creators, and thunk created to do this should go into the <strong>src/store/pokemon.js</strong> module. When the AJAX call succeeds to create the new Pokemon, have it <em>then</em> dispatch the <code>getPokemon</code> thunk to get a new list of Pokemon. Redux and React will add a new Pokemon to the end of the list. That’s why you have to provide the “key” property in lists of things, so that React will efficiently determine if something in the list needs to get changed, added, or deleted.</p>
<p>The only “new” part, here, is the coordination between <code>PokemonForm</code> and <code>PokemonBrowser</code> to determine if it should show a form. This is up to you to decide, if showing the create form is part of the global application state (and should exist in the Redux store), or if it is part of the “local” state between the two components and be managed by <code>PokemonForm</code> invoking a function passed to it by <code>PokemonBrowser</code>. The solution choose the former solution.</p>
<h2 id="bonus-extend-the-functionality">Bonus: Extend the functionality</h2>
<p>Think about adding</p>
<ul>
<li>A <em>Cancel</em> button on the form that hides it</li>
<li>Error messages for the forms when something bad happens</li>
</ul>
<h2 id="bonus-connected-react-router">Bonus: Connected React Router</h2>
<p>Rather than relying on <code>Redirect</code> routes in your application, you can use actions to manage the URL of your application. Install <a href="https://github.com/supasate/connected-react-router">Connected React Router</a> and remove all <code>Redirect</code> components from the application, replacing them with dispatched <code>push</code> actions. Check out the <a href="https://github.com/supasate/connected-react-router/blob/master/FAQ.md#how-to-navigate-with-redux-action">How to navigation with Redux action</a> article in the Connected React Router documentation.</p>
<hr />
<h1 id="giphy-search-project">Giphy Search Project</h1>
<p>Today’s project will help you become more comfortable with the full Redux cycle! You will build out a single Redux cycle for a Giphy search tool.</p>
<p>When a user enters a search query, a fetch action will use the search endpoint from the Giphy API to return the fetch response. The action will then be dispatched to update the application’s global state provided by the Redux store. Your application will then use a slice of state to render an index of GIF results.</p>
<p>Your completed project will look something like this:</p>
<figure>
<img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/react-hooks/assets/giphy-search.gif" alt="giphy-search" /><figcaption>giphy-search</figcaption>
</figure>
<h2 id="phase-0-set-up-the-project">Phase 0: Set up the project</h2>
<p>You’ll begin by cloning this repository containing basic skeleton files and the conventional frontend folders (<code>actions</code>, <code>components</code>, <code>reducers</code>, and <code>util</code>).</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb106-1" title="1"><span class="fu">git</span> clone https://github.com/appacademy-starters/react-redux-giphy-starter.git</a></code></pre></div>
<p>Take a moment to familiarize yourself with the file structure. Look inside all the frontend files and note the <code>TODO</code> notes in each file skeleton. Throughout the next phases of the project, you’ll finish all the tasks listed in the <code>TODO</code> notes to create your very own Giphy search app!</p>
<p>After you have reviewed the <code>TODO</code> notes, run <code>npm install</code> to install your application’s packages. Note that you have <code>redux</code>, <code>react-redux</code>, <code>redux-thunk</code>, and <code>redux-logger</code> already listed as dependencies in your project’s <code>package.json</code> file. You’ll use Redux <code>thunk</code> as middleware to connect (or <em>dispatch</em>) your fetch results into the Redux store. You’ll use Redux <code>logger</code> as middleware to automatically console log your dispatched actions.</p>
<h3 id="component-overview">Component overview</h3>
<p>Now that you’re acquainted with the file structure, let’s map out an overview of the component hierarchy:</p>
<pre><code>Root
  AppContainer
    App
      SearchBar
      Gifs</code></pre>
<ul>
<li>The <code>Root</code> component is responsible for providing the component tree with the Redux <code>store</code>. It renders the <code>AppContainer</code>.</li>
<li>The <code>AppContainer</code> passes the <code>gifs</code> slice of state and the dispatched <code>fetchGifs</code> action creator as props to the <code>App</code> component. It wraps the <code>App</code> component to connect the component to the Redux store.</li>
<li>The <code>App</code> component renders the <code>GifsList</code> and the <code>SearchBar</code>. It uses its <code>gifs</code> prop (passed into <code>App</code> through <code>mapStateToProps</code>) to create and pass a <code>gifUrls</code> array as a prop to the <code>GifsList</code>. It also uses its <code>fetchGifs</code> prop (passed into <code>App</code> through <code>mapDispatchToProps</code>) as a prop to the <code>SearchBar</code> component.</li>
<li>The <code>SearchBar</code> component handles all of the search logic (keeping track of the query and triggering the fetch request on submit).</li>
<li>The <code>GifsList</code> component iterates over its <code>gifUrls</code> prop, to render an image for each one.</li>
</ul>
<h3 id="giphy-api-key">Giphy API key</h3>
<p>Before you start, let’s create a Giphy API Key to use in your fetch requests to the Giphy API. Get started by <a href="https://giphy.com/join">creating a Giphy account</a>. Then navigate to the <a href="https://developers.giphy.com/docs/api/#quick-start-guide">Giphy API Quick Start Guide</a> and click <code>Create an App</code>.</p>
<p>Fill out the form for creating a new app, and only check the option for <code>I only want to use the GIPHY API</code>.</p>
<figure>
<img src="https://assets.aaonline.io/fullstack/react/assets/giphy_api_key.png" alt="Giphy Example" /><figcaption>Giphy Example</figcaption>
</figure>
<p>Once you’ve submitted the form, you’ll be taken to a dashboard, and under the <code>Your Apps</code> section, you should see your newly created app with an API Key that you will use for this project. As a reminder, API keys normally shouldn’t be stored in client-side JavaScript. You would normally want to store the keys in your server-side code. To keep this project a simple, front-end only project, you’ll store the API key in a front-end environment variable for convenience. Take a moment to create an <code>.env</code> file in the root of your project and set an environment variable with your API key, like so:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb108-1" title="1">REACT_APP_GIPHY_API_KEY<span class="op">=&lt;&lt;</span>YOUR API KEY<span class="op">&gt;&gt;</span></a></code></pre></div>
<p>Notice that your <code>config.js</code> file is already exporting your <code>REACT_APP_GIPHY_API_KEY</code> environment variable as <code>apiKey</code>:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb109-1" title="1"><span class="im">export</span> <span class="kw">const</span> apiKey <span class="op">=</span> <span class="va">process</span>.<span class="va">env</span>.<span class="at">REACT_APP_GIPHY_API_KEY</span></a></code></pre></div>
<p>This means that you can import the API key from any of your frontend components with the following import statement:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb110-1" title="1"><span class="im">import</span> <span class="op">{</span> apiKey <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../config&#39;</span><span class="op">;</span></a></code></pre></div>
<h2 id="phase-1-fetch-data-in-the-redux-cycle">Phase 1: Fetch data in the Redux cycle</h2>
<p>Before you begin to build the project, it’s important to think about the state shape. You know that you want to display GIF results returned by a fetch request. This means you’ll probably want a <code>gifs</code> slice of the state that holds a collection of <code>gif</code> objects.</p>
<h3 id="state-shape">State shape</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb111-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb111-2" title="2">  <span class="dt">gifs</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb111-3" title="3">    <span class="co">// gif objects  </span></a>
<a class="sourceLine" id="cb111-4" title="4">  ]</a>
<a class="sourceLine" id="cb111-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>As a reminder, you pass the <code>gifs</code> slice of state as a prop to the <code>App</code> component in the <code>AppContainer</code> through the <code>mapStateToProps</code> function.</p>
<h3 id="api-util">API util</h3>
<p>The first part of creating your Redux cycle for fetching GIFs is creating a fetch request that will be connected to a <em>thunk action creator</em>. Define and export a <code>fetchGifs</code> function in the <code>apiUtil.js</code> file. This function will make a fetch call to the Giphy API’s search endpoint.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb112-1" title="1"><span class="co">// apiUtil.js</span></a>
<a class="sourceLine" id="cb112-2" title="2"><span class="im">import</span> <span class="op">{</span> apiKey <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../config&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb112-3" title="3"></a>
<a class="sourceLine" id="cb112-4" title="4"><span class="im">export</span> <span class="kw">const</span> fetchGifs <span class="op">=</span> searchTerm <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb112-5" title="5">  <span class="co">// </span><span class="al">TODO</span><span class="co">: Write a fetch call to the Giphy API&#39;s search endpoint</span></a>
<a class="sourceLine" id="cb112-6" title="6">)</a></code></pre></div>
<p>It will take a single argument, the <code>searchQuery</code> entered by a user. You can check out the <a href="https://github.com/Giphy/GiphyAPI">Giphy API docs</a> for more details, but in short, you want to make a fetch request to the following endpoint:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb113-1" title="1"><span class="vs">`http://api.giphy.com/v1/gifs/search?api_key=</span><span class="sc">${</span>apiKey<span class="sc">}</span><span class="vs">&amp;q=</span><span class="sc">${</span>searchTerm<span class="sc">}</span><span class="vs">&amp;limit=3`</span></a></code></pre></div>
<p>The <code>searchQuery</code> will be replaced with your user’s actual query. You should tag <code>&amp;limit=3</code> onto the end of your query string to tell Giphy you only want three GIF responses. The Giphy API is relatively slow, so keeping the response size down helps optimize your application’s performance.</p>
<p>Remember, it’s best to test small pieces as we go. Let’s test out that fetch request from your developer tools console to make sure it’s doing what you’re intending.</p>
<p>You may need to restart your server to have your application process the environment variables set in your <code>.env</code> file.</p>
<p>Import your <code>fetchGifs</code> function to the entry <code>index.js</code> file, then go ahead and put it on the window so we have access to it in the console:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb114-1" title="1"><span class="co">// index.js</span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb114-3" title="3"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb114-4" title="4"><span class="im">import</span> Root <span class="im">from</span> <span class="st">&#39;./components/Root&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb114-5" title="5"><span class="im">import</span> <span class="op">{</span> fetchGifs <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./util/apiUtil&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb114-6" title="6"></a>
<a class="sourceLine" id="cb114-7" title="7"><span class="va">window</span>.<span class="at">fetchGifs</span> <span class="op">=</span> fetchGifs<span class="op">;</span></a>
<a class="sourceLine" id="cb114-8" title="8"></a>
<a class="sourceLine" id="cb114-9" title="9"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb114-10" title="10">  <span class="op">&lt;</span><span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb114-11" title="11">    <span class="op">&lt;</span>Root /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb114-12" title="12">  &lt;/<span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb114-13" title="13">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;root&quot;</span>)</a>
<a class="sourceLine" id="cb114-14" title="14">)<span class="op">;</span></a></code></pre></div>
<p>Try running this test code:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb115-1" title="1"><span class="at">fetchGifs</span>(<span class="st">&#39;puppy&#39;</span>).<span class="at">then</span>(res <span class="kw">=&gt;</span> <span class="va">res</span>.<span class="at">json</span>()).<span class="at">then</span>(res <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="va">res</span>.<span class="at">data</span>))<span class="op">;</span></a></code></pre></div>
<p>This will make the fetch request, which will return a promise. You’ll chain on a <code>.then</code> to parse the response and log the parsed response data. You should see an array of three objects. Those are your gif objects fetched from the Giphy API! Make sure you get this working before moving on, and don’t forget to remove <code>fetchGifs</code> from the window once you’re done testing.</p>
<h2 id="phase-2-redux-actions">Phase 2: Redux actions</h2>
<p>Next, you’ll set up an <a href="https://redux.js.org/basics/actions">action</a> to properly receive GIF payload information (your fetch responses). As always, you want to export constants for your action types set to strings of your action types. As a reminder, this is to prevent bugs from mistyping your action types.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb116-1" title="1"><span class="im">export</span> <span class="kw">const</span> RECEIVE_GIFS <span class="op">=</span> <span class="st">&#39;RECEIVE_GIFS&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Now it’s time to write a function that returns your <code>action</code>, an object literal. Write <code>receiveGifs</code> as a function that takes in <code>gifs</code> data as a parameter and returns an action object. The object should have two keys: one for the <code>type</code> and another for the <code>gifs</code> data. Your function should look like the following:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">const</span> receiveGifs <span class="op">=</span> gifs <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb117-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb117-3" title="3">    <span class="dt">type</span><span class="op">:</span> RECEIVE_GIFS<span class="op">,</span></a>
<a class="sourceLine" id="cb117-4" title="4">    gifs</a>
<a class="sourceLine" id="cb117-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb117-6" title="6"><span class="op">};</span></a></code></pre></div>
<p>Before testing this action creator, you’ll need a reducer.</p>
<h3 id="gifsreducer">gifsReducer</h3>
<p>Let’s write a switch case and default switch return in your <code>gifsReducer.js</code> file. Note that the <code>gifsReducer</code> function receives the previous <code>state</code> and an <code>action</code>. Recall that a reducer describes how a slice of state should change based on a dispatched action. It should always return the new state without mutating the previous state. If the action dispatched to the reducer should not change the state, the reducer should return the previous <code>state</code> by default. You will need to import the <code>RECEIVE_GIFS</code> constant from your <code>gifActions.js</code> file.</p>
<p>Your reducer should look similar to the this one:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb118-1" title="1"><span class="co">// </span><span class="al">TODO</span><span class="co">: Import the `RECEIVE_GIFS` constant</span></a>
<a class="sourceLine" id="cb118-2" title="2"></a>
<a class="sourceLine" id="cb118-3" title="3"><span class="kw">const</span> gifsReducer <span class="op">=</span> (state <span class="op">=</span> []<span class="op">,</span> action) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb118-4" title="4">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb118-5" title="5">    <span class="co">// </span><span class="al">TODO</span><span class="co">: Return the GIFs from the action object if the action type is `RECEIVE_GIFS`</span></a>
<a class="sourceLine" id="cb118-6" title="6">    <span class="co">// </span><span class="al">TODO</span><span class="co">: Return the previous state by default</span></a>
<a class="sourceLine" id="cb118-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb118-8" title="8"><span class="op">};</span></a>
<a class="sourceLine" id="cb118-9" title="9"></a>
<a class="sourceLine" id="cb118-10" title="10"><span class="im">export</span> <span class="im">default</span> gifsReducer<span class="op">;</span></a></code></pre></div>
<h3 id="rootreducer">rootReducer</h3>
<p>Recall the state shape you saw earlier in the project instructions. The <code>gifsReducer</code> above should control the <code>gifs</code> slice of the application state. You’ll create and export a <code>rootReducer</code> with Redux’s <code>combineReducers</code> function to assign control of different slices of state to their prospective reducer functions to create the application state structure.</p>
<p>This project only needs one reducer, but using <code>combineReducers</code> would allow you to easily add more state slices in the future.</p>
<p>The <code>combineReducers</code> function has already been imported for you. Take a moment to import your <code>gifsReducer</code> and set the <code>gifs</code> slice of state to its reducer, like so:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb119-1" title="1">gifs<span class="op">:</span> gifsReducer<span class="op">,</span></a></code></pre></div>
<p>Now that you have your reducers set up to structure your application’s global state, you’ll need to set up the Redux store to hold that global state.</p>
<h2 id="phase-3-the-redux-store">Phase 3: The Redux store</h2>
<p>The store holds the global state of an application, so you’ll need to create it before you can test your reducer. Remember that Redux provides a <code>createStore</code> function that receives a <code>reducer</code>, optional <code>preloadedState</code>, and an optional <code>enhancer</code>. Begin by writing a <code>configureStore</code> function that passes your <code>rootReducer</code> to <code>createStore</code>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb120-1" title="1"><span class="co">// store.js</span></a>
<a class="sourceLine" id="cb120-2" title="2"><span class="im">import</span> <span class="op">{</span> createStore <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb120-3" title="3"><span class="co">// </span><span class="al">TODO</span><span class="co">: Import middleware</span></a>
<a class="sourceLine" id="cb120-4" title="4"><span class="im">import</span> rootReducer <span class="im">from</span> <span class="st">&#39;./reducers/rootReducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb120-5" title="5"></a>
<a class="sourceLine" id="cb120-6" title="6"><span class="kw">const</span> configureStore <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb120-7" title="7">  <span class="cf">return</span> <span class="at">createStore</span>(rootReducer)<span class="op">;</span></a>
<a class="sourceLine" id="cb120-8" title="8"><span class="op">};</span></a>
<a class="sourceLine" id="cb120-9" title="9"></a>
<a class="sourceLine" id="cb120-10" title="10"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<p>Import <code>configureStore</code> into your entry <code>index.js</code> file, then use the function to generate the Redux store.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">const</span> store <span class="op">=</span> <span class="at">configureStore</span>()<span class="op">;</span></a></code></pre></div>
<p>Now you’ll work on providing the store you have generated to your application’s components! Begin by passing the <code>store</code> you’ve generated as a prop to the <code>Root</code> component. Your <code>index.js</code> file should look something like this:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb122-1" title="1"><span class="co">// index.js</span></a>
<a class="sourceLine" id="cb122-2" title="2"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb122-3" title="3"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb122-4" title="4"><span class="im">import</span> Root <span class="im">from</span> <span class="st">&#39;./components/Root&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb122-5" title="5"><span class="im">import</span> configureStore <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb122-6" title="6"><span class="im">import</span> <span class="op">{</span> fetchGifs <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./util/apiUtil&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb122-7" title="7"></a>
<a class="sourceLine" id="cb122-8" title="8"><span class="va">window</span>.<span class="at">fetchGifs</span> <span class="op">=</span> fetchGifs<span class="op">;</span></a>
<a class="sourceLine" id="cb122-9" title="9"><span class="kw">const</span> store <span class="op">=</span> <span class="at">configureStore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb122-10" title="10"></a>
<a class="sourceLine" id="cb122-11" title="11"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb122-12" title="12">  <span class="op">&lt;</span><span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb122-13" title="13">    <span class="op">&lt;</span>Root store<span class="op">={</span>store<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb122-14" title="14">  &lt;/<span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb122-15" title="15">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb122-16" title="16">)<span class="op">;</span></a></code></pre></div>
<p>Now go into your <code>Root.js</code> file and import <code>Provider</code> from <code>react-redux</code>. Use the <code>Provider</code> component to set the Redux store through the <code>Provider</code> component’s expected <code>store</code> prop. Remember how you have just configured and passed a <code>store</code> as a prop to the <code>Root</code> component in your entry file (<code>index.js</code>). Use the <code>Root</code> component’s <code>store</code> prop to set the <code>store</code> prop of the <code>Provider</code>:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb123-1" title="1"><span class="co">// Root.js</span></a>
<a class="sourceLine" id="cb123-2" title="2"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb123-3" title="3"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb123-4" title="4"><span class="im">import</span> App <span class="im">from</span> <span class="st">&#39;./App&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb123-5" title="5"></a>
<a class="sourceLine" id="cb123-6" title="6"><span class="kw">const</span> Root <span class="op">=</span> (<span class="op">{</span> store <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb123-7" title="7">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb123-8" title="8">    <span class="op">&lt;</span>App /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb123-9" title="9">  &lt;/Provider<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb123-10" title="10">)<span class="op">;</span></a>
<a class="sourceLine" id="cb123-11" title="11"></a>
<a class="sourceLine" id="cb123-12" title="12"><span class="im">export</span> <span class="im">default</span> Root<span class="op">;</span></a></code></pre></div>
<p>Now that you have configured your Redux store and tested your <code>fetchGifs</code> function, let’s connect the function to the store to implement a full Redux cycle. In the next phase, you’ll define a <em>thunk action creator</em> function and use the <code>thunk</code> middleware so that each fetch response is dispatched as a change to the global application <code>state</code>.</p>
<h2 id="phase-4-thunk-middleware">Phase 4: Thunk middleware</h2>
<p>Let’s refactor how you fetch GIFs by using a thunk action creator. Recall that we use a <em>thunk action creator</em> to return a function. When that function is called with an argument of <code>dispatch</code>, the function can dispatch additional actions.</p>
<p>Begin by refactoring your <code>configureStore</code> function in the <code>store.js</code> file to incorporate your thunk middleware. Remember that Redux provides <code>thunk</code> middleware from the <code>redux-thunk</code> module. Import the <code>thunk</code> middleware and <code>applyMiddleware</code> function from Redux. You’ll use the <code>applyMiddleware</code> function, with your <code>thunk</code> middleware as an argument, to set the optional <code>enhancer</code> argument in the <code>createStore</code> function:</p>
<p>Your <code>store.js</code> file should now include the following:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb124-1" title="1"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb124-2" title="2"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;redux-thunk&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb124-3" title="3"><span class="im">import</span> rootReducer <span class="im">from</span> <span class="st">&#39;./reducers/rootReducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb124-4" title="4"></a>
<a class="sourceLine" id="cb124-5" title="5"><span class="kw">const</span> configureStore <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb124-6" title="6">  <span class="cf">return</span> <span class="at">createStore</span>(rootReducer<span class="op">,</span> <span class="at">applyMiddleware</span>(thunk))<span class="op">;</span></a>
<a class="sourceLine" id="cb124-7" title="7"><span class="op">};</span></a>
<a class="sourceLine" id="cb124-8" title="8"></a>
<a class="sourceLine" id="cb124-9" title="9"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<p>Now your Redux cycle is almost good to go! To summarize your progress to this point, you have configured your Redux store, provided the store to your application, written a fetch function in a util file, defined an action type, and defined an action creator.</p>
<p>The last step is to define a <em>thunk action creator</em> that will dispatch the <code>receiveGifs</code> action after the Giphy API call is successful!</p>
<p>Begin by importing your API util function into your <code>gifActions.js</code> file. Since you want to easily associate your <em>thunk action creators</em> with a specific action, and you’ll often have more than one function exported from your util file, use a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#Description">namespace</a> to import your fetch function:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb125-1" title="1"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> APIUtil <span class="im">from</span> <span class="st">&#39;../util/apiUtil&#39;</span><span class="op">;</span></a></code></pre></div>
<p>You would then invoke your <code>fetchGifs</code> function in your <code>apiUtil.js</code> file like so:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb126-1" title="1"><span class="va">APIUtil</span>.<span class="at">fetchGifs</span>(searchQuery)<span class="op">;</span></a></code></pre></div>
<p>Now it’s time to write your <em>thunk action creator</em>! Define and export a function named <code>fetchGifs</code> that receives a search term and returns a function that can be called with <code>dispatch</code>. Your function will use a promise to parse the fetch response to JSON and dispatch the <code>receiveGifs</code> action with the fetch response data after the <code>APIUtil.fetchGifs</code> call is successful.</p>
<p>Your <em>thunk action creator</em> should look like the following:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb127-1" title="1"><span class="im">export</span> <span class="kw">const</span> fetchGifs <span class="op">=</span> searchTerm <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb127-2" title="2">  <span class="cf">return</span> dispatch <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb127-3" title="3">    <span class="cf">return</span> <span class="va">APIUtil</span>.<span class="at">fetchGifs</span>(searchTerm)</a>
<a class="sourceLine" id="cb127-4" title="4">      .<span class="at">then</span>(res <span class="kw">=&gt;</span> <span class="va">res</span>.<span class="at">json</span>())</a>
<a class="sourceLine" id="cb127-5" title="5">      .<span class="at">then</span>(res <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">receiveGifs</span>(<span class="va">res</span>.<span class="at">data</span>)))<span class="op">;</span></a>
<a class="sourceLine" id="cb127-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb127-7" title="7"><span class="op">};</span></a></code></pre></div>
<p>Or you can clean up the function by using implicit returns with ES6 arrow functions:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb128-1" title="1"><span class="im">export</span> <span class="kw">const</span> fetchGifs <span class="op">=</span> searchTerm <span class="kw">=&gt;</span> dispatch <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb128-2" title="2">  <span class="va">APIUtil</span>.<span class="at">fetchGifs</span>(searchTerm)</a>
<a class="sourceLine" id="cb128-3" title="3">    .<span class="at">then</span>(res <span class="kw">=&gt;</span> <span class="va">res</span>.<span class="at">json</span>())</a>
<a class="sourceLine" id="cb128-4" title="4">    .<span class="at">then</span>(res <span class="kw">=&gt;</span> <span class="at">dispatch</span>(<span class="at">receiveGifs</span>(<span class="va">res</span>.<span class="at">data</span>)))</a>
<a class="sourceLine" id="cb128-5" title="5">)<span class="op">;</span></a></code></pre></div>
<h2 id="phase-5-test-your-thunk-action-creator">Phase 5: Test your thunk action creator</h2>
<p>Let’s take a moment to test your the <code>fetchGifs</code> <em>thunk action creator</em> you just defined.</p>
<p>Import <code>fetchGifs</code> from your <code>gifActions.js</code> file to your entry <code>index.js</code> file. You’ll hit the error <code>Parsing error: Identifier 'fetchGifs' has already been declared</code> since have already imported the <code>fetchGifs</code> function from your <code>apiUtil.js</code> file. Note that this is why using a namespace to <code>import * as APIUtil</code> from your <code>apiUtil.js</code> file is important.</p>
<p>Update the import statement from your <code>./util/apiUtil.js</code> file with a namespace:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb129-1" title="1"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> APIUtil <span class="im">from</span> <span class="st">&#39;./util/apiUtil&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Now you’ll want to put your fetch function, thunk action creator, and Redux store on the window. This way you can view your application’s global state and compare the result of your fetch function and the dispatched thunk action creator:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb130-1" title="1"><span class="co">// index.js</span></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb130-3" title="3"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb130-4" title="4"><span class="im">import</span> Root <span class="im">from</span> <span class="st">&#39;./components/Root&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb130-5" title="5"><span class="im">import</span> configureStore <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb130-6" title="6"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> APIUtil <span class="im">from</span> <span class="st">&#39;./util/apiUtil&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb130-7" title="7"><span class="im">import</span> <span class="op">{</span> fetchGifs <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./actions/gifActions&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb130-8" title="8"></a>
<a class="sourceLine" id="cb130-9" title="9"><span class="kw">const</span> store <span class="op">=</span> <span class="at">configureStore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb130-10" title="10"><span class="va">window</span>.<span class="at">apiFetchGifs</span> <span class="op">=</span> <span class="va">APIUtil</span>.<span class="at">fetchGifs</span><span class="op">;</span></a>
<a class="sourceLine" id="cb130-11" title="11"><span class="va">window</span>.<span class="at">fetchGifs</span> <span class="op">=</span> fetchGifs<span class="op">;</span></a>
<a class="sourceLine" id="cb130-12" title="12"><span class="va">window</span>.<span class="at">store</span> <span class="op">=</span> store<span class="op">;</span></a>
<a class="sourceLine" id="cb130-13" title="13"></a>
<a class="sourceLine" id="cb130-14" title="14"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb130-15" title="15">  <span class="op">&lt;</span><span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb130-16" title="16">    <span class="op">&lt;</span>Root store<span class="op">={</span>store<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb130-17" title="17">  &lt;/<span class="va">React</span>.<span class="at">StrictMode</span><span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb130-18" title="18">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb130-19" title="19">)<span class="op">;</span></a></code></pre></div>
<p>Now you’ll use the <code>getState()</code> and <code>dispatch(action)</code> <a href="https://redux.js.org/api/store">store methods</a> to view and update your application’s global state. Try the following code in the browser’s console before continuing to the next phase:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb131-1" title="1"> <span class="co">// Return the initial application state</span></a>
<a class="sourceLine" id="cb131-2" title="2"><span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb131-3" title="3"></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="co">// Use the thunk action creator to dispatch the fetch response and populate state</span></a>
<a class="sourceLine" id="cb131-5" title="5"><span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">fetchGifs</span>(<span class="st">&#39;puppy&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb131-6" title="6"></a>
<a class="sourceLine" id="cb131-7" title="7"><span class="co">// Return the application state populated with GIFs</span></a>
<a class="sourceLine" id="cb131-8" title="8"><span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a></code></pre></div>
<p>Congratulations! You just wrote a Redux cycle to populate your application’s global state with a response from the Giphy API.</p>
<p>Notice how your application’s global state changed after invoking the <code>dispatch(fetchGifs('puppy))</code> method. Now you can pass the <code>fetchGifs</code> <em>thunk action creator</em> through a Redux container so that a fetch call can be dispatched from your component to update the global state in the same way!</p>
<h2 id="phase-6-logger-middleware">Phase 6: Logger middleware</h2>
<p>Now instead of manually logging the status of your global state and the response of your dispatch call, you can use the Redux <code>logger</code> middleware to automatically do so. Import <code>logger</code> from <code>redux-logger</code> into your <code>store.js</code> file:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb132-1" title="1"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Just like how you applied your <code>thunk</code> middleware to your configured store, you’ll invoke the <code>applyMiddleware()</code> function with your <code>logger</code> middleware. Your updated <code>store.js</code> file should look something like this:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb133-1" title="1"><span class="co">// store.js</span></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;redux-thunk&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb133-5" title="5"><span class="im">import</span> rootReducer <span class="im">from</span> <span class="st">&#39;./reducers/rootReducer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb133-6" title="6"></a>
<a class="sourceLine" id="cb133-7" title="7"><span class="kw">const</span> configureStore <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb133-8" title="8">  <span class="cf">return</span> <span class="at">createStore</span>(rootReducer<span class="op">,</span> <span class="at">applyMiddleware</span>(thunk<span class="op">,</span> logger))<span class="op">;</span></a>
<a class="sourceLine" id="cb133-9" title="9"><span class="op">};</span></a>
<a class="sourceLine" id="cb133-10" title="10"></a>
<a class="sourceLine" id="cb133-11" title="11"><span class="im">export</span> <span class="im">default</span> configureStore<span class="op">;</span></a></code></pre></div>
<p>Now go back to your browser’s console and dispatch a fetch request:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb134-1" title="1"><span class="ex">store.dispatch</span>(fetchGifs(<span class="st">&#39;puppy&#39;</span>))</a></code></pre></div>
<p>Upon a successful fetch, you should have received a helpful log with your application’s <code>prev state</code>, the dispatched <code>action</code> object, and your application’s <code>next state</code> from the <code>logger</code> middleware you just utilized!</p>
<h2 id="phase-7-container-component">Phase 7: Container component</h2>
<p>Now that you’ve set up the global state of your application, it’s time to connect your React components to the global state! Remember how you used the <code>Provider</code> component in your <code>Root.js</code> file to pass the configured <code>store</code> as a prop to the <code>Provider</code> component.</p>
<p>Just like how a <code>Context.Provider</code> component expects <code>value</code> as a prop to set the context object, the Redux <code>Provider</code> component expects <code>store</code> as a prop to share the store’s global state with nested components. Instead of rendering your <code>App</code> component as the child of the <code>Provider</code>, you’ll render an <code>AppContainer</code>.</p>
<h3 id="appcontainer">AppContainer</h3>
<p>In your <code>AppContainer.js</code> file, you will define a <code>mapStateToProps</code> function and a <code>mapDispatchToProps</code> function and invoke the <code>connect()</code> function from Redux. Invoking the <code>connect()</code> function will connect the <code>App</code> component with the Redux store. Within the container, you will pass slices of <code>state</code> and dispatched <em>thunk action creators</em> as props to the <code>App</code> component.</p>
<p>Note that the skeleton has already imported the <code>connect</code> function from <code>react-redux</code>, your <code>fetchGifs</code> thunk action creator from the <code>gifAction.js</code> file, and the <code>App</code> component.</p>
<p>Take a look at the code skeletons of the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions. Think of these functions as functions that take in <code>state</code> or <code>dispatch</code> as arguments to return object literals that represent the props that your <code>App</code> component will receive.</p>
<p>Have your <code>mapStateToProps</code> function return an object with a <code>gifs</code> property set to the <code>state.gifs</code> slice of state. Doing this will pass a <code>gifs</code> prop into your <code>App</code> component.</p>
<p>Next, have your <code>mapDispatchToProps</code> function return an object with a <code>fetchGifs</code> property set to an arrow function that accepts a <code>searchQuery</code> value and dispatches a call to the <code>fetchGifs(searchQuery)</code> function. Remember how you tested the <code>store.dispatch(fetchGifs(searchQuery))</code> function in the browser console. Think of how you would use an arrow function to almost wait for a <code>searchQuery</code> input from the user before firing the dispatch call.</p>
<p>Lastly, take a moment to examine how your <code>AppContainer.js</code> file is simply exporting the <code>connect()</code> invocation:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb135-1" title="1"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(App)<span class="op">;</span></a></code></pre></div>
<p>Now you can render your <code>AppContainer</code> instead of your <code>App</code> component so that the <code>connect()</code> method is invoked to pass a <code>gifs</code> prop and a <code>fetchGifs</code> props to <code>App</code>!</p>
<p>Take a moment to refactor your <code>Root.js</code> file to do so:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb136-1" title="1"><span class="co">// Root.js</span></a>
<a class="sourceLine" id="cb136-2" title="2"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb136-3" title="3"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="im">import</span> AppContainer <span class="im">from</span> <span class="st">&#39;./AppContainer&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb136-5" title="5"></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="kw">const</span> Root <span class="op">=</span> (<span class="op">{</span> store <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb136-7" title="7">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb136-8" title="8">    <span class="op">&lt;</span>AppContainer /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb136-9" title="9">  &lt;/Provider<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb136-10" title="10">)<span class="op">;</span></a>
<a class="sourceLine" id="cb136-11" title="11"></a>
<a class="sourceLine" id="cb136-12" title="12"><span class="im">export</span> <span class="im">default</span> Root<span class="op">;</span></a></code></pre></div>
<h2 id="phase-8-presentational-components">Phase 8: Presentational components</h2>
<p>Now that you’ve created a container to pass (or <em>map</em>) slices of the global state and dispatched actions as props, it’s time to render and update the <code>gifs</code> from the global state!</p>
<h3 id="app">App</h3>
<p>Have your <code>App</code> component take in and destructure your <code>gifs</code> and <code>fetchGifs</code> props. Notice how your component is rendering a <code>SearchBar</code> component and a <code>GifsList</code> component. You’ll want to pass in the <code>fetchGifs</code> function as a prop to the <code>SearchBar</code> component.</p>
<p>Instead of directly passing all of the <code>gifs</code> as a prop to the <code>GifsList</code> component, you’ll refactor your <code>mapStateToProps</code> function and use a selector to map the array of <code>gifs</code> into an array of GIF urls.</p>
<p>Currently, your <code>mapStateToProps</code> function should look something like this:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> state <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb137-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb137-3" title="3">    <span class="dt">gifs</span><span class="op">:</span> <span class="va">state</span>.<span class="at">gifs</span><span class="op">,</span></a>
<a class="sourceLine" id="cb137-4" title="4">  <span class="op">};</span></a>
<a class="sourceLine" id="cb137-5" title="5"><span class="op">};</span></a></code></pre></div>
<p>Define a <code>getGifUrls</code> selector that takes in the <code>state</code> and uses parameter destructuring to map over each gif in the <code>gifs</code> slice of state to pluck the image URL from the JSON data, like so:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb138-1" title="1"><span class="kw">const</span> getGifUrls <span class="op">=</span> (<span class="op">{</span> gifs <span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb138-2" title="2">  <span class="va">gifs</span>.<span class="at">map</span>(gif <span class="kw">=&gt;</span> <span class="va">gif</span>.<span class="va">images</span>.<span class="va">fixed_height</span>.<span class="at">url</span>)</a>
<a class="sourceLine" id="cb138-3" title="3">)<span class="op">;</span></a>
<a class="sourceLine" id="cb138-4" title="4"></a>
<a class="sourceLine" id="cb138-5" title="5"><span class="kw">const</span> mapStateToProps <span class="op">=</span> state <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb138-6" title="6">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb138-7" title="7">    <span class="dt">gifUrls</span><span class="op">:</span> <span class="at">getGifUrls</span>(state)<span class="op">,</span></a>
<a class="sourceLine" id="cb138-8" title="8">  <span class="op">};</span></a>
<a class="sourceLine" id="cb138-9" title="9"><span class="op">};</span></a></code></pre></div>
<p>Now you can pass in the <code>gifUrls</code> for your <code>GifsList</code> component to render GIF images without passing unnecessary data as props!</p>
<h3 id="searchbar">SearchBar</h3>
<p>In your <code>SearchBar</code> component, you already have a search form, an <code>inputValue</code> state, and an <code>onChange</code> handler for the form’s input field set up. Right now, your component has several <code>TODO</code> notes to guide your creation of an <code>onSubmit</code> handler for your search form. The <code>onSubmit</code> handler will dispatch the <code>fetchGifs</code> action creator function (don’t forget to prevent the default action of a submit event).</p>
<p>After finishing your <code>SearchBar</code> component, test out your submit event handler and check your <code>logger</code> response to see if your <code>fetchGifs</code> action creator is actually being dispatched to update the application’s global state! Once you see that your fetched <code>gifs</code> have been dispatched to the <code>gifs</code> slice of state, it’s time to render your list of GIFs!</p>
<h3 id="gifslist">GifsList</h3>
<p>Right now, your component has several <code>TODO</code> notes:</p>
<ul>
<li>Take in and destructure the <code>gifUrls</code> prop.</li>
<li>Render a <code>&lt;div&gt;</code> as the parent element of your <code>GifsList</code> component.</li>
<li>Map over your <code>gifUrls</code> array to render an <code>&lt;img&gt;</code> for each <code>url</code>.</li>
</ul>
<h3 id="debugging">Debugging</h3>
<p>If you’re having issues rendering a GIF in your project, that means it’s a great time to practice using <code>debugger</code> statements to debug your Redux cycle code! For example, you could set a <code>debugger</code> in the:</p>
<ul>
<li><code>handleSubmit</code> method to check out the submitted search <code>inputValue</code></li>
<li><code>receiveGifs</code> action creator function to check out the value of the <code>gifs</code> payload</li>
<li><code>RECEIVE_GIFS</code> case statement in the <code>gifsReducer</code> to check out the value of the dispatch <code>action</code> object</li>
</ul>
<p>If you didn’t hit any issues, congratulations - you have implemented Redux with the Giphy API to create a search API that renders a list of GIFs! Before moving forward to the next project, you should still use <code>debugger</code> statements to step through this project’s Redux cycle.</p>
