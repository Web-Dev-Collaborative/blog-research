<p>This is a very simple example of how to use <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Native_messaging">native messaging</a> to exchange messages between a WebExtension and a native application.</p>
<p>The WebExtension, which can be found under “add-on”, connects to the native application and listens to messages from it. It then sends a message to the native application when the user clicks on the WebExtension’s browser action. The message payload is just “ping”.</p>
<p>The native application, which can be found under “app”, listens for messages from the WebExtension. When it receives a message, the native application sends a response message whose payload is just “pong”. The native application is written in Python.</p>
<h2 id="setup">Setup</h2>
<p>To get this working, there’s a little setup to do.</p>
<h3 id="mac-oslinux-setup">Mac OS/Linux setup</h3>
<ol type="1">
<li>Check that the <a href="https://en.wikipedia.org/wiki/File_system_permissions">file permissions</a> for “ping_pong.py” include the <code>execute</code> permission.</li>
<li>Edit the “path” property of “ping_pong.json” to point to the location of “ping_pong.py” on your computer.</li>
<li>copy “ping_pong.json” to the correct location on your computer. See <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Native_manifests#Manifest_location">App manifest location</a> to find the correct location for your OS.</li>
</ol>
<h3 id="windows-setup">Windows setup</h3>
<ol type="1">
<li>Check you have Python installed, and that your system’s PATH environment variable includes the path to Python. See <a href="https://docs.python.org/2/using/windows.html">Using Python on Windows</a>. You’ll need to restart the web browser after making this change, or the browser won’t pick up the new environment variable.</li>
<li>Edit the “path” property of “ping_pong.json” to point to the location of “ping_pong_win.bat” on your computer. Note that you’ll need to escape the Windows directory separator, like this: <code>"path": "C:\\Users\\MDN\\native-messaging\\app\\ping_pong_win.bat"</code>.</li>
<li>Edit “ping_pong_win.bat” to refer to the location of “ping_pong.py” on your computer.</li>
<li>Add a registry key containing the path to “ping_pong.json” on your computer. See <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Native_manifests#Manifest_location">App manifest location</a> to find details of the registry key to add.</li>
</ol>
<p>To assist in troubleshooting on Windows, there is a script called <code>check_config_win.py</code>. Running this from the command line should give you an idea of any problems.</p>
<h2 id="testing-the-example">Testing the example</h2>
<p>Then just install the add-on as usual, by visiting about:debugging, clicking “Load Temporary Add-on”, and selecting the add-on’s “manifest.json”.</p>
<p>You should see a new browser action icon in the toolbar. Open the console (“Tools/Web Developer/Browser Console” in Firefox), and click the browser action icon. You should see output like this in the console:</p>
<pre><code>Sending: ping
Received: pong</code></pre>
<p>If you don’t see this output, see the <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Native_messaging#Troubleshooting">Troubleshooting guide</a> for ideas.</p>
