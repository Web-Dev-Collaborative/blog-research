<h1 id="webextension-webpack-example">WebExtension Webpack Example</h1>
<p>A minimal example of how to use <a href="https://webpack.github.io">webpack</a> to package <a href="https://npmjs.com">npm</a> modules so they can be used in a WebExtension. The example package used by this extension is <code>left-pad</code>, an essential package in almost any situation.</p>
<h2 id="what-it-does">What it does</h2>
<p>This example shows how to use a node module in a background script and popup. It defines two build targets in <a href="webpack.config.js">webpack.config.js</a>, they each generate a file that includes all modules used the entry point and store it in the <a href="addon/">addon</a> folder. The first one starts with <a href="background_scripts/background.js">background_scripts/background.js</a> and stores it in <code>addon/background_scripts/index.js</code>. The other one does the same for <a href="popup/left-pad.js">popup/left-pad.js</a> and stores it in <code>addon/popup/index.js</code>.</p>
<p>The extension includes a browser action with a popup, which provides an UI for running left-pad on a string with a chosen character. The operation can either be performed with the left-pad module included in the panel’s script or in the background script.</p>
<h2 id="what-it-could-do">What it could do</h2>
<p>This could be infinitely extended - injecting global jQuery, adding babel, react/jsx, css modules, image processing, local modules and so on.</p>
<h2 id="what-it-shows">What it shows</h2>
<ul>
<li>How to use npm or custom modules in a WebExtension.</li>
</ul>
<h2 id="how-to-build-it">How to build it</h2>
<ul>
<li><code>npm install</code></li>
<li><code>npm run build</code></li>
</ul>
<p>The WebExtension in the <a href="addon/">addon</a> folder should now work.</p>
<h2 id="what-about-browserify">What about Browserify?</h2>
<p><a href="http://browserify.org/">Browserify</a> works just as well as webpack for extensions. In the end it’s a personal choice about your preferred tool.</p>
<h2 id="live-development">Live-development</h2>
<p>As well as watching the folder with your <code>manifest.json</code> in it, you will also have to run webpack in watch mode. You can use the <a href="https://github.com/rpl/webpack-webext-plugin">webpack-webext-plugin</a> to simplify the workflow.</p>
<h2 id="on-addons.mozilla.org-reviews">On addons.mozilla.org Reviews</h2>
<p>Files generated by webpack and friends are compiled files. You have to separately <a href="https://developer.mozilla.org/en-US/Add-ons/AMO/Policy/Reviews#Source_Code_Submission">upload the source</a> you generated your extension from to AMO for review of a listed extension. This will mean that your extension has to be reviewed by an admin reviewer, which will result in a longer wait time in queue.</p>
<p>To make the review easier, you can exclude third-party libraries from your output and directly ship the original distribution files for the libraries. This allows AMO to automatically recognize libraries and mark them as safe. This can be achieved with <a href="https://webpack.js.org/configuration/externals/">externals</a> in the configuration for webpack.</p>
