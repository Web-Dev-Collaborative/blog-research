<h1 id="mocha-client-tests-for-webextensions">Mocha client tests for WebExtensions</h1>
<h2 id="introduction">Introduction</h2>
<p>This example shows two methods of testing a WebExtension: * Running tests from within the addon * Running tests from the commandline using Karma</p>
<p>See https://github.com/Standard8/example-webextension for a more complete example of WebExtension test configuration.</p>
<h2 id="install-dependencies">Install Dependencies:</h2>
<pre><code>  npm install</code></pre>
<p>To run tests from within the addon:</p>
<pre><code>  cd addon
  npm install</code></pre>
<h2 id="testing-within-the-addon">Testing within the Addon</h2>
<p>This gives you the possibility to run client tests inside the addon with the mocha UI. If you don’t want to use the mocha UI, you can install <a href="https://github.com/eeroan/WebConsole-reporter">WebConsole-reporter</a>.</p>
<h3 id="run-with-web-ext-cli">Run with web-ext cli</h3>
<p>Just run <code>npm run web-ext</code> (will work with FF dev edition), if you have error with web-ext cli please add path for FF binary file with <code>--firefox-binary /path/to/firefox-bin</code> <a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/web-ext_command_reference">(web-ext docs)</a>.</p>
<p>When the addon starts, click on the mocha icon in your browser bar to run the tests:</p>
<figure>
<img src="screenshots/addon-button.png" title="Mocha test addon" alt="addon screenshot" /><figcaption>addon screenshot</figcaption>
</figure>
<p>This will test <code>./addon/background.js</code> with <code>./addon/tests/lib/background-messaging.test.js</code>.</p>
<h2 id="testing-from-the-commandline">Testing from the Commandline</h2>
<p>This uses <a href="http://karma-runner.github.io">Karma</a> to run tests from the commandline. Just type <code>npm test</code> to test <code>./addon/background.js</code> with <code>./tests/lib/background.test.js</code>.</p>
<h3 id="debug-mode">Debug Mode</h3>
<p>Use <code>npm run test:debug</code> to run Karma in watch mode. Whenever you modify a Javascript file, the tests will automatically rerun.</p>
<p>You can install <a href="https://www.npmjs.com/package/karma-notification-reporter">karma-notification-reporter</a> to display test results in a desktop notification. You’ll need to add <code>--reporters=dots,notification</code> to the <code>test:debug</code> command line of <code>package.json</code> to enable it.</p>
